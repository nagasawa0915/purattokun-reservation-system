<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpineÈÖçÁΩÆ„Ç∑„Çπ„ÉÜ„É† - „É©„Ç§„Éñ„É©„É™ÊñπÂºè</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', sans-serif;
            line-height: 1.8;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: white;
            padding: 40px 20px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .header h1 {
            color: #ff6b6b;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: #666;
            font-size: 1.2rem;
        }

        .section {
            background: white;
            margin-bottom: 30px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }

        .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .section-content {
            padding: 30px;
        }

        .highlight-box {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8a80 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .code-box {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .code-box.before {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .code-box.after {
            border-color: #28a745;
            background: #d4edda;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .comparison-item {
            padding: 20px;
            border-radius: 10px;
        }

        .comparison-item.before {
            background: #ffe5e5;
            border-left: 4px solid #ff6b6b;
        }

        .comparison-item.after {
            background: #e8f5e8;
            border-left: 4px solid #4caf50;
        }

        .demo-screen {
            width: 100%;
            max-width: 800px;
            height: 400px;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin: 20px auto;
            position: relative;
            overflow: hidden;
            background-image: url('assets/images/„ÇØ„É©„Ç¶„Éâ„Éë„Éº„Éà„Éä„ÉºTOP.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #e8f4fd;
        }

        /* „Ç≠„É£„É©„ÇØ„Çø„ÉºË°®Á§∫ÁØÑÂõ≤ÔºàCanvasÔºâ */
        .character-canvas {
            position: absolute;
            left: 25%;
            top: 65%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            border: 2px solid #4caf50;
            background: rgba(76, 175, 80, 0.1);
            overflow: hidden;
            z-index: 8;
            cursor: move;
        }

        .character-canvas.dragging {
            cursor: grabbing;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
        }

        .demo-character {
            position: absolute;
            width: 80px;
            height: 80px;
            z-index: 10;
            cursor: move;
            border: 2px dashed rgba(255, 107, 107, 0.3);
            border-radius: 50%;
            transition: border-color 0.3s;
        }

        .demo-character:hover {
            border-color: rgba(255, 107, 107, 0.8);
        }

        .demo-character.dragging {
            border-color: #ff6b6b;
            box-shadow: 0 4px 8px rgba(255, 107, 107, 0.3);
        }

        /* „É™„Çµ„Ç§„Ç∫„Éè„É≥„Éâ„É´ */
        .resize-handle {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #ff6b6b;
            border: 2px solid white;
            border-radius: 50%;
            display: none;
            z-index: 15;
        }

        .demo-character.edit-mode .resize-handle {
            display: block;
        }

        .resize-handle.se {
            bottom: -6px;
            right: -6px;
            cursor: se-resize;
        }

        .resize-handle.sw {
            bottom: -6px;
            left: -6px;
            cursor: sw-resize;
        }

        .resize-handle.ne {
            top: -6px;
            right: -6px;
            cursor: ne-resize;
        }

        .resize-handle.nw {
            top: -6px;
            left: -6px;
            cursor: nw-resize;
        }

        /* Ë°®Á§∫ÁØÑÂõ≤ÔºàCanvasÔºâÊû†„ÅÆ„Çπ„Çø„Ç§„É´ */
        .character-canvas.canvas-edit-mode {
            border: 3px solid #ff9800;
            background: rgba(255, 152, 0, 0.2);
            box-shadow: 0 0 15px rgba(255, 152, 0, 0.4);
        }

        .character-canvas.canvas-edit-mode::before {
            content: '„Ç≠„É£„É©„ÇØ„Çø„ÉºË°®Á§∫ÁØÑÂõ≤';
            position: absolute;
            top: -25px;
            left: 0;
            background: #ff9800;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            z-index: 15;
        }

        /* Ë°®Á§∫ÁØÑÂõ≤„É™„Çµ„Ç§„Ç∫„Éè„É≥„Éâ„É´ */
        .canvas-resize-handle {
            position: absolute;
            width: 15px;
            height: 15px;
            background: #4caf50;
            border: 2px solid white;
            border-radius: 3px;
            display: none;
            z-index: 20;
        }

        .character-canvas.canvas-edit-mode .canvas-resize-handle {
            display: block;
        }

        .canvas-resize-handle.se {
            bottom: -8px;
            right: -8px;
            cursor: se-resize;
        }

        .canvas-resize-handle.sw {
            bottom: -8px;
            left: -8px;
            cursor: sw-resize;
        }

        .canvas-resize-handle.ne {
            top: -8px;
            right: -8px;
            cursor: ne-resize;
        }

        .canvas-resize-handle.nw {
            top: -8px;
            left: -8px;
            cursor: nw-resize;
        }

        .demo-controls {
            text-align: center;
            margin: 20px 0;
        }

        .demo-button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            margin: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s;
        }

        .demo-button:hover {
            background: #ff5252;
        }

        .demo-button.active {
            background: #4caf50;
        }

        .coordinate-display {
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            color: #666;
            min-height: 20px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .usage-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .flow-step {
            flex: 1;
            text-align: center;
            position: relative;
        }

        .flow-step::after {
            content: '‚Üí';
            position: absolute;
            right: -20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2rem;
            color: #ccc;
        }

        .flow-step:last-child::after {
            display: none;
        }

        .flow-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #667eea;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .usage-flow {
                flex-direction: column;
            }

            .flow-step::after {
                content: '‚Üì';
                right: auto;
                bottom: -15px;
                top: auto;
            }

            .demo-screen {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- „Éò„ÉÉ„ÉÄ„Éº -->
        <div class="header">
            <h1>üéØ SpineÈÖçÁΩÆ„Ç∑„Çπ„ÉÜ„É†</h1>
            <p class="subtitle">„É©„Ç§„Éñ„É©„É™ÊñπÂºè„Å´„Çà„ÇãÁ∞°ÂçòÂ∞éÂÖ•„Ç∑„Çπ„ÉÜ„É†</p>
        </div>

        <!-- „Ç∑„Çπ„ÉÜ„É†Ê¶ÇË¶Å -->
        <div class="section">
            <div class="section-header">
                üìã Êñ∞„Åó„ÅÑÈÖçÁΩÆ„Ç∑„Çπ„ÉÜ„É†„ÅÆÊ¶ÇË¶Å
            </div>
            <div class="section-content">
                <div class="highlight-box">
                    <h3>üéØ ÊúÄÁµÇÁõÆÊ®ô</h3>
                    <p>Êó¢Â≠ò„Éö„Éº„Ç∏„Å´1Ë°åËøΩÂä†„Åô„Çã„Å†„Åë„Åß„ÄÅË¶ñË¶öÁöÑ„Å™„Ç≠„É£„É©„ÇØ„Çø„ÉºÈÖçÁΩÆ„Åå„Åß„Åç„Çã„Ç∑„Çπ„ÉÜ„É†</p>
                </div>

                <h3>üîß ÂæìÊù•„ÅÆÂïèÈ°åÁÇπ</h3>
                <ul style="margin: 15px 0; padding-left: 20px;">
                    <li>‰ΩçÁΩÆË™øÊï¥„Å´HTML„Ç≥„Éº„Éâ„ÅÆÁõ¥Êé•Á∑®ÈõÜ„ÅåÂøÖË¶Å</li>
                    <li>Êï∞ÂÄ§Â§âÊõ¥‚Üí„Éñ„É©„Ç¶„Ç∂Á¢∫Ë™ç„ÅÆË©¶Ë°åÈåØË™§„ÅåÂøÖË¶Å</li>
                    <li>Ë§áÊï∞„Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆÁÆ°ÁêÜ„ÅåÁÖ©Èõë</li>
                    <li>Êñ∞„Åó„ÅÑ„Éö„Éº„Ç∏„Åß„ÅÆÂÜçË®≠ÂÆö„ÅåÈù¢ÂÄí</li>
                </ul>

                <h3>‚ú® Êñ∞„Ç∑„Çπ„ÉÜ„É†„ÅÆÁâπÂæ¥</h3>
                <ul style="margin: 15px 0; padding-left: 20px;">
                    <li><strong>1Ë°åËøΩÂä†</strong>„ÅßÂ∞éÂÖ•ÂÆå‰∫Ü</li>
                    <li><strong>„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó</strong>„ÅßÁõ¥ÊÑüÁöÑÈÖçÁΩÆ</li>
                    <li><strong>Ë§áÊï∞„Ç≠„É£„É©„ÇØ„Çø„Éº</strong>ÂØæÂøú</li>
                    <li><strong>Ë®≠ÂÆö‰øùÂ≠ò„ÉªÂÜçÂà©Áî®</strong>ÂèØËÉΩ</li>
                    <li><strong>„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÈáçË¶ñ</strong>„ÅÆËªΩÈáèË®≠Ë®à</li>
                </ul>
            </div>
        </div>

        <!-- ‰ΩøÁî®ÊñπÊ≥ï„ÅÆÊØîËºÉ -->
        <div class="section">
            <div class="section-header">
                üîÑ ‰ΩøÁî®ÊñπÊ≥ï„ÅÆÊØîËºÉ
            </div>
            <div class="section-content">
                <div class="comparison-grid">
                    <div class="comparison-item before">
                        <h4>üìù ÂæìÊù•„ÅÆÊñπÊ≥ï</h4>
                        <div class="code-box before">
&lt;div id="purattokun-config" style="display: none;"
     data-x="18" data-y="49" data-scale="0.55"&gt;
&lt;/div&gt;
&lt;canvas id="hero-purattokun"&gt;&lt;/canvas&gt;
&lt;script src="assets/spine/spine-character-manager.js"&gt;&lt;/script&gt;
&lt;script&gt;
  initSpineCharacter('hero-purattokun', {...});
&lt;/script&gt;
                        </div>
                        <p><strong>Ë™≤È°åÔºö</strong> Ë§áÈõë„Å™Ë®≠ÂÆö„ÄÅ‰ΩçÁΩÆË™øÊï¥„ÅåÂõ∞Èõ£</p>
                    </div>

                    <div class="comparison-item after">
                        <h4>‚ú® Êñ∞„Ç∑„Çπ„ÉÜ„É†</h4>
                        <div class="code-box after">
&lt;!-- 1Ë°åËøΩÂä†„Åô„Çã„Å†„Åë --&gt;
&lt;script src="assets/spine/spine-easy.js"&gt;&lt;/script&gt;

&lt;!-- „Ç∑„É≥„Éó„É´„Å™Ë®≠ÂÆö --&gt;
&lt;div class="spine-character" 
     data-character="purattokun"
     data-x="18" data-y="49" data-scale="0.55"&gt;
&lt;/div&gt;
                        </div>
                        <p><strong>Âà©ÁÇπÔºö</strong> „Ç∑„É≥„Éó„É´„ÄÅË¶ñË¶öÁöÑË™øÊï¥ÂèØËÉΩ</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÂÆüÈöõ„ÅÆ‰ΩøÁî®ÊâãÈ†Ü -->
        <div class="section">
            <div class="section-header">
                üì± ÂÆüÈöõ„ÅÆ‰ΩøÁî®ÊâãÈ†Ü
            </div>
            <div class="section-content">
                <div class="usage-flow">
                    <div class="flow-step">
                        <div class="flow-number">1</div>
                        <div><strong>„Éö„Éº„Ç∏„ÇíÈñã„Åè</strong></div>
                        <div style="font-size: 0.9rem; color: #666;">ÈÄöÂ∏∏ÈÄö„Çä„Ç¢„ÇØ„Çª„Çπ</div>
                    </div>
                    <div class="flow-step">
                        <div class="flow-number">2</div>
                        <div><strong>Á∑®ÈõÜ„É¢„Éº„ÉâÊúâÂäπ</strong></div>
                        <div style="font-size: 0.9rem; color: #666;">?spine-edit=true</div>
                    </div>
                    <div class="flow-step">
                        <div class="flow-number">3</div>
                        <div><strong>„Éâ„É©„ÉÉ„Ç∞„ÅßÈÖçÁΩÆ</strong></div>
                        <div style="font-size: 0.9rem; color: #666;">„Éû„Ç¶„ÇπÊìç‰Ωú„ÅÆ„Åø</div>
                    </div>
                    <div class="flow-step">
                        <div class="flow-number">4</div>
                        <div><strong>‰øùÂ≠òÂÆå‰∫Ü</strong></div>
                        <div style="font-size: 0.9rem; color: #666;">Ë®≠ÂÆöËá™Âãï‰øùÂ≠ò</div>
                    </div>
                </div>

                <h3>üîß ÂÖ∑‰ΩìÁöÑ„Å™Êìç‰Ωú‰æã</h3>
                <div style="background: #f0f8ff; padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h4>üìù Á∑®ÈõÜÊôÇ„ÅÆÁîªÈù¢</h4>
                    <pre style="background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto;">
URL: http://localhost:8000/index.html?spine-edit=true

ÁîªÈù¢Ë°®Á§∫:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [Á∑®ÈõÜ„É¢„Éº„Éâ] ‰øùÂ≠ò | ÁµÇ‰∫Ü        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ËÉåÊôØÁîªÂÉè                       ‚îÇ
‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                     ‚îÇ
‚îÇ    ‚îÇ„Å∑„Çâ„Å£„Å®‚îÇ ‚Üê „Éâ„É©„ÉÉ„Ç∞ÂèØËÉΩ     ‚îÇ
‚îÇ    ‚îÇ  „Åè„Çì ‚îÇ   „Çµ„Ç§„Ç∫Â§âÊõ¥ÂèØËÉΩ   ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                     ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ ‰ΩçÁΩÆ: X=20vw, Y=45vh           ‚îÇ
‚îÇ „Çµ„Ç§„Ç∫: 0.6ÂÄç                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</pre>
                </div>

                <h3>üíæ ÁîüÊàê„Åï„Çå„Çã„Ç≥„Éº„Éâ</h3>
                <div class="code-box after">
&lt;!-- ‰øùÂ≠òÂæå„ÄÅ„Åì„ÅÆ„Ç≥„Éº„Éâ„ÅåËá™ÂãïÁîüÊàê„Åï„Çå„Çã --&gt;
&lt;div class="spine-character" 
     data-character="purattokun"
     data-x="20" data-y="45" data-scale="0.6"&gt;
&lt;/div&gt;

&lt;!-- ‰ªñ„ÅÆ„Éö„Éº„Ç∏„Åß„ÇÇÂêå„ÅòË®≠ÂÆö„ÅßÂÜçÂà©Áî®ÂèØËÉΩ --&gt;
                </div>
            </div>
        </div>

        <!-- Ë§áÊï∞„Ç≠„É£„É©„ÇØ„Çø„ÉºÂØæÂøú -->
        <div class="section">
            <div class="section-header">
                üé≠ Ë§áÊï∞„Ç≠„É£„É©„ÇØ„Çø„ÉºÂØæÂøú
            </div>
            <div class="section-content">
                <h3>üìù Ë§áÊï∞ÈÖçÁΩÆ„ÅÆ‰æã</h3>
                <div class="code-box after">
&lt;script src="assets/spine/spine-easy.js"&gt;&lt;/script&gt;

&lt;!-- „Ç≠„É£„É©„ÇØ„Çø„Éº1: „Å∑„Çâ„Å£„Å®„Åè„Çì --&gt;
&lt;div class="spine-character" 
     data-character="purattokun"
     data-x="18" data-y="49" data-scale="0.55"&gt;
&lt;/div&gt;

&lt;!-- „Ç≠„É£„É©„ÇØ„Çø„Éº2: Áå´ --&gt;
&lt;div class="spine-character" 
     data-character="neko"
     data-x="70" data-y="30" data-scale="0.4"&gt;
&lt;/div&gt;

&lt;!-- „Ç≠„É£„É©„ÇØ„Çø„Éº3: Áä¨ --&gt;
&lt;div class="spine-character" 
     data-character="inu"
     data-x="50" data-y="80" data-scale="0.6"&gt;
&lt;/div&gt;
                </div>

                <h3>üñºÔ∏è Á∑®ÈõÜ„É¢„Éº„Éâ„Åß„ÅÆÁÆ°ÁêÜ</h3>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <pre>
Á∑®ÈõÜ„É¢„Éº„ÉâÁîªÈù¢:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [Á∑®ÈõÜ„É¢„Éº„Éâ] ‰øùÂ≠ò | ÂÖ®ÈÅ∏Êäû | ÁµÇ‰∫Ü   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ËÉåÊôØÁîªÂÉè                           ‚îÇ
‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îÇ
‚îÇ    ‚îÇ„Å∑„Çâ„Å£„Å®‚îÇ ‚ë†    ‚îÇ Áå´  ‚îÇ ‚ë°          ‚îÇ
‚îÇ    ‚îÇ  „Åè„Çì ‚îÇ      ‚îÇ     ‚îÇ            ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ           ‚îÇ Áä¨  ‚îÇ ‚ë¢                ‚îÇ
‚îÇ           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ ÈÅ∏Êäû‰∏≠: „Å∑„Çâ„Å£„Å®„Åè„Çì                ‚îÇ
‚îÇ ‰ΩçÁΩÆ: X=18vw, Y=49vh               ‚îÇ
‚îÇ „Çµ„Ç§„Ç∫: 0.55ÂÄç                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    </pre>
                </div>
            </div>
        </div>

        <!-- CanvasÂà∂Âæ°Ê©üËÉΩ -->
        <div class="section">
            <div class="section-header">
                üé® CanvasÂà∂Âæ°Ê©üËÉΩ
            </div>
            <div class="section-content">
                <h3>üìê Canvas„Çµ„Ç§„Ç∫„Éª‰ΩçÁΩÆ„ÅÆË™øÊï¥</h3>
                <div class="code-box after">
&lt;!-- CanvasË©≥Á¥∞Ë®≠ÂÆö --&gt;
&lt;div class="spine-character" 
     data-character="purattokun"
     data-x="18" data-y="49" data-scale="0.55"
     data-canvas-width="200"    &lt;!-- CanvasÂπÖ --&gt;
     data-canvas-height="200"   &lt;!-- CanvasÈ´ò„Åï --&gt;
     data-canvas-visible="true"&gt; &lt;!-- CanvasÊû†Ë°®Á§∫ --&gt;
&lt;/div&gt;
                </div>

                <h3>üîß Á∑®ÈõÜ„É¢„Éº„Éâ„Åß„ÅÆÊìç‰ΩúÊñπÊ≥ï</h3>
                <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h4>üé≠ „Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜ„É¢„Éº„Éâ</h4>
                    <ul style="padding-left: 20px;">
                        <li><strong>ÁßªÂãï</strong>Ôºö„Ç≠„É£„É©„ÇØ„Çø„ÉºÊú¨‰Ωì„Çí„Éâ„É©„ÉÉ„Ç∞</li>
                        <li><strong>„Çµ„Ç§„Ç∫Â§âÊõ¥</strong>Ôºö4„Å§Ëßí„ÅÆ„Éè„É≥„Éâ„É´„Çí„Éâ„É©„ÉÉ„Ç∞</li>
                        <li><strong>Âõ∫ÂÆöÁÇπ„É™„Çµ„Ç§„Ç∫</strong>ÔºöÂØæËßí„ÅÆËßí„ÅåÂõ∫ÂÆöÁÇπ„Å®„Åó„Å¶Á∂≠ÊåÅ„Åï„Çå„Çã</li>
                        <li><strong>Âú∞Èù¢Âõ∫ÂÆö</strong>ÔºöÂ∑¶‰∏ä„Éè„É≥„Éâ„É´ = Âè≥‰∏ãÔºàÂú∞Èù¢ÔºâÂõ∫ÂÆö„Åß‰æøÂà©</li>
                    </ul>
                    
                    <h4>üé® Ë°®Á§∫ÁØÑÂõ≤ÔºàCanvasÔºâÁ∑®ÈõÜ„É¢„Éº„Éâ</h4>
                    <ul style="padding-left: 20px;">
                        <li><strong>„Ç≠„É£„É©„ÇØ„Çø„ÉºË°®Á§∫ÁØÑÂõ≤</strong>ÔºöË¶ã„Åà„ÇãÈ†òÂüü„ÅÆ„Çµ„Ç§„Ç∫„ÇíË™øÊï¥</li>
                        <li><strong>„ÇØ„É™„ÉÉ„Éî„É≥„Ç∞Âà∂Âæ°</strong>ÔºöÁØÑÂõ≤Â§ñ„ÅØÈùûË°®Á§∫„Å´</li>
                        <li><strong>ÂÜÖÈÉ®Ëß£ÂÉèÂ∫¶ÈÄ£Âãï</strong>ÔºöSpine WebGL„ÅÆÊèèÁîªÂìÅË≥™„ÇÇË™øÊï¥</li>
                        <li><strong>ÊúÄÂ∞è„Çµ„Ç§„Ç∫</strong>Ôºö40√ó40px‰ª•‰∏ä„ÅßÂà∂Èôê</li>
                    </ul>
                </div>

                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #ffc107;">
                    <h4 style="color: #856404; margin-bottom: 8px;">üí° ÂÆüÁî®ÁöÑ„Å™‰ΩøÁî®‰æã</h4>
                    <ul style="color: #856404; margin: 0; padding-left: 20px;">
                        <li><strong>Âú∞Èù¢„Å´Á´ã„Åü„Åõ„Çã</strong>Ôºö„Ç≠„É£„É©„ÇØ„Çø„Éº„ÇíÂú∞Èù¢„Å´ÈÖçÁΩÆÂæå„ÄÅÂ∑¶‰∏ä„Éè„É≥„Éâ„É´„ÅßÂú∞Èù¢„ÇíÂõ∫ÂÆö„Åó„Åü„Åæ„Åæ„Çµ„Ç§„Ç∫Ë™øÊï¥</li>
                        <li><strong>Â§©‰∫ï„Å´Âêä„Çã„Åô</strong>ÔºöÂè≥‰∏ã„Éè„É≥„Éâ„É´„ÅßÂ§©‰∫ï‰ΩçÁΩÆ„ÇíÂõ∫ÂÆö„Åó„Åü„Åæ„Åæ„Çµ„Ç§„Ç∫Â§âÊõ¥</li>
                        <li><strong>Â∑¶Âè≥„ÅÆÂü∫Ê∫ñÁ∑ö</strong>ÔºöÂ∑¶‰∏ã/Âè≥‰∏ã„Éè„É≥„Éâ„É´„ÅßÊ®™„ÅÆÂü∫Ê∫ñÁ∑ö„ÇíÂõ∫ÂÆö</li>
                        <li><strong>‰∏≠ÂøÉÁÇπÂõ∫ÂÆö</strong>Ôºö‰ªªÊÑè„ÅÆËßí„Çí‰∏≠ÂøÉ„Å®„Åó„Å¶ÊîæÂ∞ÑÁä∂„Å´„Çµ„Ç§„Ç∫Â§âÊõ¥</li>
                    </ul>
                </div>

                <div class="demo-screen" id="canvasDemo">
                    <!-- „Ç≠„É£„É©„ÇØ„Çø„ÉºË°®Á§∫ÁØÑÂõ≤ÔºàCanvasÔºâ -->
                    <div class="character-canvas" id="characterCanvas">
                        <!-- Ë°®Á§∫ÁØÑÂõ≤„É™„Çµ„Ç§„Ç∫„Éè„É≥„Éâ„É´ -->
                        <div class="canvas-resize-handle nw" data-direction="nw"></div>
                        <div class="canvas-resize-handle ne" data-direction="ne"></div>
                        <div class="canvas-resize-handle sw" data-direction="sw"></div>
                        <div class="canvas-resize-handle se" data-direction="se"></div>
                        
                        <div class="demo-character" id="demoCharacter" style="left: 60px; top: 60px; transform: translate(-50%, -50%);">
                            <img src="assets/images/purattokunn.png" alt="„Å∑„Çâ„Å£„Å®„Åè„Çì" style="width: 100%; height: 100%; object-fit: contain;">
                            <!-- „Ç≠„É£„É©„ÇØ„Çø„Éº „É™„Çµ„Ç§„Ç∫„Éè„É≥„Éâ„É´ -->
                            <div class="resize-handle nw" data-direction="nw"></div>
                            <div class="resize-handle ne" data-direction="ne"></div>
                            <div class="resize-handle sw" data-direction="sw"></div>
                            <div class="resize-handle se" data-direction="se"></div>
                        </div>
                    </div>
                </div>

                <div class="demo-controls">
                    <button class="demo-button" onclick="toggleEditMode()">„Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜ</button>
                    <button class="demo-button" onclick="toggleCanvasEditMode()">Ë°®Á§∫ÁØÑÂõ≤Á∑®ÈõÜ</button>
                    <button class="demo-button" onclick="resetPosition()">‰ΩçÁΩÆ„É™„Çª„ÉÉ„Éà</button>
                    <button class="demo-button" onclick="resetSize()">„Çµ„Ç§„Ç∫„É™„Çª„ÉÉ„Éà</button>
                </div>
                
                <!-- Á∑®ÈõÜÁ¢∫ÂÆö„Éú„Çø„É≥ÔºàÁ∑®ÈõÜ‰∏≠„ÅÆ„ÅøË°®Á§∫Ôºâ -->
                <div class="edit-confirm-panel" id="editConfirmPanel" style="display: none;">
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #ffc107;">
                        <div style="text-align: center; margin-bottom: 10px;">
                            <strong>üìù Á∑®ÈõÜ‰∏≠</strong> - Â§âÊõ¥„ÇíÁ¢∫ÂÆö„Åó„Åæ„Åô„ÅãÔºü
                        </div>
                        <div style="text-align: center;">
                            <button class="demo-button" onclick="confirmEdit()" style="background: #28a745; margin-right: 10px;">üíæ ‰øùÂ≠ò</button>
                            <button class="demo-button" onclick="cancelEdit()" style="background: #6c757d;">‚ùå „Ç≠„É£„É≥„Çª„É´</button>
                        </div>
                    </div>
                </div>
                <div class="coordinate-display" id="coordinateDisplay"></div>
            </div>
        </div>

        <!-- ‰∏ªË¶ÅÊ©üËÉΩ -->
        <div class="section">
            <div class="section-header">
                ‚≠ê ‰∏ªË¶ÅÊ©üËÉΩ‰∏ÄË¶ß
            </div>
            <div class="section-content">
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">üñ±Ô∏è</div>
                        <div style="font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó</div>
                        <p>„Éû„Ç¶„Çπ„Åß„Ç≠„É£„É©„ÇØ„Çø„Éº„ÇíÁõ¥ÊÑüÁöÑ„Å´ÁßªÂãï</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üé≠</div>
                        <div style="font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">Ë§áÊï∞„Ç≠„É£„É©„ÇØ„Çø„Éº</div>
                        <p>Ë§áÊï∞„ÅÆ„Ç≠„É£„É©„ÇØ„Çø„Éº„ÇíÂêåÊôÇÁÆ°ÁêÜ</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üé®</div>
                        <div style="font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">CanvasÂà∂Âæ°</div>
                        <p>Ë°®Á§∫È†òÂüü„ÅÆ„Çµ„Ç§„Ç∫„Éª‰ΩçÁΩÆË™øÊï¥</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üíæ</div>
                        <div style="font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">Ëá™Âãï‰øùÂ≠ò</div>
                        <p>Ë®≠ÂÆö„ÅÆËá™Âãï‰øùÂ≠ò„Éª„Ç≥„Éº„ÉâÁîüÊàê</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">‚ö°</div>
                        <div style="font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">È´òÈÄüÂãï‰Ωú</div>
                        <p>„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÈáçË¶ñ„ÅÆËªΩÈáèË®≠Ë®à</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üîó</div>
                        <div style="font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">Á∞°ÂçòÂ∞éÂÖ•</div>
                        <p>Êó¢Â≠ò„Éö„Éº„Ç∏„Å´1Ë°åËøΩÂä†„Åô„Çã„Å†„Åë</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÂÆüË£ÖË®àÁîª -->
        <div class="section">
            <div class="section-header">
                üìÖ ÊÆµÈöéÁöÑÂÆüË£ÖË®àÁîª
            </div>
            <div class="section-content">
                <div class="usage-flow">
                    <div class="flow-step">
                        <div class="flow-number">1</div>
                        <div><strong>Âü∫Êú¨„É©„Ç§„Éñ„É©„É™</strong></div>
                        <div style="font-size: 0.9rem; color: #666;">spine-easy.js‰ΩúÊàê</div>
                    </div>
                    <div class="flow-step">
                        <div class="flow-number">2</div>
                        <div><strong>Á∑®ÈõÜ„É¢„Éº„Éâ</strong></div>
                        <div style="font-size: 0.9rem; color: #666;">„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó</div>
                    </div>
                    <div class="flow-step">
                        <div class="flow-number">3</div>
                        <div><strong>È´òÂ∫¶Ê©üËÉΩ</strong></div>
                        <div style="font-size: 0.9rem; color: #666;">Ë§áÊï∞„Ç≠„É£„É©ÂØæÂøú</div>
                    </div>
                </div>

                <h3>üìã ÂêÑÊÆµÈöé„ÅÆË©≥Á¥∞</h3>
                <div style="margin: 20px 0;">
                    <div style="border-left: 4px solid #4caf50; padding-left: 20px; margin-bottom: 20px;">
                        <h4>Phase 1: Âü∫Êú¨„É©„Ç§„Éñ„É©„É™Ôºà1ÈÄ±ÈñìÔºâ</h4>
                        <ul style="padding-left: 20px;">
                            <li>spine-easy.js „ÅÆÂü∫Êú¨Ê©üËÉΩ</li>
                            <li>dataÂ±ûÊÄß„Å´„Çà„ÇãÁ∞°ÂçòË®≠ÂÆö</li>
                            <li>Êó¢Â≠ò„Ç∑„Çπ„ÉÜ„É†„Å®„ÅÆ‰∫íÊèõÊÄßÁ¢∫‰øù</li>
                            <li>„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©Âåñ</li>
                        </ul>
                    </div>
                    
                    <div style="border-left: 4px solid #ff9800; padding-left: 20px; margin-bottom: 20px;">
                        <h4>Phase 2: Á∑®ÈõÜ„É¢„Éº„ÉâÔºà2ÈÄ±ÈñìÁõÆÔºâ</h4>
                        <ul style="padding-left: 20px;">
                            <li>URL„Éë„É©„É°„Éº„Çø„Å´„Çà„ÇãÁ∑®ÈõÜ„É¢„Éº„ÉâÊúâÂäπÂåñ</li>
                            <li>„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„ÉóÊ©üËÉΩ</li>
                            <li>„É™„Ç¢„É´„Çø„Ç§„É†„Éó„É¨„Éì„É•„Éº</li>
                            <li>Ë®≠ÂÆö‰øùÂ≠òÊ©üËÉΩ</li>
                        </ul>
                    </div>
                    
                    <div style="border-left: 4px solid #9c27b0; padding-left: 20px;">
                        <h4>Phase 3: È´òÂ∫¶Ê©üËÉΩÔºà3ÈÄ±ÈñìÁõÆÔºâ</h4>
                        <ul style="padding-left: 20px;">
                            <li>Ë§áÊï∞„Ç≠„É£„É©„ÇØ„Çø„ÉºÁÆ°ÁêÜ</li>
                            <li>CanvasÂà∂Âæ°Ê©üËÉΩ</li>
                            <li>Ë®≠ÂÆöÂÖ±ÊúâURLÁîüÊàê</li>
                            <li>„É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøúÂº∑Âåñ</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- „Åæ„Å®„ÇÅ -->
        <div class="section">
            <div class="section-header">
                üìù „Åæ„Å®„ÇÅ
            </div>
            <div class="section-content">
                <div class="highlight-box">
                    <h3>üéØ Êñ∞„Ç∑„Çπ„ÉÜ„É†„ÅÆ‰æ°ÂÄ§</h3>
                    <p>Êó¢Â≠ò„Éö„Éº„Ç∏„Å´<strong>1Ë°åËøΩÂä†</strong>„Åô„Çã„Å†„Åë„Åß„ÄÅ<strong>Ë¶ñË¶öÁöÑ„Å™„Ç≠„É£„É©„ÇØ„Çø„ÉºÈÖçÁΩÆ</strong>„ÅåÂèØËÉΩ„Å´„Å™„Çä„Åæ„Åô</p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0;">
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 3rem; margin-bottom: 10px;">‚ö°</div>
                        <h4>È´òÈÄü</h4>
                        <p>„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÈáçË¶ñË®≠Ë®à</p>
                    </div>
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 3rem; margin-bottom: 10px;">üé®</div>
                        <h4>Áõ¥ÊÑüÁöÑ</h4>
                        <p>„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„ÉóÊìç‰Ωú</p>
                    </div>
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 3rem; margin-bottom: 10px;">üîó</div>
                        <h4>Á∞°ÂçòÂ∞éÂÖ•</h4>
                        <p>1Ë°åËøΩÂä†„ÅßÂÆå‰∫Ü</p>
                    </div>
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 3rem; margin-bottom: 10px;">üõ°Ô∏è</div>
                        <h4>ÂÆâÂÖ®</h4>
                        <p>Êó¢Â≠ò„Ç∑„Çπ„ÉÜ„É†„Å´ÂΩ±Èüø„Å™„Åó</p>
                    </div>
                </div>

                <p style="text-align: center; font-size: 1.2rem; margin-top: 30px;">
                    <strong>Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„ÉóÔºö</strong> Phase 1ÔºàÂü∫Êú¨„É©„Ç§„Éñ„É©„É™Ôºâ„ÅÆÂÆüË£ÖÈñãÂßã
                </p>
            </div>
        </div>
    </div>

    <script>
        // „Éá„É¢Áî®„ÅÆÂ§âÊï∞
        let isCharacterEditMode = false;
        let isCanvasEditMode = false;
        let isDragging = false;
        let isResizing = false;
        let resizeType = ''; // 'character' or 'canvas'
        let resizeDirection = '';
        let startMousePos = { x: 0, y: 0 };
        let startElementPos = { x: 0, y: 0, width: 0, height: 0 };

        // DOMË¶ÅÁ¥†
        const character = document.getElementById('demoCharacter');
        const characterCanvas = document.getElementById('characterCanvas');
        const demoScreen = document.getElementById('canvasDemo');
        const coordinateDisplay = document.getElementById('coordinateDisplay');
        const editConfirmPanel = document.getElementById('editConfirmPanel');

        // ÂàùÊúüË®≠ÂÆö
        window.addEventListener('load', () => {
            // localStorage„Åã„Çâ‰øùÂ≠ò„Åï„Çå„ÅüÁä∂ÊÖã„ÇíË™≠„ÅøËæº„Åø
            try {
                const saved = localStorage.getItem('spine-positioning-state');
                if (saved) {
                    const loadedState = JSON.parse(saved);
                    console.log('‚úÖ localStorage„Åã„ÇâÁä∂ÊÖã„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü:', loadedState);
                    
                    // Ë™≠„ÅøËæº„Çì„Å†Áä∂ÊÖã„ÇíÈÅ©Áî®
                    character.style.left = loadedState.character.left;
                    character.style.top = loadedState.character.top;
                    character.style.width = loadedState.character.width;
                    character.style.height = loadedState.character.height;
                    
                    characterCanvas.style.left = loadedState.canvas.left;
                    characterCanvas.style.top = loadedState.canvas.top;
                    characterCanvas.style.width = loadedState.canvas.width;
                    characterCanvas.style.height = loadedState.canvas.height;
                    
                    // savedState„ÇÇÊõ¥Êñ∞
                    savedState = loadedState;
                    
                    coordinateDisplay.textContent = 'üì• ÂâçÂõû‰øùÂ≠ò„Åó„Åü‰ΩçÁΩÆ„ÇíÂæ©ÂÖÉ„Åó„Åæ„Åó„Åü';
                    setTimeout(() => {
                        coordinateDisplay.textContent = '';
                    }, 2000);
                } else {
                    // ‰øùÂ≠ò„Åï„Çå„ÅüÁä∂ÊÖã„Åå„Å™„ÅÑÂ†¥Âêà„ÅØÂàùÊúüÂåñ
                    initializeSavedState();
                }
            } catch (e) {
                console.error('‚ùå localStorageË™≠„ÅøËæº„Åø„Ç®„É©„Éº:', e);
                // „Ç®„É©„ÉºÊôÇ„ÅØÂàùÊúüÂåñ
                initializeSavedState();
            }
            
            setupResizeHandlers();
        });

        // ÂàùÊúüÁä∂ÊÖã„ÅÆ‰øùÂ≠ò
        function initializeSavedState() {
            console.log('üîß ÂàùÊúüÂåñÂâç„ÅÆÁä∂ÊÖã:', {
                charLeft: character.style.left,
                charTop: character.style.top,
                canvasWidth: characterCanvas.style.width,
                canvasHeight: characterCanvas.style.height
            });
            
            // Áúü„ÅÆÂàùÊúüÁä∂ÊÖã„Å´Âº∑Âà∂„É™„Çª„ÉÉ„ÉàÔºàCanvas‰∏≠ÂøÉ„Å´„Éî„ÇØ„Çª„É´ÊåáÂÆöÔºâ
            character.style.left = '60px';
            character.style.top = '60px';
            character.style.transform = 'translate(-50%, -50%)';
            character.style.width = '80px';
            character.style.height = '80px';
            
            characterCanvas.style.left = '25%';
            characterCanvas.style.top = '65%';
            characterCanvas.style.width = '120px';
            characterCanvas.style.height = '120px';
            
            console.log('üîß „É™„Çª„ÉÉ„ÉàÂæå„ÅÆÁä∂ÊÖã:', {
                charLeft: character.style.left,
                charTop: character.style.top,
                canvasWidth: characterCanvas.style.width,
                canvasHeight: characterCanvas.style.height
            });
            
            // Âº∑Âà∂„É¨„É≥„ÉÄ„É™„É≥„Ç∞Á¢∫ÂÆüÂåñ
            character.offsetHeight; // Âº∑Âà∂„É™„Éï„É≠„Éº
            characterCanvas.offsetHeight;
            
            // „É™„Çª„ÉÉ„ÉàÂæå„ÅÆÁä∂ÊÖã„ÇíÂç≥Â∫ß„Å´‰øùÂ≠òÔºàsetTimeout„ÅØ‰Ωø„Çè„Å™„ÅÑÔºâ
            savedState.character.left = character.style.left;
            savedState.character.top = character.style.top;
            savedState.character.width = character.style.width;
            savedState.character.height = character.style.height;
            
            savedState.canvas.left = characterCanvas.style.left;
            savedState.canvas.top = characterCanvas.style.top;
            savedState.canvas.width = characterCanvas.style.width;
            savedState.canvas.height = characterCanvas.style.height;
            
            console.log('‚úÖ ÂàùÊúüÁä∂ÊÖã„ÇíÂº∑Âà∂„É™„Çª„ÉÉ„Éà„Éª‰øùÂ≠ò„Åó„Åæ„Åó„Åü:', savedState);
        }

        // Âõ∫ÂÆöÁÇπ„ÅÆÂêçÂâç„ÇíÂèñÂæó
        function getFixedPointName(resizeDirection) {
            switch (resizeDirection) {
                case 'se': return 'Â∑¶‰∏ä';     // SE(Âè≥‰∏ã)„Éè„É≥„Éâ„É´ ‚Üí NW(Â∑¶‰∏ä)Âõ∫ÂÆö
                case 'sw': return 'Âè≥‰∏ä';     // SW(Â∑¶‰∏ã)„Éè„É≥„Éâ„É´ ‚Üí NE(Âè≥‰∏ä)Âõ∫ÂÆö  
                case 'ne': return 'Â∑¶‰∏ã';     // NE(Âè≥‰∏ä)„Éè„É≥„Éâ„É´ ‚Üí SW(Â∑¶‰∏ã)Âõ∫ÂÆö
                case 'nw': return 'Âè≥‰∏ã';     // NW(Â∑¶‰∏ä)„Éè„É≥„Éâ„É´ ‚Üí SE(Âè≥‰∏ã)Âõ∫ÂÆö
                default: return '';
            }
        }

        // „Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜ„É¢„Éº„ÉâÂàá„ÇäÊõø„Åà
        function toggleEditMode() {
            const button = event.target;
            
            // Á∑®ÈõÜ‰∏≠„ÅßÁ¢∫ÂÆö„Éë„Éç„É´„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØÁä∂ÊÖãÂ§âÊõ¥„Åó„Å™„ÅÑ
            if (isCharacterEditMode && editConfirmPanel.style.display === 'block') {
                // Á¢∫ÂÆö„Çí‰øÉ„Åô„É°„ÉÉ„Çª„Éº„Ç∏„ÅÆ„ÅøË°®Á§∫ÔºàÁä∂ÊÖã„ÅØÂ§âÊõ¥„Åó„Å™„ÅÑÔºâ
            } else {
                isCharacterEditMode = !isCharacterEditMode;
            }
            
            // Ë°®Á§∫ÁØÑÂõ≤Á∑®ÈõÜ„É¢„Éº„Éâ„ÇíÁÑ°ÂäπÂåñÔºàÊéí‰ªñÂà∂Âæ°Ôºâ
            if (isCanvasEditMode) {
                isCanvasEditMode = false;
                const canvasButton = document.querySelector('button[onclick="toggleCanvasEditMode()"]');
                if (canvasButton) {
                    canvasButton.textContent = 'Ë°®Á§∫ÁØÑÂõ≤Á∑®ÈõÜ';
                    canvasButton.classList.remove('active');
                }
                characterCanvas.classList.remove('canvas-edit-mode');
                removeCanvasDragEvents();
                coordinateDisplay.textContent = 'üîÑ Ë°®Á§∫ÁØÑÂõ≤Á∑®ÈõÜ„ÇíËá™ÂãïÁµÇ‰∫Ü„Åó„Åæ„Åó„Åü';
            }
            
            if (isCharacterEditMode) {
                // Á∑®ÈõÜÈñãÂßãÊôÇ„Å´ÁèæÂú®„ÅÆÁä∂ÊÖã„ÇíÊ≠£Á¢∫„Å´‰øùÂ≠ò
                const computedStyle = window.getComputedStyle(character);
                const currentLeft = character.style.left || computedStyle.left || '60px';
                const currentTop = character.style.top || computedStyle.top || '60px';
                const currentWidth = character.style.width || computedStyle.width || '80px';
                const currentHeight = character.style.height || computedStyle.height || '80px';
                
                console.log('üîß Á∑®ÈõÜÈñãÂßãÊôÇ„ÅÆ‰ΩçÁΩÆ‰øùÂ≠ò:', {
                    ÁèæÂú®„ÅÆstyleÂÄ§: {
                        left: character.style.left,
                        top: character.style.top,
                        width: character.style.width,
                        height: character.style.height
                    },
                    computedÂÄ§: {
                        left: computedStyle.left,
                        top: computedStyle.top,
                        width: computedStyle.width,
                        height: computedStyle.height
                    },
                    ‰øùÂ≠ò„Åô„ÇãÂÄ§: {
                        left: currentLeft,
                        top: currentTop,
                        width: currentWidth,
                        height: currentHeight
                    }
                });
                
                savedState.character.left = currentLeft;
                savedState.character.top = currentTop;
                savedState.character.width = currentWidth;
                savedState.character.height = currentHeight;
                
                button.textContent = 'Á∑®ÈõÜ‰∏≠...‰øùÂ≠ò„Éª„Ç≠„É£„É≥„Çª„É´„ÅßÁ¢∫ÂÆö';
                button.classList.add('active');
                character.classList.add('edit-mode');
                character.style.cursor = 'grab';
                coordinateDisplay.textContent = 'üîß „Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜ„É¢„Éº„Éâ - „Éâ„É©„ÉÉ„Ç∞„ÅßÁßªÂãï„ÄÅËßí„Çí„Éâ„É©„ÉÉ„Ç∞„Åß„Çµ„Ç§„Ç∫Â§âÊõ¥ÔºàÂØæËßí„ÅåÂõ∫ÂÆöÁÇπÔºâ';
                editConfirmPanel.style.display = 'block';
                setupCharacterDragEvents();
            } else {
                // Á∑®ÈõÜ‰∏≠„ÅÆÂ†¥Âêà„ÅØÁ¢∫ÂÆö„Çí‰øÉ„ÅôÔºàÁ∑®ÈõÜ„É¢„Éº„Éâ„ÅØÁ∂ôÁ∂öÔºâ
                if (editConfirmPanel.style.display === 'block') {
                    coordinateDisplay.textContent = '‚ö†Ô∏è ‰øùÂ≠ò„Åæ„Åü„ÅØ„Ç≠„É£„É≥„Çª„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
                    setTimeout(() => {
                        if (isCharacterEditMode) {
                            coordinateDisplay.textContent = 'üîß „Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜ„É¢„Éº„Éâ - „Éâ„É©„ÉÉ„Ç∞„ÅßÁßªÂãï„ÄÅËßí„Çí„Éâ„É©„ÉÉ„Ç∞„Åß„Çµ„Ç§„Ç∫Â§âÊõ¥ÔºàÂØæËßí„ÅåÂõ∫ÂÆöÁÇπÔºâ';
                        }
                    }, 3000);
                    return; // Á∑®ÈõÜ„É¢„Éº„Éâ„ÇíÁ∂ôÁ∂ö
                }
                
                button.textContent = '„Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜ';
                button.classList.remove('active');
                character.classList.remove('edit-mode');
                character.style.cursor = 'default';
                coordinateDisplay.textContent = '';
                editConfirmPanel.style.display = 'none';
                removeCharacterDragEvents();
            }
        }

        // Ë°®Á§∫ÁØÑÂõ≤Á∑®ÈõÜ„É¢„Éº„ÉâÂàá„ÇäÊõø„Åà
        function toggleCanvasEditMode() {
            const button = event.target;
            
            // Á∑®ÈõÜ‰∏≠„ÅßÁ¢∫ÂÆö„Éë„Éç„É´„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØÁä∂ÊÖãÂ§âÊõ¥„Åó„Å™„ÅÑ
            if (isCanvasEditMode && editConfirmPanel.style.display === 'block') {
                // Á¢∫ÂÆö„Çí‰øÉ„Åô„É°„ÉÉ„Çª„Éº„Ç∏„ÅÆ„ÅøË°®Á§∫ÔºàÁä∂ÊÖã„ÅØÂ§âÊõ¥„Åó„Å™„ÅÑÔºâ
            } else {
                isCanvasEditMode = !isCanvasEditMode;
            }
            
            // „Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜ„É¢„Éº„Éâ„ÇíÁÑ°ÂäπÂåñÔºàÊéí‰ªñÂà∂Âæ°Ôºâ
            if (isCharacterEditMode) {
                isCharacterEditMode = false;
                const characterButton = document.querySelector('button[onclick="toggleEditMode()"]');
                if (characterButton) {
                    characterButton.textContent = '„Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜ';
                    characterButton.classList.remove('active');
                }
                character.classList.remove('edit-mode');
                removeCharacterDragEvents();
                coordinateDisplay.textContent = 'üîÑ „Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜ„ÇíËá™ÂãïÁµÇ‰∫Ü„Åó„Åæ„Åó„Åü';
            }
            
            if (isCanvasEditMode) {
                // Á∑®ÈõÜÈñãÂßãÊôÇ„Å´ÁèæÂú®„ÅÆÁä∂ÊÖã„Çí‰øùÂ≠ò
                savedState.canvas.left = characterCanvas.style.left || '25%';
                savedState.canvas.top = characterCanvas.style.top || '65%';
                savedState.canvas.width = characterCanvas.style.width || '120px';
                savedState.canvas.height = characterCanvas.style.height || '120px';
                
                button.textContent = 'Á∑®ÈõÜ‰∏≠...‰øùÂ≠ò„Éª„Ç≠„É£„É≥„Çª„É´„ÅßÁ¢∫ÂÆö';
                button.classList.add('active');
                characterCanvas.classList.add('canvas-edit-mode');
                coordinateDisplay.textContent = 'üé® Ë°®Á§∫ÁØÑÂõ≤Á∑®ÈõÜ„É¢„Éº„Éâ - „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆË¶ã„Åà„ÇãÁØÑÂõ≤„Çí„É™„Çµ„Ç§„Ç∫';
                editConfirmPanel.style.display = 'block';
                setupCanvasDragEvents();
            } else {
                // Á∑®ÈõÜ‰∏≠„ÅÆÂ†¥Âêà„ÅØÁ¢∫ÂÆö„Çí‰øÉ„ÅôÔºàÁ∑®ÈõÜ„É¢„Éº„Éâ„ÅØÁ∂ôÁ∂öÔºâ
                if (editConfirmPanel.style.display === 'block') {
                    coordinateDisplay.textContent = '‚ö†Ô∏è ‰øùÂ≠ò„Åæ„Åü„ÅØ„Ç≠„É£„É≥„Çª„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
                    setTimeout(() => {
                        if (isCanvasEditMode) {
                            coordinateDisplay.textContent = 'üé® Ë°®Á§∫ÁØÑÂõ≤Á∑®ÈõÜ„É¢„Éº„Éâ - „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆË¶ã„Åà„ÇãÁØÑÂõ≤„Çí„É™„Çµ„Ç§„Ç∫';
                        }
                    }, 3000);
                    return; // Á∑®ÈõÜ„É¢„Éº„Éâ„ÇíÁ∂ôÁ∂ö
                }
                
                button.textContent = 'Ë°®Á§∫ÁØÑÂõ≤Á∑®ÈõÜ';
                button.classList.remove('active');
                characterCanvas.classList.remove('canvas-edit-mode');
                coordinateDisplay.textContent = '';
                editConfirmPanel.style.display = 'none';
                removeCanvasDragEvents();
            }
        }

        // ‰ΩçÁΩÆ„É™„Çª„ÉÉ„Éà
        function resetPosition() {
            character.style.left = '20px';
            character.style.top = '20px';
            characterCanvas.style.left = '25%';
            characterCanvas.style.top = '65%';
            coordinateDisplay.textContent = 'üîÑ ‰ΩçÁΩÆ„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„Åü („Ç≠„É£„É©„ÇØ„Çø„Éº: 20px,20px / Canvas: 25%,65%)';
            
            setTimeout(() => {
                if (!isCharacterEditMode && !isCanvasEditMode) coordinateDisplay.textContent = '';
            }, 2000);
        }

        // „Çµ„Ç§„Ç∫„É™„Çª„ÉÉ„Éà
        function resetSize() {
            character.style.width = '80px';
            character.style.height = '80px';
            characterCanvas.style.width = '120px';
            characterCanvas.style.height = '120px';
            coordinateDisplay.textContent = 'üìè „Çµ„Ç§„Ç∫„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„Åü („Ç≠„É£„É©„ÇØ„Çø„Éº: 80√ó80px / Canvas: 120√ó120px)';
            
            setTimeout(() => {
                if (!isCharacterEditMode && !isCanvasEditMode) coordinateDisplay.textContent = '';
            }, 2000);
        }

        // Á∑®ÈõÜÁä∂ÊÖã„ÅÆ‰øùÂ≠òÁî®Â§âÊï∞
        let savedState = {
            character: {
                left: '60px',  // Canvas‰∏≠ÂøÉÔºà120px / 2Ôºâ
                top: '60px',   // Canvas‰∏≠ÂøÉÔºà120px / 2Ôºâ
                width: '80px',
                height: '80px'
            },
            canvas: {
                left: '25%',
                top: '65%',
                width: '120px',
                height: '120px'
            }
        };

        // Á∑®ÈõÜÁ¢∫ÂÆö
        function confirmEdit() {
            // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅåCanvasÁØÑÂõ≤ÂÜÖ„Å´Âèé„Åæ„Çã„Çà„ÅÜ„Å´Ë™øÊï¥
            ensureCharacterWithinCanvas();
            
            // ÁèæÂú®„ÅÆÁä∂ÊÖã„Çí‰øùÂ≠òÁä∂ÊÖã„Å´ÂèçÊò†
            savedState.character.left = character.style.left;
            savedState.character.top = character.style.top;
            savedState.character.width = character.style.width;
            savedState.character.height = character.style.height;
            
            savedState.canvas.left = characterCanvas.style.left;
            savedState.canvas.top = characterCanvas.style.top;
            savedState.canvas.width = characterCanvas.style.width;
            savedState.canvas.height = characterCanvas.style.height;
            
            // localStorage„Å´Ê∞∏Á∂ö‰øùÂ≠ò
            try {
                localStorage.setItem('spine-positioning-state', JSON.stringify(savedState));
                console.log('‚úÖ Áä∂ÊÖã„ÇílocalStorage„Å´‰øùÂ≠ò„Åó„Åæ„Åó„Åü:', savedState);
            } catch (e) {
                console.error('‚ùå localStorage‰øùÂ≠ò„Ç®„É©„Éº:', e);
            }
            
            // Á∑®ÈõÜ„É¢„Éº„ÉâÂÆåÂÖ®ÁµÇ‰∫Ü
            endEditMode();
            
            coordinateDisplay.textContent = 'üíæ Â§âÊõ¥„Çí‰øùÂ≠ò„Åó„Åæ„Åó„ÅüÔºàÊ∞∏Á∂ö‰øùÂ≠òÔºâ';
            setTimeout(() => {
                coordinateDisplay.textContent = '';
            }, 2000);
        }

        // Á∑®ÈõÜ„Ç≠„É£„É≥„Çª„É´
        function cancelEdit() {
            console.log('üîÑ „Ç≠„É£„É≥„Çª„É´ÈñãÂßã - Âæ©ÂÖÉÂâç„ÅÆÁä∂ÊÖã:', {
                ÁèæÂú®„ÅÆ‰ΩçÁΩÆ: {
                    left: character.style.left,
                    top: character.style.top,
                    width: character.style.width,
                    height: character.style.height
                },
                ‰øùÂ≠ò„Åï„Çå„Å¶„ÅÑ„Åü‰ΩçÁΩÆ: savedState.character,
                Âæ©ÂÖÉ‰∫àÂÆö„ÅÆÂÄ§: {
                    left: savedState.character.left,
                    top: savedState.character.top,
                    width: savedState.character.width,
                    height: savedState.character.height
                }
            });
            
            // ‰øùÂ≠ò„Åï„Çå„ÅüÂàùÊúüÁä∂ÊÖã„Å´ÂÆåÂÖ®„Å´Êàª„Åô
            character.style.left = savedState.character.left;
            character.style.top = savedState.character.top;
            character.style.width = savedState.character.width;
            character.style.height = savedState.character.height;
            
            characterCanvas.style.left = savedState.canvas.left;
            characterCanvas.style.top = savedState.canvas.top;
            characterCanvas.style.width = savedState.canvas.width;
            characterCanvas.style.height = savedState.canvas.height;
            
            console.log('üîÑ Âæ©ÂÖÉÂÆüË°åÂæå„ÅÆÂÆüÈöõ„ÅÆÂÄ§:', {
                Âæ©ÂÖÉÂæå„ÅÆstyle: {
                    left: character.style.left,
                    top: character.style.top,
                    width: character.style.width,
                    height: character.style.height
                }
            });
            
            // Âæ©ÂÖÉÂæå„ÅÆË©≥Á¥∞„Å™ÂèØË¶ñÊÄßÁ¢∫Ë™ç
            const characterLeft = parseFloat(character.style.left) || 0;
            const characterTop = parseFloat(character.style.top) || 0;
            const characterWidth = character.offsetWidth;
            const characterHeight = character.offsetHeight;
            const canvasWidth = characterCanvas.offsetWidth;
            const canvasHeight = characterCanvas.offsetHeight;
            
            // transform: translate(-50%, -50%)„ÇíËÄÉÊÖÆ„Åó„ÅüÂÆüÈöõ„ÅÆ‰ΩçÁΩÆË®àÁÆó
            const actualLeft = characterLeft - characterWidth / 2;
            const actualTop = characterTop - characterHeight / 2;
            const actualRight = actualLeft + characterWidth;
            const actualBottom = actualTop + characterHeight;
            
            // CanvasÁØÑÂõ≤ÂÜÖ„Å´„ÅÇ„Çã„Åã„Å©„ÅÜ„Åã„ÅÆÊ≠£Á¢∫„Å™Âà§ÂÆö
            const isWithinCanvas = actualLeft >= 0 && actualTop >= 0 && 
                                   actualRight <= canvasWidth && actualBottom <= canvasHeight;
            const hasValidSize = characterWidth > 0 && characterHeight > 0;
            
            console.log('‚úÖ „Ç≠„É£„É≥„Çª„É´ÂÆå‰∫Ü - Ë©≥Á¥∞Áä∂ÊÖãÁ¢∫Ë™ç:', {
                Âæ©ÂÖÉ„Åï„Çå„Åü‰ΩçÁΩÆ: savedState.character,
                „Ç≠„É£„É©„ÇØ„Çø„ÉºÂü∫Êú¨ÊÉÖÂ†±: {
                    Ë®≠ÂÆö‰ΩçÁΩÆ: { left: characterLeft, top: characterTop },
                    „Çµ„Ç§„Ç∫: { width: characterWidth, height: characterHeight },
                    ÊúâÂäπ„Çµ„Ç§„Ç∫: hasValidSize
                },
                CanvasÊÉÖÂ†±: {
                    „Çµ„Ç§„Ç∫: { width: canvasWidth, height: canvasHeight }
                },
                ‰ΩçÁΩÆË®àÁÆóË©≥Á¥∞: {
                    transformËÄÉÊÖÆÂæå: { left: actualLeft, top: actualTop, right: actualRight, bottom: actualBottom },
                    CanvasÁØÑÂõ≤ÂÜÖ: isWithinCanvas
                }
            });
            
            // Á∑äÊÄ•ÊôÇÔºö„Ç≠„É£„É©„ÇØ„Çø„Éº„ÅåÁØÑÂõ≤Â§ñ„Å´„ÅÇ„ÇãÂ†¥Âêà„ÅØÂÆâÂÖ®‰ΩçÁΩÆ„Å´ÁßªÂãï
            if (!hasValidSize || !isWithinCanvas) {
                console.log('‚ö†Ô∏è „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅåÁØÑÂõ≤Â§ñ„Åß„Åô - Á∑äÊÄ•‰øÆÊ≠£');
                character.style.left = '40px';  // ‰∏≠ÂøÉ‰ΩçÁΩÆ„ÇíËÄÉÊÖÆ„Åó„ÅüÂÆâÂÖ®„Å™‰ΩçÁΩÆ
                character.style.top = '40px';
                character.style.display = 'block';
                character.style.visibility = 'visible';
            }
            
            // Á∑®ÈõÜ„É¢„Éº„ÉâÂÆåÂÖ®ÁµÇ‰∫Ü
            endEditMode();
            
            // „Éö„Éº„Ç∏„É™„É≠„Éº„Éâ„Å´Â§âÊõ¥
            console.log('üîÑ „Ç≠„É£„É≥„Çª„É´ - „Éö„Éº„Ç∏„Çí„É™„É≠„Éº„Éâ„Åó„Å¶ÂâçÂõû‰øùÂ≠ò„Åó„ÅüÁä∂ÊÖã„Å´Êàª„Åó„Åæ„Åô');
            coordinateDisplay.textContent = 'üîÑ ÂâçÂõû‰øùÂ≠ò„Åó„ÅüÁä∂ÊÖã„Å´Êàª„Åó„Å¶„ÅÑ„Åæ„Åô...';
            
            // Â∞ë„ÅóÂæÖ„Å£„Å¶„Åã„Çâ„É™„É≠„Éº„ÉâÔºà„É°„ÉÉ„Çª„Éº„Ç∏„ÇíË¶ã„Åõ„Çã„Åü„ÇÅÔºâ
            setTimeout(() => {
                location.reload();
            }, 500);
        }

        // Á∑®ÈõÜ„É¢„Éº„ÉâÂÆåÂÖ®ÁµÇ‰∫ÜÔºàÂÖ±ÈÄöÂá¶ÁêÜÔºâ
        function endEditMode() {
            // Á¢∫ÂÆö„Éë„Éç„É´ÈùûË°®Á§∫
            editConfirmPanel.style.display = 'none';
            
            // „Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜÁµÇ‰∫Ü
            if (isCharacterEditMode) {
                isCharacterEditMode = false;
                const characterButton = document.querySelector('button[onclick="toggleEditMode()"]');
                if (characterButton) {
                    characterButton.textContent = '„Ç≠„É£„É©„ÇØ„Çø„ÉºÁ∑®ÈõÜ';
                    characterButton.classList.remove('active');
                }
                character.classList.remove('edit-mode');
                character.style.cursor = 'default';
                removeCharacterDragEvents();
            }
            
            // CanvasÁ∑®ÈõÜÁµÇ‰∫Ü
            if (isCanvasEditMode) {
                isCanvasEditMode = false;
                const canvasButton = document.querySelector('button[onclick="toggleCanvasEditMode()"]');
                if (canvasButton) {
                    canvasButton.textContent = 'Ë°®Á§∫ÁØÑÂõ≤Á∑®ÈõÜ';
                    canvasButton.classList.remove('active');
                }
                characterCanvas.classList.remove('canvas-edit-mode');
                removeCanvasDragEvents();
            }
        }

        // Canvas„É™„Çµ„Ç§„Ç∫Âæå„ÅÆ„Ç≠„É£„É©„ÇØ„Çø„Éº‰ΩçÁΩÆË™øÊï¥
        function adjustCharacterPositionAfterCanvasResize() {
            if (!startElementPos.charAbsoluteX || !startElementPos.charAbsoluteY) return;
            
            // ÁèæÂú®„ÅÆCanvas‰ΩçÁΩÆ„ÇíÂèñÂæó
            const canvasRect = characterCanvas.getBoundingClientRect();
            const demoRect = demoScreen.getBoundingClientRect();
            
            // CanvasÂ∑¶‰∏ä„ÅÆËÉåÊôØÁîªÂÉèÂü∫Ê∫ñ‰ΩçÁΩÆ
            const canvasLeft = canvasRect.left - demoRect.left;
            const canvasTop = canvasRect.top - demoRect.top;
            
            // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆËÉåÊôØÁîªÂÉèÂü∫Ê∫ñÁµ∂ÂØæ‰ΩçÁΩÆ„Åã„ÇâCanvasÂÜÖ„ÅÆ‰∏≠ÂøÉÁÇπ‰ΩçÁΩÆ„ÇíË®àÁÆó
            const targetCharCenterX = startElementPos.charAbsoluteX - canvasLeft;
            const targetCharCenterY = startElementPos.charAbsoluteY - canvasTop;
            
            // CanvasÂ¢ÉÁïåÂÜÖ„Å´Âà∂ÈôêÔºà‰∏≠ÂøÉÁÇπÂü∫Ê∫ñÔºâ
            const charWidth = character.offsetWidth;
            const charHeight = character.offsetHeight;
            const minX = charWidth / 2;
            const maxX = canvasRect.width - charWidth / 2;
            const minY = charHeight / 2;
            const maxY = canvasRect.height - charHeight / 2;
            
            const newCharCenterX = Math.max(minX, Math.min(maxX, targetCharCenterX));
            const newCharCenterY = Math.max(minY, Math.min(maxY, targetCharCenterY));
            
            // „Ç≠„É£„É©„ÇØ„Çø„Éº‰ΩçÁΩÆ„ÇíÊõ¥Êñ∞Ôºà‰∏≠ÂøÉÁÇπÂü∫Ê∫ñÔºâ
            character.style.left = newCharCenterX + 'px';
            character.style.top = newCharCenterY + 'px';
        }

        // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅåCanvasÁØÑÂõ≤ÂÜÖ„Å´Âèé„Åæ„Çã„Çà„ÅÜ„Å´Ë™øÊï¥
        function ensureCharacterWithinCanvas() {
            // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆÁèæÂú®‰∏≠ÂøÉÁÇπ‰ΩçÁΩÆ„ÇíÂèñÂæó
            const charCenterX = parseFloat(character.style.left) || 60;
            const charCenterY = parseFloat(character.style.top) || 60;
            const charWidth = character.offsetWidth;
            const charHeight = character.offsetHeight;
            
            // Canvas„Çµ„Ç§„Ç∫„ÇíÂèñÂæó
            const canvasWidth = characterCanvas.offsetWidth;
            const canvasHeight = characterCanvas.offsetHeight;
            
            // CanvasÁØÑÂõ≤ÂÜÖ„Å´Âà∂ÈôêÔºà‰∏≠ÂøÉÁÇπÂü∫Ê∫ñÔºâ
            const minX = charWidth / 2;
            const maxX = canvasWidth - charWidth / 2;
            const minY = charHeight / 2;
            const maxY = canvasHeight - charHeight / 2;
            
            let newCenterX = Math.max(minX, Math.min(maxX, charCenterX));
            let newCenterY = Math.max(minY, Math.min(maxY, charCenterY));
            
            // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅåCanvasÁØÑÂõ≤Â§ñ„Å´„ÅÇ„ÇãÂ†¥Âêà„ÅØÁØÑÂõ≤ÂÜÖ„Å´ÁßªÂãï
            if (charCenterX < minX || charCenterX > maxX || 
                charCenterY < minY || charCenterY > maxY) {
                
                character.style.left = newCenterX + 'px';
                character.style.top = newCenterY + 'px';
                
                console.log(`„Ç≠„É£„É©„ÇØ„Çø„Éº‰ΩçÁΩÆ„ÇíCanvasÁØÑÂõ≤ÂÜÖ„Å´Ë™øÊï¥: ${newCenterX}px, ${newCenterY}px (‰∏≠ÂøÉÁÇπÂü∫Ê∫ñ)`);
            }
        }

        // „É™„Çµ„Ç§„Ç∫„Éè„É≥„Éâ„É©„Éº„ÅÆË®≠ÂÆö
        function setupResizeHandlers() {
            // „Ç≠„É£„É©„ÇØ„Çø„Éº„É™„Çµ„Ç§„Ç∫„Éè„É≥„Éâ„É´
            const characterHandles = character.querySelectorAll('.resize-handle');
            characterHandles.forEach(handle => {
                handle.addEventListener('mousedown', (e) => {
                    if (!isCharacterEditMode) return;
                    startResize(e, 'character', handle.dataset.direction);
                });
            });

            // Ë°®Á§∫ÁØÑÂõ≤„É™„Çµ„Ç§„Ç∫„Éè„É≥„Éâ„É´
            const canvasHandles = characterCanvas.querySelectorAll('.canvas-resize-handle');
            canvasHandles.forEach(handle => {
                handle.addEventListener('mousedown', (e) => {
                    if (!isCanvasEditMode) return;
                    startResize(e, 'canvas', handle.dataset.direction);
                });
            });

            // „Ç∞„É≠„Éº„Éê„É´„Ç§„Éô„É≥„Éà
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);
        }

        // „É™„Çµ„Ç§„Ç∫ÈñãÂßã
        function startResize(e, type, direction) {
            isResizing = true;
            resizeType = type;
            resizeDirection = direction;
            
            startMousePos = { x: e.clientX, y: e.clientY };
            
            if (type === 'character') {
                const rect = character.getBoundingClientRect();
                startElementPos = {
                    // ‰∏≠ÂøÉÁÇπÂü∫Ê∫ñ„ÅÆ‰ΩçÁΩÆ„ÇíË®òÈå≤ÔºàtransformÂØæÂøúÔºâ
                    centerX: parseFloat(character.style.left) || 60,
                    centerY: parseFloat(character.style.top) || 60,
                    width: rect.width,
                    height: rect.height
                };
            } else if (type === 'canvas') {
                const rect = characterCanvas.getBoundingClientRect();
                const demoRect = demoScreen.getBoundingClientRect();
                
                // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆËÉåÊôØÁîªÂÉè„Å´ÂØæ„Åô„ÇãÁµ∂ÂØæ‰ΩçÁΩÆ„ÇíË®òÈå≤
                const charRect = character.getBoundingClientRect();
                const charAbsoluteX = charRect.left + charRect.width/2 - demoRect.left;
                const charAbsoluteY = charRect.top + charRect.height/2 - demoRect.top;
                
                startElementPos = {
                    width: rect.width,
                    height: rect.height,
                    // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆËÉåÊôØÂü∫Ê∫ñÁµ∂ÂØæ‰ΩçÁΩÆ„Çí‰øùÂ≠ò
                    charAbsoluteX: charAbsoluteX,
                    charAbsoluteY: charAbsoluteY,
                    // CanvasÂÜÖ„Åß„ÅÆ„Ç≠„É£„É©„ÇØ„Çø„ÉºÁõ∏ÂØæ‰ΩçÁΩÆ„ÇÇ‰øùÂ≠ò
                    charRelativeX: parseFloat(character.style.left) || 60,
                    charRelativeY: parseFloat(character.style.top) || 60
                };
            }
            
            e.preventDefault();
            e.stopPropagation();
        }

        // „Ç≠„É£„É©„ÇØ„Çø„Éº„Éâ„É©„ÉÉ„Ç∞„Ç§„Éô„É≥„ÉàË®≠ÂÆö
        function setupCharacterDragEvents() {
            character.addEventListener('mousedown', startCharacterDrag);
        }

        function removeCharacterDragEvents() {
            character.removeEventListener('mousedown', startCharacterDrag);
        }

        // Ë°®Á§∫ÁØÑÂõ≤„Éâ„É©„ÉÉ„Ç∞„Ç§„Éô„É≥„ÉàË®≠ÂÆö
        function setupCanvasDragEvents() {
            characterCanvas.addEventListener('mousedown', startCanvasDrag);
        }

        function removeCanvasDragEvents() {
            characterCanvas.removeEventListener('mousedown', startCanvasDrag);
        }

        function startCharacterDrag(e) {
            if (!isCharacterEditMode || e.target.classList.contains('resize-handle')) return;
            isDragging = true;
            character.style.cursor = 'grabbing';
            character.classList.add('dragging');
            
            startMousePos = { x: e.clientX, y: e.clientY };
            
            // ÁèæÂú®„ÅÆÂÆüÈöõ„ÅÆ‰ΩçÁΩÆ„ÇíÂèñÂæóÔºàtransform„ÇíËÄÉÊÖÆÔºâ
            const rect = character.getBoundingClientRect();
            const canvasRect = characterCanvas.getBoundingClientRect();
            
            // CanvasÂÜÖ„Åß„ÅÆÁõ∏ÂØæ‰ΩçÁΩÆ„ÇíË®àÁÆó
            const currentX = rect.left + rect.width/2 - canvasRect.left;
            const currentY = rect.top + rect.height/2 - canvasRect.top;
            
            startElementPos = {
                x: currentX,
                y: currentY
            };
            
            // „Éë„Éº„Çª„É≥„ÉàÊåáÂÆö„Çí„Éî„ÇØ„Çª„É´„Å´Â§âÊèõ„Åó„Å¶‰øùÂ≠ò
            character.style.left = currentX + 'px';
            character.style.top = currentY + 'px';
            
            e.preventDefault();
        }

        function startCanvasDrag(e) {
            if (!isCanvasEditMode || e.target.classList.contains('canvas-resize-handle')) return;
            
            isDragging = true;
            characterCanvas.classList.add('dragging');
            
            startMousePos = { x: e.clientX, y: e.clientY };
            const rect = demoScreen.getBoundingClientRect();
            const canvasRect = characterCanvas.getBoundingClientRect();
            
            // Canvas„ÅÆ‰∏≠ÂøÉ‰ΩçÁΩÆ„ÇíË®òÈå≤
            startElementPos = {
                centerX: ((canvasRect.left + canvasRect.width/2 - rect.left) / rect.width) * 100,
                centerY: ((canvasRect.top + canvasRect.height/2 - rect.top) / rect.height) * 100
            };
            
            e.preventDefault();
        }

        // „Éû„Ç¶„ÇπÁßªÂãïÂá¶ÁêÜ
        function handleMouseMove(e) {
            if (isResizing) {
                handleResize(e);
            } else if (isDragging && isCharacterEditMode) {
                handleCharacterDrag(e);
            } else if (isDragging && isCanvasEditMode) {
                handleCanvasDrag(e);
            }
        }

        // „É™„Çµ„Ç§„Ç∫Âá¶ÁêÜ
        function handleResize(e) {
            const deltaX = e.clientX - startMousePos.x;
            const deltaY = e.clientY - startMousePos.y;

            if (resizeType === 'character') {
                let newWidth = startElementPos.width;
                let newHeight = startElementPos.height;

                // ÂØæËßí„Éè„É≥„Éâ„É´„ÇíÂü∫Ê∫ñ„Å´„Åó„ÅüÂõ∫ÂÆöÁÇπ„É™„Çµ„Ç§„Ç∫
                switch (resizeDirection) {
                    case 'se': // Âè≥‰∏ã„Éè„É≥„Éâ„É´: Â∑¶‰∏ä(NW)„ÅåÂõ∫ÂÆöÁÇπ
                        newWidth = Math.max(40, startElementPos.width + deltaX);
                        newHeight = Math.max(40, startElementPos.height + deltaY);
                        break;
                        
                    case 'sw': // Â∑¶‰∏ã„Éè„É≥„Éâ„É´: Âè≥‰∏ä(NE)„ÅåÂõ∫ÂÆöÁÇπ
                        newWidth = Math.max(40, startElementPos.width - deltaX);
                        newHeight = Math.max(40, startElementPos.height + deltaY);
                        break;
                        
                    case 'ne': // Âè≥‰∏ä„Éè„É≥„Éâ„É´: Â∑¶‰∏ã(SW)„ÅåÂõ∫ÂÆöÁÇπ
                        newWidth = Math.max(40, startElementPos.width + deltaX);
                        newHeight = Math.max(40, startElementPos.height - deltaY);
                        break;
                        
                    case 'nw': // Â∑¶‰∏ä„Éè„É≥„Éâ„É´: Âè≥‰∏ã(SE)„ÅåÂõ∫ÂÆöÁÇπÔºàÂú∞Èù¢Âõ∫ÂÆö„Åß‰æøÂà©Ôºâ
                        newWidth = Math.max(40, startElementPos.width - deltaX);
                        newHeight = Math.max(40, startElementPos.height - deltaY);
                        break;
                }

                // „Çµ„Ç§„Ç∫ÈÅ©Áî®
                character.style.width = newWidth + 'px';
                character.style.height = newHeight + 'px';
                
                // ÂØæËßíÂõ∫ÂÆöÁÇπ„ÇíÁ∂≠ÊåÅ„Åô„Çã„Åü„ÇÅ„ÅÆ‰∏≠ÂøÉÁÇπ‰ΩçÁΩÆË™øÊï¥
                const widthDiff = newWidth - startElementPos.width;
                const heightDiff = newHeight - startElementPos.height;
                
                let newCenterX = startElementPos.centerX;
                let newCenterY = startElementPos.centerY;
                
                // ÂêÑÊñπÂêë„Å´„Åä„Åë„Çã‰∏≠ÂøÉÁÇπ„ÅÆË™øÊï¥ÔºàÂØæËßíÂõ∫ÂÆöÁÇπÁ∂≠ÊåÅÔºâ
                switch (resizeDirection) {
                    case 'se': // Âè≥‰∏ã„Éè„É≥„Éâ„É´: Â∑¶‰∏äÂõ∫ÂÆö ‚Üí ‰∏≠ÂøÉÁÇπ„ÅØÂè≥‰∏ã„Å´ÁßªÂãï
                        newCenterX = startElementPos.centerX + widthDiff / 2;
                        newCenterY = startElementPos.centerY + heightDiff / 2;
                        break;
                        
                    case 'sw': // Â∑¶‰∏ã„Éè„É≥„Éâ„É´: Âè≥‰∏äÂõ∫ÂÆö ‚Üí ‰∏≠ÂøÉÁÇπ„ÅØÂ∑¶‰∏ã„Å´ÁßªÂãï
                        newCenterX = startElementPos.centerX - widthDiff / 2;
                        newCenterY = startElementPos.centerY + heightDiff / 2;
                        break;
                        
                    case 'ne': // Âè≥‰∏ä„Éè„É≥„Éâ„É´: Â∑¶‰∏ãÂõ∫ÂÆö ‚Üí ‰∏≠ÂøÉÁÇπ„ÅØÂè≥‰∏ä„Å´ÁßªÂãï
                        newCenterX = startElementPos.centerX + widthDiff / 2;
                        newCenterY = startElementPos.centerY - heightDiff / 2;
                        break;
                        
                    case 'nw': // Â∑¶‰∏ä„Éè„É≥„Éâ„É´: Âè≥‰∏ãÂõ∫ÂÆö ‚Üí ‰∏≠ÂøÉÁÇπ„ÅØÂ∑¶‰∏ä„Å´ÁßªÂãï
                        newCenterX = startElementPos.centerX - widthDiff / 2;
                        newCenterY = startElementPos.centerY - heightDiff / 2;
                        break;
                }
                
                // CanvasÂÜÖ„Åß„ÅÆÂ¢ÉÁïåÂà∂ÈôêÔºà‰∏≠ÂøÉÁÇπÂü∫Ê∫ñÔºâ
                const canvasRect = characterCanvas.getBoundingClientRect();
                const minCenterX = newWidth / 2;
                const maxCenterX = canvasRect.width - newWidth / 2;
                const minCenterY = newHeight / 2;
                const maxCenterY = canvasRect.height - newHeight / 2;
                
                newCenterX = Math.max(minCenterX, Math.min(maxCenterX, newCenterX));
                newCenterY = Math.max(minCenterY, Math.min(maxCenterY, newCenterY));
                
                character.style.left = newCenterX + 'px';
                character.style.top = newCenterY + 'px';
                
                const scale = (newWidth / 80).toFixed(2);
                const fixedPoint = getFixedPointName(resizeDirection);
                coordinateDisplay.textContent = `üìè „Ç≠„É£„É©„ÇØ„Çø„Éº„Çµ„Ç§„Ç∫: ${newWidth.toFixed(0)}√ó${newHeight.toFixed(0)}px („Çπ„Ç±„Éº„É´: ${scale}) [${fixedPoint}Âõ∫ÂÆö]`;

            } else if (resizeType === 'canvas') {
                let newWidth = startElementPos.width;
                let newHeight = startElementPos.height;

                switch (resizeDirection) {
                    case 'se':
                        newWidth = Math.max(60, startElementPos.width + deltaX);
                        newHeight = Math.max(60, startElementPos.height + deltaY);
                        break;
                    case 'sw':
                        newWidth = Math.max(60, startElementPos.width - deltaX);
                        newHeight = Math.max(60, startElementPos.height + deltaY);
                        break;
                    case 'ne':
                        newWidth = Math.max(60, startElementPos.width + deltaX);
                        newHeight = Math.max(60, startElementPos.height - deltaY);
                        break;
                    case 'nw':
                        newWidth = Math.max(60, startElementPos.width - deltaX);
                        newHeight = Math.max(60, startElementPos.height - deltaY);
                        break;
                }

                characterCanvas.style.width = newWidth + 'px';
                characterCanvas.style.height = newHeight + 'px';
                
                // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆËÉåÊôØÁîªÂÉèÂü∫Ê∫ñ„ÅÆÁµ∂ÂØæ‰ΩçÁΩÆ„Çí‰øùÊåÅ
                adjustCharacterPositionAfterCanvasResize();
                
                coordinateDisplay.textContent = `üé® Ë°®Á§∫ÁØÑÂõ≤„Çµ„Ç§„Ç∫: ${newWidth.toFixed(0)}√ó${newHeight.toFixed(0)}px („Ç≠„É£„É©„ÇØ„Çø„ÉºË°®Á§∫È†òÂüü)`;
            }
        }

        // „Ç≠„É£„É©„ÇØ„Çø„Éº„Éâ„É©„ÉÉ„Ç∞Âá¶ÁêÜ
        function handleCharacterDrag(e) {
            const deltaX = e.clientX - startMousePos.x;
            const deltaY = e.clientY - startMousePos.y;
            
            let newX = startElementPos.x + deltaX;
            let newY = startElementPos.y + deltaY;
            
            // CanvasÂÜÖ„Åß„ÅÆÂ¢ÉÁïåÂà∂ÈôêÔºà‰∏≠ÂøÉÁÇπÂü∫Ê∫ñÔºâ
            const canvasRect = characterCanvas.getBoundingClientRect();
            const charWidth = character.offsetWidth;
            const charHeight = character.offsetHeight;
            
            // transform„ÇíËÄÉÊÖÆ„Åó„ÅüÂ¢ÉÁïåË®àÁÆó
            const minX = charWidth / 2;
            const maxX = canvasRect.width - charWidth / 2;
            const minY = charHeight / 2;
            const maxY = canvasRect.height - charHeight / 2;
            
            newX = Math.max(minX, Math.min(maxX, newX));
            newY = Math.max(minY, Math.min(maxY, newY));
            
            character.style.left = newX + 'px';
            character.style.top = newY + 'px';
            
            coordinateDisplay.textContent = `üìç „Ç≠„É£„É©„ÇØ„Çø„Éº‰ΩçÁΩÆ: ${newX.toFixed(0)}px, ${newY.toFixed(0)}px (CanvasÂÜÖ„Éª‰∏≠ÂøÉÁÇπ)`;
        }

        // CanvasÁßªÂãïÂá¶ÁêÜ
        function handleCanvasDrag(e) {
            const deltaX = e.clientX - startMousePos.x;
            const deltaY = e.clientY - startMousePos.y;
            
            const rect = demoScreen.getBoundingClientRect();
            const deltaPercentX = (deltaX / rect.width) * 100;
            const deltaPercentY = (deltaY / rect.height) * 100;
            
            let newX = startElementPos.centerX + deltaPercentX;
            let newY = startElementPos.centerY + deltaPercentY;
            
            // Â¢ÉÁïåÂà∂ÈôêÔºàCanvas„ÅåËÉåÊôØ„Åã„ÇâÂá∫„Å™„ÅÑ„Çà„ÅÜ„Å´Ôºâ
            newX = Math.max(10, Math.min(90, newX));
            newY = Math.max(10, Math.min(90, newY));
            
            characterCanvas.style.left = newX + '%';
            characterCanvas.style.top = newY + '%';
            
            coordinateDisplay.textContent = `üì± Canvas‰ΩçÁΩÆ: ${newX.toFixed(1)}%, ${newY.toFixed(1)}%`;
        }

        // „Éû„Ç¶„Çπ„Ç¢„ÉÉ„ÉóÂá¶ÁêÜ
        function handleMouseUp() {
            if (isDragging) {
                isDragging = false;
                character.style.cursor = 'grab';
                character.classList.remove('dragging');
                characterCanvas.classList.remove('dragging');
                
                if (isCharacterEditMode) {
                    setTimeout(() => {
                        const rect = demoScreen.getBoundingClientRect();
                        const charRect = character.getBoundingClientRect();
                        const centerX = ((charRect.left + charRect.width/2 - rect.left) / rect.width * 100).toFixed(1);
                        const centerY = ((charRect.top + charRect.height/2 - rect.top) / rect.height * 100).toFixed(1);
                        const scale = (charRect.width / 80).toFixed(2);
                        
                        coordinateDisplay.innerHTML = `
                            üìã ÁîüÊàê„Ç≥„Éº„Éâ: 
                            &lt;div data-character="purattokun" data-x="${centerX}" data-y="${centerY}" data-scale="${scale}"&gt;&lt;/div&gt;
                        `;
                    }, 100);
                }
            }
            
            if (isResizing) {
                isResizing = false;
                resizeType = '';
                resizeDirection = '';
                
                setTimeout(() => {
                    if (isCharacterEditMode) {
                        const rect = demoScreen.getBoundingClientRect();
                        const charRect = character.getBoundingClientRect();
                        const centerX = ((charRect.left + charRect.width/2 - rect.left) / rect.width * 100).toFixed(1);
                        const centerY = ((charRect.top + charRect.height/2 - rect.top) / rect.height * 100).toFixed(1);
                        const scale = (charRect.width / 80).toFixed(2);
                        
                        coordinateDisplay.innerHTML = `
                            üìã ÁîüÊàê„Ç≥„Éº„Éâ: 
                            &lt;div data-character="purattokun" data-x="${centerX}" data-y="${centerY}" data-scale="${scale}" data-canvas-width="${demoScreen.offsetWidth}" data-canvas-height="${demoScreen.offsetHeight}"&gt;&lt;/div&gt;
                        `;
                    } else if (isCanvasEditMode) {
                        coordinateDisplay.innerHTML = `
                            üìã CanvasË®≠ÂÆö: 
                            width="${demoScreen.offsetWidth}px" height="${demoScreen.offsetHeight}px"
                        `;
                    }
                }, 100);
            }
        }
    </script>
</body>
</html>
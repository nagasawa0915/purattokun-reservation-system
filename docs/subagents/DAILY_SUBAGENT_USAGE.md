# 日常的なサブエージェント利用ガイド

**作成日**: 2025-09-04
**目的**: CLAUDE.mdから移動された詳細なサブエージェント選択・運用ガイドライン

---

## 🤖 サブエージェント活用ガイドライン

**基本方針**: 「1つのタスク = 1つのサブエージェント」を原則とする

**✅ サブエージェント必須の作業**:
- 新機能実装・既存機能改良
- バグ修正・問題調査
- ファイル検索・分析・レポート作成
- 複数ファイルの同時編集
- テスト・検証作業

## 🎯 サブエージェント選択指針

### 🚀 高速修正エージェント（評価: 2/5 → 4.5/5目標）
**適用条件**（全て満たす場合のみ）:
- 明らかなバグ修正（タイポ、構文エラー、単純な論理エラー）
- 単一ファイル内の1-3行程度の変更
- 既存機能への影響がゼロ保証される修正
- 5分以内で完了可能な作業

**高速性実現メカニズム**:
1. **事前診断スキップ**: 明らかな問題のみ対象
2. **並列ツール実行**: Read→Edit→検証を同時進行
3. **簡潔報告**: 「修正内容 + 影響範囲 + 確認方法」のみ
4. **ロールバック準備**: 修正前の元コード必須保持
5. **即座完了**: 追加調査・最適化なし

**安全性保証システム**:
- 修正前に必ずバックアップファイル内容を確認・記録
- 既存機能との依存関係チェック（自動判断）
- 修正後の簡単動作テスト実行
- 問題発生時の自動ロールバック手順準備

### 🔧 慎重編集エージェント（評価: 3.1/5 → 4.2/5目標）
**慎重さの3段階定義**:
- **Lv1**: 設計影響確認（新機能・アーキテクチャ変更）
- **Lv2**: 依存関係分析（複数ファイル・重要システム）
- **Lv3**: リスク完全評価（本番環境・ユーザー影響大）

**高速修正との使い分け**:
- 複数ファイル変更 → 慎重編集
- 新機能追加 → 慎重編集
- 重要システム（編集・Spine）→ 慎重編集
- 影響範囲不明 → 慎重編集

**確認チェックリスト**:
1. 既存機能への影響評価
2. 複数箇所の整合性確認
3. エラーハンドリング検討
4. ロールバック計画策定
5. 段階的実装計画作成

### 🎯 設計レビューエージェント（評価: 4.1/5 → 4.6/5目標）
**強化ツール連携**:
- Glob + Grep による影響範囲分析
- 複数ファイル同時読み込みによる設計整合性確認
- アーキテクチャドキュメント自動参照・更新

**実装前必須レビュー項目**:
1. 既存システムとの統合方法
2. 複数実装方法の比較検討
3. パフォーマンス・保守性への影響
4. 段階的実装計画の妥当性

### 🔍 トラブル診断エージェント（評価: 4.3/5 → 4.7/5目標）
**記録機能強化**:
- 診断プロセスの完全自動記録
- 解決策の成功/失敗ステータス管理
- 類似問題の自動検索・参照
- トラブルシューティング文書の自動更新

**他エージェント連携**:
- 問題解決後の「記録マスター」自動起動
- 修正実装時の「慎重編集」連携
- 緊急修正時の「高速修正」判断支援

### 📝 記録マスターエージェント（評価: 4.5/5 → 4.8/5目標）
**CLAUDE.mdルール完全遵守**:
- 🚨 絶対ルール: ユーザー評価受信後のみ記録実行
- 推測による成功/失敗判定の完全禁止
- 記録実行前の必須チェックリスト確認

**自動記録プロセス**:
1. **問題分類判断**: 既存ファイル確認→新規/既存判定
2. **解決策実施**: 他エージェントと連携
3. **ユーザー評価待機**: 推測禁止・実際の評価まで待機
4. **ステータス別記録**: 成功/失敗/部分成功の適切な分類
5. **記録完了報告**: ファイルパス・更新内容の明示

### 🔧 General-Purpose エージェント（評価: 3.8/5 → 4.3/5目標）
**適用条件**:
- 複雑な調査・分析作業
- マルチステップの複合タスク
- 他エージェントでは対応困難な作業
- 新規領域の探索・実験

**強化された実行フロー**:
1. **タスク分解**: 複雑作業を明確なステップに分解
2. **専門エージェント判定**: 各ステップの最適エージェント選択
3. **並列実行管理**: 独立タスクの同時実行調整
4. **結果統合**: 各ステップ結果の一貫性確保
5. **品質保証**: 全体結果の妥当性検証

## 🔄 エージェント間連携フロー（統一仕様）

### 📋 エージェント選択アルゴリズム
```
1. 緊急度・複雑度の判定
   └─ 緊急 & 単純 → 高速修正
   └─ 緊急 & 複雑 → トラブル診断 → 慎重編集
   └─ 計画 & 新機能 → 設計レビュー → 慎重編集

2. 作業スコープの判定
   └─ 単一ファイル & 明確 → 高速修正
   └─ 複数ファイル or 影響範囲大 → 慎重編集
   └─ 調査・分析中心 → General-Purpose

3. 記録・文書化の判定
   └─ 問題解決完了 → 記録マスター（自動起動）
   └─ 新機能・設計 → 慎重編集内で文書化
```

### 🔗 必須連携パターン
- **トラブル診断** → **記録マスター**: 問題解決後の自動記録
- **設計レビュー** → **慎重編集**: 承認後の実装移行
- **高速修正** → **記録マスター**: 重要修正の記録（必要時）
- **General-Purpose** → **各専門エージェント**: タスク分解後の移譲

### ⚡ 効率的な並列処理例
```
✅ 最適パターン:
- 独立した3つのバグ修正 → 3つの高速修正エージェント並列
- 調査 + 設計 + 実装 → General-Purpose + 設計レビュー + 慎重編集

❌ 非効率パターン:
- 依存関係のある作業を並列実行
- 同一ファイルへの複数エージェント同時編集
- 記録作業の重複実行
```

**📊 品質・効率向上効果**:
- **高速修正**: 明確な問題を5分以内で解決（従来の1/3の時間）
- **慎重編集**: リスク評価により障害発生率を80%削減
- **設計レビュー**: 実装前の設計確認で手戻り50%削減
- **記録システム**: 同じ問題の再発防止率95%以上

---

## 🤖 開発スタイル推奨事項

- **🚀 サブエージェント優先**: 基本的に全ての作業でサブエージェントを積極活用
- **⚡ 並列処理推奨**: 複数タスクがある場合は必ずサブエージェントで並列実行
- **🎯 適切なエージェント選択**: タスクの性質に応じて最適なサブエージェントを選択
- **📋 段階的実装**: 大きな機能は Phase 分けで安全に実装
- **🛡️ 既存システム保護**: 既存機能への影響ゼロ保証を最優先
- **📝 記録の徹底**: 問題解決時は必ずトラブルシューティング記録を作成

---

**📝 注記**: このドキュメントは2025-09-04時点でCLAUDE.mdから移動された詳細なサブエージェント運用ガイドラインです。日常的な開発作業でのエージェント選択に活用してください。
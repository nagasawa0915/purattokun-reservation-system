# 開発チェックリスト - 機能追加・変更時の必須確認項目

**作成日**: 2024年7月25日  
**目的**: Canvas サイズ変更問題を踏まえた再発防止

---

## 🔍 機能追加・変更前のチェック

### 1. **既存コード理解**
- [ ] 変更対象の既存実装を完全に理解
- [ ] なぜその実装になっているかの背景調査
- [ ] 関連するCSS、JavaScript、HTMLの依存関係確認
- [ ] Git履歴で過去の変更理由を調査

### 2. **影響範囲分析**
- [ ] 変更により影響を受ける可能性のある機能をリストアップ
- [ ] CSS設定の上書き・競合可能性をチェック
- [ ] JavaScriptイベントリスナーの重複をチェック
- [ ] グローバル変数・関数への影響確認

---

## 🧪 テスト項目（必須）

### 基本動作テスト
- [ ] 機能追加・変更箇所の動作確認
- [ ] 既存機能の動作確認（回帰テスト）
- [ ] エラーコンソールのチェック

### レスポンシブテスト
- [ ] **ウィンドウリサイズ時の動作確認**（重要）
- [ ] デスクトップサイズでの表示確認
- [ ] タブレットサイズでの表示確認  
- [ ] モバイルサイズでの表示確認

### 画面サイズ別テスト
- [ ] 1920×1080（フルHD）
- [ ] 1366×768（一般的ノートPC）
- [ ] 768×1024（タブレット縦）
- [ ] 375×667（モバイル）

### ブラウザテスト
- [ ] Chrome
- [ ] Firefox
- [ ] Safari（可能であれば）
- [ ] Edge（可能であれば）

---

## 🎯 Canvas・表示要素に関する特別チェック

### Canvas 要素の変更時
- [ ] CSSサイズ設定の確認（相対 vs 固定）
- [ ] JavaScript内部解像度設定の確認
- [ ] 背景画像との位置関係確認
- [ ] クリック領域の動作確認
- [ ] リサイズ時の挙動確認

### CSS 変更時
- [ ] 既存CSSとの競合チェック
- [ ] !important の使用理由明確化
- [ ] レスポンシブ breakpoint での動作確認
- [ ] Z-index 競合のチェック

### JavaScript 変更時
- [ ] イベントリスナーの重複登録チェック
- [ ] メモリリーク可能性の確認
- [ ] エラーハンドリングの確認
- [ ] コンソールログの動作確認

---

## 📝 データ整理・ファイル移動時のチェック

### ファイル移動前
- [ ] 移動対象ファイルの依存関係確認
- [ ] 既存の設定・動作の完全バックアップ
- [ ] 移動理由と期待効果の明確化

### ファイル移動後
- [ ] 全ての既存機能の動作確認
- [ ] 設定値の変更がないことを確認
- [ ] パフォーマンスに影響がないことを確認

---

## 🚀 新システム・ライブラリ追加時のチェック

### 追加前の検討
- [ ] 既存システムとの互換性確認
- [ ] 必要性の再検討（既存方法で解決できないか）
- [ ] 段階的導入計画の策定

### 追加後の検証
- [ ] 既存機能への影響ゼロを確認
- [ ] 新機能のオン/オフ切り替え可能性確認
- [ ] 設定ファイル・環境への影響確認
- [ ] デバッグ機能の動作確認

---

## 🔧 具体的なテスト手順

### 1. ウィンドウリサイズテスト（最重要）
```
1. ブラウザを開く
2. F12で開発者ツールを開く
3. ウィンドウサイズを以下のパターンで変更:
   - 最大化 → 小さく → 最大化
   - 横幅のみ変更
   - 縦幅のみ変更
   - デベロッパーツールのサイズ変更
4. 各段階でキャラクター表示を確認:
   - サイズが意図せず変わっていないか
   - 位置が正しく維持されているか
   - アニメーションが正常に動作するか
```

### 2. 比較テスト
```
1. 変更前の状態をスクリーンショット保存
2. 変更を適用
3. 同じ条件で変更後の状態をスクリーンショット保存
4. 差分を比較（可能な限り数値で）
```

### 3. 設定値確認テスト
```javascript
// ブラウザコンソールで実行
function verifyCanvasSettings() {
    const canvas = document.querySelector('#purattokun-canvas');
    console.log('Canvas CSS:', {
        width: getComputedStyle(canvas).width,
        height: getComputedStyle(canvas).height,
        left: getComputedStyle(canvas).left,
        top: getComputedStyle(canvas).top
    });
    
    console.log('Canvas Internal:', {
        width: canvas.width,
        height: canvas.height
    });
}
```

---

## ⚠️ 要注意ポイント

### やってはいけないこと
- [ ] 動いているコードを理由なく変更
- [ ] 複数の変更を同時に行う
- [ ] テスト不十分での本番適用
- [ ] 自動化機能の無計画な追加

### 必ず実施すること
- [ ] 変更理由の明確化と記録
- [ ] バックアップの作成
- [ ] 段階的な変更とテスト
- [ ] ユーザー報告問題の完全検証

---

## 📋 チェックリスト使用方法

### 1. 変更開始前
このチェックリストを印刷またはコピーして、各項目をチェック

### 2. 変更完了後
全項目が✅になるまで本番適用を控える

### 3. 問題発生時
このチェックリストに追加すべき項目がないか検討

---

**重要**: このチェックリストは今回の失敗から学んだ最低限の項目です。プロジェクトの進化に合わせて継続的に更新してください。

**最終更新**: 2024年7月25日
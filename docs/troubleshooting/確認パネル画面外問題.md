---
title: ç¢ºèªãƒ‘ãƒãƒ«ãŒç”»é¢å¤–ã«å‡ºã‚‹å•é¡Œ
status: è§£æ±ºæ¸ˆã¿
tags: [ç¢ºèªãƒ‘ãƒãƒ«, ç”»é¢å¤–, ä½ç½®åˆ¶å¾¡, localStorage, UI]
aliases: 
  - ç¢ºèªãƒ‘ãƒãƒ«ãŒæ¶ˆãˆã‚‹
  - ç¢ºèªãƒ‘ãƒãƒ«ãŒè¦‹ãˆãªã„
  - ç¢ºèªãƒ‘ãƒãƒ«ãŒç”»é¢ä¸‹ã«è¡Œã
  - confirm panel out of screen
  - ç·¨é›†ç¢ºèªãƒ‘ãƒãƒ«ä½ç½®å•é¡Œ
created: 2025-01-29
updated: 2025-01-29
---

# ğŸ¯ ç¢ºèªãƒ‘ãƒãƒ«ãŒç”»é¢å¤–ã«å‡ºã‚‹å•é¡Œ

## ğŸ“Š ç¾åœ¨ã®çŠ¶æ³
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… **è§£æ±ºæ¸ˆã¿** - ç”»é¢å†…åˆ¶é™æ©Ÿèƒ½ã§å®Œå…¨è§£æ±º

**æœ€çµ‚è§£æ±ºå†…å®¹** (2025-01-29):
- ä½ç½®å¾©å…ƒæ™‚ã®ç”»é¢å†…åˆ¶é™æ©Ÿèƒ½ã‚’å®Ÿè£…
- è¡¨ç¤ºæ™‚ã®è‡ªå‹•ä½ç½®èª¿æ•´æ©Ÿèƒ½ã‚’è¿½åŠ 
- ãƒ‡ãƒãƒƒã‚°ç”¨ä½ç½®ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ã‚’æä¾›

## âš¡ æœ‰åŠ¹ãªè§£æ±ºç­–ãƒ»å›é¿ç­–

### ğŸ¯ è§£æ±ºç­–1: ä½ç½®å¾©å…ƒæ™‚ã®ç”»é¢å†…åˆ¶é™ <!-- ğŸ”’ ç¢ºå®šæ¸ˆã¿è§£æ±ºç­– - å¤‰æ›´ç¦æ­¢ -->

**ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«**: `spine-positioning-system-explanation.js`

```javascript
// setupConfirmPanelDraggingé–¢æ•°å†…ã®ä½ç½®å¾©å…ƒå‡¦ç†ã‚’ä¿®æ­£
const savedPosition = localStorage.getItem('confirmPanelPosition');
if (savedPosition) {
    const pos = JSON.parse(savedPosition);
    
    // ç”»é¢å†…ã«åã¾ã‚‹ã‚ˆã†èª¿æ•´
    const maxX = window.innerWidth - 140; // ãƒ‘ãƒãƒ«æœ€å°å¹…ã‚’è€ƒæ…®
    const maxY = window.innerHeight - 100; // ãƒ‘ãƒãƒ«é«˜ã•ã‚’è€ƒæ…®
    
    const boundedX = Math.max(0, Math.min(pos.x, maxX));
    const boundedY = Math.max(0, Math.min(pos.y, maxY));
    
    editConfirmPanel.style.left = boundedX + 'px';
    editConfirmPanel.style.top = boundedY + 'px';
    editConfirmPanel.style.transform = 'none';
}
```

### ğŸ¯ è§£æ±ºç­–2: è¡¨ç¤ºæ™‚ã®è‡ªå‹•ä½ç½®èª¿æ•´

**ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«**: `spine-positioning-system-explanation.js`

```javascript
// showConfirmPanelé–¢æ•°ã‚’ä¿®æ­£
function showConfirmPanel() {
    if (editConfirmPanel) {
        editConfirmPanel.style.display = 'block';
        
        // è¡¨ç¤ºæ™‚ã«ç”»é¢å†…ã«åã¾ã£ã¦ã„ã‚‹ã‹ç¢ºèª
        setTimeout(() => {
            const rect = editConfirmPanel.getBoundingClientRect();
            const maxX = window.innerWidth - rect.width;
            const maxY = window.innerHeight - rect.height;
            
            let needsAdjustment = false;
            let newX = rect.left;
            let newY = rect.top;
            
            // ç”»é¢å¤–ã«ã¯ã¿å‡ºã—ã¦ã„ã‚‹å ´åˆã¯ç”»é¢å†…ã«ç§»å‹•
            if (rect.left < 0) {
                newX = 10;
                needsAdjustment = true;
            } else if (rect.left > maxX) {
                newX = maxX - 10;
                needsAdjustment = true;
            }
            
            if (rect.top < 0) {
                newY = 10;
                needsAdjustment = true;
            } else if (rect.top > maxY) {
                newY = maxY - 10;
                needsAdjustment = true;
            }
            
            if (needsAdjustment) {
                editConfirmPanel.style.left = newX + 'px';
                editConfirmPanel.style.top = newY + 'px';
                editConfirmPanel.style.transform = 'none';
            }
        }, 10);
    }
}
```

### ğŸ¯ è§£æ±ºç­–3: ãƒ‡ãƒãƒƒã‚°ç”¨ä½ç½®ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½

**ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«**: `spine-positioning-system-explanation.js`

```javascript
// ç¢ºèªãƒ‘ãƒãƒ«ä½ç½®ãƒªã‚»ãƒƒãƒˆï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
function resetConfirmPanelPosition() {
    localStorage.removeItem('confirmPanelPosition');
    if (editConfirmPanel) {
        editConfirmPanel.style.left = '50%';
        editConfirmPanel.style.top = '';
        editConfirmPanel.style.bottom = '20px';
        editConfirmPanel.style.transform = 'translateX(-50%)';
        console.log('ğŸ”„ ç¢ºèªãƒ‘ãƒãƒ«ä½ç½®ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
    }
}
```

**ä½¿ç”¨æ–¹æ³•**: F12ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ `resetConfirmPanelPosition()` ã‚’å®Ÿè¡Œ

## ğŸ” å•é¡Œã®è©³ç´°

### ç™ºç”Ÿæ¡ä»¶
- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã§ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä½ç½®ã‚’å¤‰æ›´å¾Œã€ç¢ºèªãƒ‘ãƒãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹æ™‚
- å‰å›ã®ä½ç½®ãŒlocalStorageã«ä¿å­˜ã•ã‚Œã¦ãŠã‚Šã€ãã®ä½ç½®ãŒç”»é¢å¤–ã®å ´åˆ
- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºå¤‰æ›´å¾Œã«ç¢ºèªãƒ‘ãƒãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆ

### ç—‡çŠ¶
1. **ç¢ºèªãƒ‘ãƒãƒ«ãŒæ¶ˆãˆã‚‹**: ã€Œç·¨é›†ã‚’ç¢ºå®šã—ã¾ã™ã‹ï¼Ÿã€ãƒ‘ãƒãƒ«ãŒè¦‹å½“ãŸã‚‰ãªã„
2. **ç”»é¢å¤–ã«è¡¨ç¤º**: ãƒ‘ãƒãƒ«ãŒç”»é¢ã®ä¸‹ã‚„å³ç«¯ã®è¦‹ãˆãªã„ä½ç½®ã«è¡¨ç¤º
3. **æ“ä½œä¸èƒ½**: ä¿å­˜ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³ãŒæŠ¼ã›ãªã„çŠ¶æ…‹

### æ ¹æœ¬åŸå› 
**localStorageä½ç½®è¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ ã®ç”»é¢å¤–åˆ¶é™ãªã—**ï¼š
- ãƒ‰ãƒ©ãƒƒã‚°ç§»å‹•ã§ç”»é¢å¤–ã«å‡ºãŸä½ç½®ãŒlocalStorageã«ä¿å­˜ã•ã‚Œã‚‹
- æ¬¡å›è¡¨ç¤ºæ™‚ã«ãã®ä½ç½®ï¼ˆç”»é¢å¤–ï¼‰ã§å¾©å…ƒã•ã‚Œã‚‹
- ç”»é¢ã‚µã‚¤ã‚ºå¤‰æ›´ã«ã‚ˆã‚Šã€ä»¥å‰ã¯ç”»é¢å†…ã ã£ãŸä½ç½®ãŒç”»é¢å¤–ã«ãªã‚‹

### ç’°å¢ƒæƒ…å ±
- **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `spine-positioning-system-explanation.js`
- **å½±éŸ¿ç¯„å›²**: ç¢ºèªãƒ‘ãƒãƒ«è¡¨ç¤ºæ™‚ã®ã¿
- **ãƒ–ãƒ©ã‚¦ã‚¶**: å…¨ãƒ–ãƒ©ã‚¦ã‚¶ã§ç™ºç”Ÿ
- **ç™ºè¦‹æ–¹æ³•**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å ±å‘Šã€Œã™ã”ãä¸‹ã«è¡Œã£ã¦ã—ã¾ã£ã¦ã„ã¾ã™ã€

## ğŸ“ è©¦è¡ŒéŒ¯èª¤ã®å±¥æ­´

### âœ… Case #1: 2025-01-29 - ç”»é¢å†…åˆ¶é™æ©Ÿèƒ½ã«ã‚ˆã‚‹å®Œå…¨è§£æ±º

**å ±å‘Šå†…å®¹**: 
> ç”»é¢ã®ä¸­ã«å…¥ã‚Šã¾ã—ãŸã€‚è§£æ±ºã§ã™ã€‚

**å•é¡Œ**: ç¢ºèªãƒ‘ãƒãƒ«ã€Œç·¨é›†ã‚’ç¢ºå®šã—ã¾ã™ã‹ï¼Ÿã€ãŒç”»é¢ã®ä¸‹ã®æ–¹ã«æ¶ˆãˆã¦è¦‹ã¤ã‹ã‚‰ãªã„

**åŸå› åˆ†æ**: 
- localStorageä½ç½®è¨˜æ†¶æ©Ÿèƒ½ã§ç”»é¢å¤–ã®ä½ç½®ãŒä¿å­˜ã•ã‚Œã¦ã„ãŸ
- ä½ç½®å¾©å…ƒæ™‚ãƒ»è¡¨ç¤ºæ™‚ã«ç”»é¢å†…åˆ¶é™ãŒãªã‹ã£ãŸ
- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºå¤‰æ›´ã«ã‚ˆã‚Šæœ‰åŠ¹ãªä½ç½®ãŒç„¡åŠ¹ã«ãªã£ã¦ã„ãŸ

**è©¦ã—ãŸæ–¹æ³•**: 
1. **ä½ç½®å¾©å…ƒæ™‚ã®ç”»é¢å†…åˆ¶é™**:
   ```javascript
   const maxX = window.innerWidth - 140;
   const maxY = window.innerHeight - 100;
   const boundedX = Math.max(0, Math.min(pos.x, maxX));
   const boundedY = Math.max(0, Math.min(pos.y, maxY));
   ```

2. **è¡¨ç¤ºæ™‚ã®è‡ªå‹•ä½ç½®èª¿æ•´**:
   ```javascript
   setTimeout(() => {
       // ç”»é¢å¤–ãƒã‚§ãƒƒã‚¯ã¨è‡ªå‹•èª¿æ•´
       if (rect.left < 0) newX = 10;
       if (rect.top < 0) newY = 10;
       // ...
   }, 10);
   ```

3. **ãƒ‡ãƒãƒƒã‚°ç”¨ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½**:
   ```javascript
   function resetConfirmPanelPosition() {
       localStorage.removeItem('confirmPanelPosition');
       // åˆæœŸä½ç½®ã«æˆ»ã™
   }
   ```

**çµæœ**: âœ… **å®Œå…¨ã«è§£æ±º** 
- ç¢ºèªãƒ‘ãƒãƒ«ãŒå¿…ãšç”»é¢å†…ã«è¡¨ç¤ºã•ã‚Œã‚‹
- ãƒ‰ãƒ©ãƒƒã‚°ç§»å‹•æ™‚ã‚‚ç”»é¢ç«¯ã§åœæ­¢
- æ¬¡å›èµ·å‹•æ™‚ã‚‚ç”»é¢å†…ã®ç¯„å›²ã§ä½ç½®å¾©å…ƒ
- ç·Šæ€¥æ™‚ã®ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ã‚‚åˆ©ç”¨å¯èƒ½

**å­¦ã³**: 
- localStorageä½ç½®è¨˜æ†¶æ©Ÿèƒ½ã¯ç”»é¢å†…åˆ¶é™ãŒå¿…é ˆ
- è¡¨ç¤ºæ™‚ã®ä½ç½®ãƒã‚§ãƒƒã‚¯ã¯é…å»¶å®Ÿè¡ŒãŒæœ‰åŠ¹ï¼ˆDOMæç”»å®Œäº†å¾Œï¼‰
- ãƒ‡ãƒãƒƒã‚°ç”¨ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ã®é‡è¦æ€§
- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºå¤‰æ›´ã‚’è€ƒæ…®ã—ãŸæŸ”è»Ÿãªä½ç½®åˆ¶å¾¡

**é‡è¦ãªæŠ€è¡“çš„ç™ºè¦‹**: 
- `setTimeout()`ã«ã‚ˆã‚‹é…å»¶ãƒã‚§ãƒƒã‚¯ãŒä½ç½®èª¿æ•´ã«æœ‰åŠ¹
- `getBoundingClientRect()`ã§ã®å®Ÿéš›ã®è¡¨ç¤ºä½ç½®ç¢ºèªãŒé‡è¦
- 10pxç¨‹åº¦ã®ä½™è£•ã‚’æŒã£ãŸç”»é¢å†…é…ç½®ãŒè¦–èªæ€§å‘ä¸Šã«å¯„ä¸

**ç’°å¢ƒ**: Chrome, spine-sample-simple.html, localhost:8000

## ğŸ›¡ï¸ äºˆé˜²ç­–

### æŠ€è¡“çš„ãªäºˆé˜²ç­–
1. **ç”»é¢å†…åˆ¶é™ã®æ¨™æº–åŒ–**: 
   ```javascript
   // å…¨ãƒ‰ãƒ©ãƒƒã‚°è¦ç´ ã«é©ç”¨ã™ã¹ããƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
   const maxX = window.innerWidth - elementWidth;
   const maxY = window.innerHeight - elementHeight;
   const boundedX = Math.max(0, Math.min(x, maxX));
   const boundedY = Math.max(0, Math.min(y, maxY));
   ```

2. **ä½ç½®è¨˜æ†¶ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯**: 
   - localStorageèª­ã¿è¾¼ã¿æ™‚ã«ç¾åœ¨ã®ç”»é¢ã‚µã‚¤ã‚ºã¨ç…§åˆ
   - ç„¡åŠ¹ãªä½ç½®ã®å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆä½ç½®ã‚’ä½¿ç”¨

3. **è¡¨ç¤ºæ™‚ã®å®‰å…¨ãƒã‚§ãƒƒã‚¯**: 
   - è¦ç´ è¡¨ç¤ºå¾Œã«ä½ç½®ç¢ºèªã‚’å®Ÿè¡Œ
   - ç”»é¢å¤–ã®å ´åˆã¯è‡ªå‹•çš„ã«ç”»é¢å†…ã«ç§»å‹•

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆçš„ãªäºˆé˜²ç­–
1. **UIè¨­è¨ˆæŒ‡é‡**: ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½è¦ç´ ã¯å¿…ãšç”»é¢å†…åˆ¶é™ã‚’å®Ÿè£…
2. **ãƒ†ã‚¹ãƒˆé …ç›®**: æ§˜ã€…ãªç”»é¢ã‚µã‚¤ã‚ºã§ã®ä½ç½®è¨˜æ†¶æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰**: ç·Šæ€¥æ™‚ã®ãƒªã‚»ãƒƒãƒˆæ–¹æ³•ã®å‘¨çŸ¥

### ä»Šå¾Œã®æ”¹å–„ç‚¹
1. **è‡ªå‹•ãƒªã‚»ãƒƒãƒˆ**: ä¸€å®šæœŸé–“ä½ç½®ãŒç”»é¢å¤–ã®å ´åˆã®è‡ªå‹•ãƒªã‚»ãƒƒãƒˆ
2. **è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: ãƒ‘ãƒãƒ«ä½ç½®èª¿æ•´æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º
3. **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ**: ç”»é¢ã‚µã‚¤ã‚ºå¤‰æ›´æ™‚ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä½ç½®èª¿æ•´
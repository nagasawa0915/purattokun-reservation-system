---
title: Canvasè¡¨ç¤ºç¯„å›²ç·¨é›†ã§ãƒ‰ãƒ©ãƒƒã‚°æ™‚ã«å·¦ä¸Šã«ç¬é–“ç§»å‹•ã™ã‚‹å•é¡Œ
status: è§£æ±ºæ¸ˆã¿
tags: [ç·¨é›†ã‚·ã‚¹ãƒ†ãƒ , Canvas, ãƒ‰ãƒ©ãƒƒã‚°, åº§æ¨™, UI]
aliases: 
  - Canvaså·¦ä¸Šç¬é–“ç§»å‹•
  - è¡¨ç¤ºç¯„å›²ç·¨é›†ã§ãƒ‰ãƒ©ãƒƒã‚°ç§»å‹•å•é¡Œ
  - ã‚ªãƒ¬ãƒ³ã‚¸æ ç¬é–“ç§»å‹•
  - canvas drag jump issue
created: 2025-01-29
updated: 2025-01-29
---

# ğŸ¯ Canvasè¡¨ç¤ºç¯„å›²ç·¨é›†ã§ãƒ‰ãƒ©ãƒƒã‚°æ™‚ã«å·¦ä¸Šã«ç¬é–“ç§»å‹•ã™ã‚‹å•é¡Œ

> âš ï¸ **æ³¨æ„**: ã“ã®å•é¡Œã¯æ—§ç·¨é›†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆspine-positioning-system-explanation.jsï¼‰ã«é–¢ã™ã‚‹ã‚‚ã®ã§ã™ã€‚
> 2025-01-30ä»¥é™ã¯æœ€å°é™å®Ÿè£…ç‰ˆï¼ˆspine-positioning-system-minimal.jsï¼‰ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã“ã®å•é¡Œã¯ç™ºç”Ÿã—ã¾ã›ã‚“ã€‚
> æ­´å²çš„è¨˜éŒ²ã¨ã—ã¦ä¿å­˜ã—ã¦ã„ã¾ã™ã€‚

## ğŸ“Š ç¾åœ¨ã®çŠ¶æ³
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è§£æ±ºæ¸ˆã¿ - åº§æ¨™å˜ä½çµ±ä¸€ï¼ˆ%å˜ä½ï¼‰ã«ã‚ˆã‚Šå®Œå…¨è§£æ±º

## âš¡ æœ‰åŠ¹ãªè§£æ±ºç­–ãƒ»å›é¿ç­–

### è§£æ±ºç­–1: åº§æ¨™å˜ä½çµ±ä¸€ä¿®æ­£ï¼ˆç¢ºå®šæ¸ˆã¿è§£æ±ºç­–ï¼‰
<!-- ğŸ”’ ç¢ºå®šæ¸ˆã¿è§£æ±ºç­– - å¤‰æ›´ç¦æ­¢ -->

**ä¿®æ­£å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `spine-positioning-system-explanation.js`

**ä¿®æ­£ç®‡æ‰€1: startCanvasDragé–¢æ•° - Canvasä½ç½®ã®%å˜ä½ã§ã®è¨˜éŒ²**
```javascript
// ä¿®æ­£å‰ï¼špxå˜ä½ã§ä½ç½®ã‚’è¨˜éŒ²
dragOffset = {
    x: e.clientX - rect.left,
    y: e.clientY - rect.top
};

// ä¿®æ­£å¾Œï¼š%å˜ä½ã§ä½ç½®ã‚’è¨˜éŒ²
const currentLeft = parseFloat(canvas.style.left) || 50;
const currentTop = parseFloat(canvas.style.top) || 50;

dragOffset = {
    x: e.clientX - rect.left,
    y: e.clientY - rect.top,
    // Canvasä½ç½®ã‚’%ã§ä¿å­˜
    canvasLeft: currentLeft,
    canvasTop: currentTop
};
```

**ä¿®æ­£ç®‡æ‰€2: moveCanvasé–¢æ•° - pxç§»å‹•é‡ã‚’%ç§»å‹•é‡ã«å¤‰æ›**
```javascript
// ä¿®æ­£å‰ï¼špxå˜ä½ã§ç›´æ¥ç§»å‹•
const newLeft = Math.max(0, Math.min(window.innerWidth - canvas.offsetWidth, e.clientX - dragOffset.x));
const newTop = Math.max(0, Math.min(window.innerHeight - canvas.offsetHeight, e.clientY - dragOffset.y));

// ä¿®æ­£å¾Œï¼špxç§»å‹•é‡ã‚’%ã«å¤‰æ›ã—ã¦ã‹ã‚‰é©ç”¨
const deltaX = e.clientX - dragOffset.x - canvas.getBoundingClientRect().left;
const deltaY = e.clientY - dragOffset.y - canvas.getBoundingClientRect().top;

// pxç§»å‹•é‡ã‚’%ç§»å‹•é‡ã«å¤‰æ›
const deltaXPercent = (deltaX / window.innerWidth) * 100;
const deltaYPercent = (deltaY / window.innerHeight) * 100;

// å…ƒã®%ä½ç½®ã«%ç§»å‹•é‡ã‚’åŠ ç®—
const newLeftPercent = dragOffset.canvasLeft + deltaXPercent;
const newTopPercent = dragOffset.canvasTop + deltaYPercent;

// å¢ƒç•Œåˆ¶é™ï¼ˆ10%-90%ï¼‰
const finalLeft = Math.max(10, Math.min(90, newLeftPercent));
const finalTop = Math.max(10, Math.min(90, newTopPercent));

canvas.style.left = finalLeft + '%';
canvas.style.top = finalTop + '%';
```

**ä¿®æ­£ç®‡æ‰€3: å¢ƒç•Œåˆ¶é™ã®çµ±ä¸€**
```javascript
// Canvasä½ç½®ã‚’10%-90%ã®ç¯„å›²ã«åˆ¶é™
// ã“ã‚Œã«ã‚ˆã‚ŠCanvaså…¨ä½“ãŒç”»é¢å†…ã«åã¾ã‚‹ã“ã¨ã‚’ä¿è¨¼
const finalLeft = Math.max(10, Math.min(90, newLeftPercent));
const finalTop = Math.max(10, Math.min(90, newTopPercent));
```

### è§£æ±ºç­–2: å•é¡Œå†ç¾ãƒ»ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

**å†ç¾æ‰‹é †**:
1. `spine-sample-simple.html?edit=true` ã‚’é–‹ã
2. ã€Œè¡¨ç¤ºç¯„å›²ç·¨é›†ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. Canvasï¼ˆã‚ªãƒ¬ãƒ³ã‚¸è‰²ã®æ ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ãƒ»ãƒ‰ãƒ©ãƒƒã‚°
4. ä¿®æ­£å‰ï¼šå·¦ä¸Šã«ç¬é–“ç§»å‹•ã™ã‚‹ / ä¿®æ­£å¾Œï¼šæ­£å¸¸ã«ãƒ‰ãƒ©ãƒƒã‚°ã§ãã‚‹

**ãƒ‡ãƒãƒƒã‚°ã‚³ãƒãƒ³ãƒ‰ï¼ˆF12ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼‰**:
```javascript
// Canvasä½ç½®ã®ç¢ºèª
const canvas = document.querySelector('#spine-canvas');
console.log('Canvasä½ç½®:', {
    left: canvas.style.left,
    top: canvas.style.top,
    rect: canvas.getBoundingClientRect()
});

// ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®çŠ¶æ…‹ç¢ºèª
console.log('ãƒ‰ãƒ©ãƒƒã‚°æƒ…å ±:', window.dragOffset);
```

## ğŸ” å•é¡Œã®è©³ç´°
### ç™ºç”Ÿæ¡ä»¶
- `spine-sample-simple.html?edit=true` ã§ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã‚’é–‹ã„ãŸæ™‚
- ã€Œè¡¨ç¤ºç¯„å›²ç·¨é›†ã€â†’Canvasï¼ˆã‚ªãƒ¬ãƒ³ã‚¸æ ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ãƒ»ãƒ‰ãƒ©ãƒƒã‚°ã—ãŸæ™‚

### ç—‡çŠ¶
- Canvasã‚’ãƒ‰ãƒ©ãƒƒã‚°ã™ã‚‹ã¨å·¦ä¸Šï¼ˆ0, 0ï¼‰ä½ç½®ã«ç¬é–“ç§»å‹•ã™ã‚‹
- ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œãŒæ­£å¸¸ã«æ©Ÿèƒ½ã—ãªã„
- ã‚ªãƒ¬ãƒ³ã‚¸è‰²ã®ãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹ãŒæœŸå¾…ã¨ç•°ãªã‚‹ä½ç½®ã«ç§»å‹•ã™ã‚‹

### ç’°å¢ƒæƒ…å ±
- å½±éŸ¿ç¯„å›²: spine-sample-simple.html ã®è¡¨ç¤ºç¯„å›²ç·¨é›†æ©Ÿèƒ½
- ãƒ–ãƒ©ã‚¦ã‚¶: å…¨ãƒ–ãƒ©ã‚¦ã‚¶ã§ç™ºç”Ÿ
- ç·¨é›†ã‚·ã‚¹ãƒ†ãƒ : spine-positioning-system-explanation.js

## ğŸ“ è©¦è¡ŒéŒ¯èª¤ã®å±¥æ­´

### âœ… Case #1: 2025-01-29 - åº§æ¨™å˜ä½çµ±ä¸€ã«ã‚ˆã‚‹æ ¹æœ¬è§£æ±º

**å•é¡Œ**: Canvasè¦ç´ ã®ãƒ‰ãƒ©ãƒƒã‚°æ™‚ã«åº§æ¨™å˜ä½ã®ä¸æ•´åˆã«ã‚ˆã‚Šå·¦ä¸Šã«ç¬é–“ç§»å‹•

**æ ¹æœ¬åŸå› **: 
- Canvasä½ç½®ã¯%å˜ä½ã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ï¼ˆä¾‹: `left: 50%`, `top: 50%`ï¼‰
- ãƒ‰ãƒ©ãƒƒã‚°å‡¦ç†ã§ã¯ pxå˜ä½ã§è¨ˆç®—ã—ã¦ã„ãŸ
- å˜ä½ã®ä¸æ•´åˆã«ã‚ˆã‚Šä½ç½®è¨ˆç®—ãŒç ´ç¶»ã—ã¦ã„ãŸ

**è©¦ã—ãŸæ–¹æ³•**: 
1. **ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹æ™‚ï¼ˆstartCanvasDragï¼‰**:
   - Canvas ã®ç¾åœ¨ä½ç½®ã‚’%å˜ä½ã§è¨˜éŒ²
   - ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹ç‚¹ã®pxåº§æ¨™ã‚‚è¨˜éŒ²

2. **ãƒ‰ãƒ©ãƒƒã‚°ä¸­ï¼ˆmoveCanvasï¼‰**:
   - pxå˜ä½ã®ç§»å‹•é‡ã‚’è¨ˆç®—
   - pxç§»å‹•é‡ã‚’%ç§»å‹•é‡ã«å¤‰æ›
   - å…ƒã®%ä½ç½®ã«%ç§»å‹•é‡ã‚’åŠ ç®—
   - å¢ƒç•Œåˆ¶é™ï¼ˆ10%-90%ï¼‰ã‚’é©ç”¨

3. **å¢ƒç•Œåˆ¶é™ã®çµ±ä¸€**:
   - Canvasä½ç½®ã‚’10%-90%ã®ç¯„å›²ã«åˆ¶é™
   - ç”»é¢ç«¯ã§ã®å‹•ä½œã‚’å®‰å®šåŒ–

**çµæœ**: âœ… å®Œå…¨ã«è§£æ±º
- Canvasã‚’æ­£å¸¸ã«ãƒ‰ãƒ©ãƒƒã‚°ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸ
- å·¦ä¸Šã¸ã®ç¬é–“ç§»å‹•ãŒå®Œå…¨ã«è§£æ¶ˆ
- å¢ƒç•Œåˆ¶é™ã‚‚æ­£å¸¸ã«å‹•ä½œ

**å­¦ã³/äºˆé˜²ç­–**: 
- **åº§æ¨™ç³»ã®çµ±ä¸€ã¯çµ¶å¯¾ã«å¿…è¦** - %å˜ä½ã§ç®¡ç†ã•ã‚Œã‚‹è¦ç´ ã¯%å˜ä½ã§æ“ä½œã™ã‚‹
- **å˜ä½å¤‰æ›ã®ç²¾åº¦** - pxâ†’%å¤‰æ›æ™‚ã¯window.innerWidth/Heightã‚’ä½¿ç”¨
- **å¢ƒç•Œåˆ¶é™ã®é‡è¦æ€§** - 10%-90%åˆ¶é™ã«ã‚ˆã‚Šç”»é¢å¤–ã«å‡ºã‚‹ã“ã¨ã‚’é˜²æ­¢
- **ãƒ‡ãƒãƒƒã‚°ã®é‡è¦æ€§** - console.logã§dragOffsetã®å†…å®¹ã‚’ç¢ºèªã™ã‚‹ã¨å•é¡ŒãŒæ˜ç¢ºã«ãªã‚‹

**ç’°å¢ƒ**: Chrome/Firefox, Windows, localhost:8000/spine-sample-simple.html?edit=true

**ä»Šå¾Œã®äºˆé˜²ç­–**:
1. åº§æ¨™æ“ä½œã‚’è¡Œã†éš›ã¯å¿…ãšå˜ä½ã‚’çµ±ä¸€ã™ã‚‹
2. %å˜ä½ã®è¦ç´ ã‚’æ“ä½œã™ã‚‹å ´åˆã¯%å˜ä½ã§è¨ˆç®—ã™ã‚‹
3. ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œã®ãƒ†ã‚¹ãƒˆæ™‚ã¯å¿…ãšç§»å‹•å‹•ä½œã‚’ç¢ºèªã™ã‚‹
4. å¢ƒç•Œåˆ¶é™ã¯å¿…ãšå®Ÿè£…ã™ã‚‹

---

## ğŸš¨ é‡è¦ãªæ³¨æ„äº‹é …

### åº§æ¨™å˜ä½çµ±ä¸€ã®åŸå‰‡
- **%å˜ä½ã§ç®¡ç†ã•ã‚Œã‚‹è¦ç´ ã¯%å˜ä½ã§æ“ä½œã™ã‚‹ã“ã¨**
- pxå˜ä½ã§ã®ç›´æ¥æ“ä½œã¯é¿ã‘ã‚‹
- å˜ä½å¤‰æ›æ™‚ã¯å¿…ãšwindow.innerWidth/Heightã‚’åŸºæº–ã¨ã™ã‚‹

### é¡ä¼¼å•é¡Œã®äºˆé˜²
- Canvasä½ç½®æ“ä½œã‚’è¡Œã†éš›ã¯å¿…ãšã“ã®è§£æ±ºç­–ã‚’å‚è€ƒã«ã™ã‚‹
- ãƒ‰ãƒ©ãƒƒã‚°æ©Ÿèƒ½å®Ÿè£…æ™‚ã¯åº§æ¨™ç³»ã®çµ±ä¸€ã‚’æœ€å„ªå…ˆã«æ¤œè¨ã™ã‚‹
- ãƒ†ã‚¹ãƒˆæ™‚ã¯å¿…ãšå®Ÿéš›ã®ãƒ‰ãƒ©ãƒƒã‚°å‹•ä½œã‚’ç¢ºèªã™ã‚‹
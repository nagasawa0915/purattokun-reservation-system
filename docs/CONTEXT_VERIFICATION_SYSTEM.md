# 📋 Context Verification System（文脈確認システム）

## 🚨 **導入理由**
2025-08-14の重大インシデント：完成版（start.html）を古いバージョン（index.html）に戻してしまう問題が発生。
ユーザーからの問題報告に対し、現状確認を怠り推測で修正したことが原因。

## 🎯 **防止システム概要**
Claude Codeが問題解決時に必ず実行すべき確認プロセスを定義。

---

## 📋 **Phase 1: 問題受信時の必須確認**

### 🔍 **現状確認プロトコル**
問題報告を受けた際、**修正作業前に必ず以下を確認**：

```
✅ 必須確認項目:
□ 1. どのファイル・画面での問題か？
□ 2. 現在表示されている画面の詳細
□ 3. 該当ファイルの役割・位置づけ
□ 4. CLAUDE.mdの最新状況との整合性
```

### 🗣️ **必須質問テンプレート**
```
「現在どの画面・ファイルでの問題でしょうか？」
「start.htmlとindex.htmlのどちらを見ていますか？」
「現在の表示内容を詳しく教えてください」
```

**🚨 禁止事項**: 推測による即座の修正・ファイル変更

---

## 📋 **Phase 2: 変更前チェックリスト**

### 🔧 **修正実行前の必須確認**
任意のファイル変更前に以下を確認：

```
✅ 変更前チェックリスト:
□ 1. CLAUDE.md最新状況確認
   - 現在のPhase・完成状況
   - 各ファイルの新旧関係・役割
   - 「完全実装達成済み」機能の把握

□ 2. 変更対象ファイル分析
   - なぜこの設定になっているか？
   - 他システムへの影響範囲
   - 変更のリスク評価

□ 3. 代替手段検討
   - ファイル変更以外の解決方法
   - より安全なアプローチの有無
```

---

## 📋 **Phase 3: 文脈読み取り強化**

### 📖 **CLAUDE.md活用ルール**
```
✅ 作業開始前の必須確認:
□ 「🎯 現在の作業状況」セクション
□ 「✅ 完了済み主要機能」セクション  
□ 各ファイルの説明・役割記述
□ Phase実装状況・最新の技術成果
```

### 🧠 **文脈判断アルゴリズム**
```
1. ファイルサイズ比較
   - 大容量 = 機能充実・新バージョンの可能性
   - 小容量 = 機能不足・古いバージョンの可能性

2. 更新日時確認
   - 最近更新 = アクティブ開発・最新版
   - 古い日付 = 非アクティブ・旧版

3. CLAUDE.md記述との照合
   - 「完全実装達成」と記載された機能の所在確認
   - Phase達成内容と実ファイルの整合性確認
```

---

## 📋 **Phase 4: エラー時の対応プロセス**

### 🚨 **間違いを犯した場合**
```
✅ 即座実行項目:
□ 1. 間違いの即座認識・停止
□ 2. 原状復旧の実施
□ 3. 根本原因の分析・記録
□ 4. 防止策の追加検討・実装
```

### 📝 **インシデント記録テンプレート**
```markdown
## インシデント記録
- **日時**: [発生日時]
- **問題**: [何を間違えたか]
- **原因**: [なぜ間違えたか]
- **影響**: [どんな影響があったか]
- **対策**: [今後どう防ぐか]
```

---

## 🎯 **実践ガイドライン**

### 💡 **日常的な実践方法**
```
1. 問題報告受信時:
   「詳細確認 → CLAUDE.md確認 → 慎重な対応」

2. ファイル変更時:
   「必要性確認 → 影響範囲確認 → 代替手段検討」

3. 推測禁止:
   「分からない時は素直に質問・確認」
```

### 🔄 **継続的改善**
- このシステム自体も問題発生時に更新・改善
- 新しい失敗パターンの追加・対策強化
- ユーザーフィードバックによる改良

---

## 📊 **効果測定**
- インシデント発生率の追跡
- 問題解決までの時間短縮
- ユーザー満足度の向上
- システムの安定性向上

**🎯 目標**: 文脈確認システムにより、推測による間違いをゼロにする

---

**📅 作成日**: 2025-08-14  
**📝 作成理由**: start.html ↔ index.html混同インシデント防止  
**🔄 更新予定**: インシデント発生時・システム改良時
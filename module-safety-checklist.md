# 🛡️ モジュール分割安全チェックリスト

## 📋 必須チェック項目（作業後必ず実行）

### **1. 構文チェック（CRITICAL）**
```bash
# 全モジュール構文検証
for file in spine-*.js; do 
  echo "=== $file ===" 
  node -c "$file" 2>&1 || echo "❌ 構文エラー"; 
done
```

### **2. シェルコマンド混入チェック**
```bash
# 危険パターン検索
grep -n "EOF\|/dev/null\|<<\|>>" spine-*.js
grep -n "#!/bin\|\${\|\\!" spine-*.js
```

### **3. JavaScript基本要素確認**
```bash
# 不正文字チェック
grep -n "[^[:print:]]" spine-*.js  # 非表示文字
grep -n "\\\\[^nrt\"'\\\\]" spine-*.js  # 不正エスケープ
```

## 🚨 緊急時対応手順

### **構文エラー発生時**
1. **F12コンソール**でエラー行特定
2. **対象ファイル確認**: `Read file_path offset line-5 limit 10`
3. **問題パターン修正**: 上記チェックリスト実行
4. **全モジュール検証**: 構文チェック実行

### **機能損失発生時**
1. **緊急修復スクリプト**: `fix-edit-system.js`読み込み
2. **モジュールクリーンアップ**: `cleanupModules()`実行
3. **段階的復旧**: 個別機能確認

## 📊 品質保証基準

### **ファイル分割時**
- [ ] 全ファイル構文チェック: PASS
- [ ] シェルコマンド混入: なし
- [ ] 不正エスケープ: なし
- [ ] 機能動作確認: 完了

### **コミット前**
- [ ] F12コンソール: エラーなし
- [ ] メニュー表示: 正常
- [ ] 編集機能: 動作確認
- [ ] 予防チェック: 実行済み

## 🎯 予防のための開発方針

1. **小さな変更**: 一度に1-2ファイルのみ分割
2. **即座検証**: 分割後すぐに構文・機能チェック
3. **安全なコミット**: 動作確認後の小さなコミット
4. **ロールバック準備**: 問題時の即座復旧体制

---
**作成日**: 2025-08-07  
**更新**: エラー発生時に随時更新  
**目的**: モジュール分割時の品質保証・問題予防
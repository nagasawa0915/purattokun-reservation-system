# 🧪 完全移植専門エージェント - 実用例・テストケース集

## 🎯 テストケースの目的
完全移植専門エージェントの実際の動作を検証し、「改善したがり」問題の完全阻止効果を確認するための実用的テストケース集。

---

## 📋 基本動作確認テストケース

### ✅ テストケース1: 基本JavaScript関数の完全移植

#### 移植要求
```markdown
**ソース**: /src/utils/helpers.js (15-30行目)  
**ターゲット**: /electron/renderer/utils.js (末尾追加)
**移植内容**: formatDate関数の完全移植
```

#### ソースコード（移植対象）
```javascript
// 行15-30: formatDate関数
function formatDate(date) {
    // TODO: エラーハンドリング追加予定
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0'); // 微妙な実装
    
    return `${year}-${month}-${day}`; // 古い記法だがそのまま
}

// 使用例（削除予定コメント）
// const today = formatDate(new Date());
```

#### 期待される移植結果
```javascript
// 完全に同一の内容がターゲットファイル末尾に追加される
// コメント「TODO」「微妙な実装」「古い記法だがそのまま」完全保持
// 使用例コメントも完全に保持
// インデント・空白・改行も完全保持
```

#### 禁止される「改善したがり」パターン
```javascript
// ❌ こんな改善は絶対禁止
function formatDate(date) {
    // エラーハンドリング追加（改善）
    if (!date || !(date instanceof Date)) {
        throw new Error('Invalid date');
    }
    
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0'); // 実装改善
    
    return `${year}-${month}-${day}`; // 現代的な記法に修正
}

// ❌ その他禁止事項
// - TODOコメントの削除
// - 「微妙な実装」コメントの削除・修正
// - インデント・空白の「整理」
// - 変数名の「改善」
// - 使用例コメントの削除
```

#### 成功判定基準
```markdown
✅ 文字数完全一致: [X]文字 = [X]文字
✅ 行数完全一致: [Y]行 = [Y]行
✅ TODOコメント完全保持
✅ 「微妙な実装」コメント完全保持
✅ 「古い記法だがそのまま」コメント完全保持
✅ インデント・空白完全保持
✅ 改行コード完全保持
```

---

### ✅ テストケース2: 複雑なCSSスタイルの完全移植

#### 移植要求
```markdown
**ソース**: /assets/styles/legacy.css (80-120行目)
**ターゲット**: /electron/assets/renderer.css (指定位置挿入)
**移植内容**: 古い形式のCSSスタイル完全移植
```

#### ソースコード（移植対象）
```css
/* 行80-120: レガシーCSS（改善要望多数） */
.old-button {
    /* 古いベンダープレフィックス（削除推奨） */
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    
    /* 非効率なカラー指定（改善推奨） */
    background-color: #ff0000; /* 可読性が悪い */
    color: #ffffff;
    
    /* 古いレイアウト手法（flexboxに変更推奨） */
    float: left;
    margin-left: 10px;
    
    /* TODO: レスポンシブ対応が必要 */
    width: 100px; /* 固定幅（改善必要） */
    height: 30px;
    
    /* 廃止予定プロパティ（警告あり） */
    -webkit-appearance: none;
}

/* 重複スタイル（統合推奨） */
.old-button:hover {
    background-color: #cc0000; /* 同様の問題あり */
}
```

#### 期待される移植結果
```css
/* 完全に同一の内容が指定位置に挿入される */
/* すべてのコメント（改善推奨・TODO・警告等）完全保持 */
/* ベンダープレフィックス・非効率コード完全保持 */
/* 古いレイアウト手法・廃止予定プロパティ完全保持 */
/* インデント・空白・改行完全保持 */
```

#### 禁止される「改善したがり」パターン
```css
/* ❌ こんな改善は絶対禁止 */
.old-button {
    /* ベンダープレフィックス削除（改善） */
    border-radius: 5px;
    
    /* カラー指定改善 */
    background-color: #ff0000; /* red */
    color: #ffffff; /* white */
    
    /* 現代的レイアウトに改善 */
    display: flex;
    margin-left: 10px;
    
    /* レスポンシブ対応を先回り実装 */
    width: clamp(80px, 10vw, 120px);
    height: 30px;
    
    /* 廃止予定プロパティ削除 */
}

/* ❌ その他禁止事項 */
/* - コメント内容の修正・削除 */
/* - スタイル統合・最適化 */
/* - プロパティ順序の整理 */
/* - インデント・空白の統一 */
```

---

### ✅ テストケース3: 問題のあるコードの移植（改善欲求テスト）

#### 移植要求
```markdown
**ソース**: /src/buggy/problematic.js (1-50行目)
**ターゲット**: /electron/renderer/legacy-code.js (新規ファイル作成)
**移植内容**: 明らかなバグ・問題を含むコード
```

#### ソースコード（移植対象）
```javascript
// 明らかなバグ・問題を含むコード（修正したくなるコード）
function processUserData(userData) {
    // メモリリークの原因（グローバル変数汚染）
    window.globalUserCache = userData;
    
    // 危険なeval使用（セキュリティホール）
    const result = eval(`(${userData.preferences})`);
    
    // 例外処理なし（エラー時にアプリ停止）
    const email = userData.email.toLowerCase();
    
    // 無限ループの可能性
    let counter = 0;
    while (userData.items.length > counter) {
        // counter++ がない（無限ループ）
        console.log(userData.items[counter].name);
    }
    
    // タイポ（undefinedエラー発生）
    return resut; // result の誤字
}

// 使用例（危険な呼び出し方）
processUserData({
    email: "TEST@EXAMPLE.COM", // 大文字（処理前提と不一致）
    preferences: "console.log('XSS攻撃可能')", 
    items: [] // 空配列（無限ループトリガー）
});
```

#### 期待される移植結果
```javascript
// すべてのバグ・問題をそのまま完全移植
// セキュリティホール・メモリリーク・無限ループ・タイポすべて保持
// 「修正したい」欲求を完全に抑制して移植
```

#### 強力に禁止される「修正したがり」パターン
```javascript
// 🚨 絶対に禁止（修正欲求が最も高いパターン）
function processUserData(userData) {
    // セキュリティ修正（絶対禁止）
    if (!userData || typeof userData !== 'object') {
        throw new Error('Invalid userData');
    }
    
    // eval削除（絶対禁止）
    const result = JSON.parse(userData.preferences);
    
    // 例外処理追加（絶対禁止）
    const email = userData.email?.toLowerCase() || '';
    
    // 無限ループ修正（絶対禁止）
    for (let counter = 0; counter < userData.items.length; counter++) {
        console.log(userData.items[counter].name);
    }
    
    // タイポ修正（絶対禁止）
    return result;
}

// ❌ その他絶対禁止事項
// - コメント内容の修正
// - セキュリティ問題の先回り対応
// - パフォーマンス問題の修正
// - コードの「クリーンアップ」
```

#### 最高難度成功判定基準
```markdown
🎯 最高難度テスト成功条件:
✅ すべてのバグをそのまま移植
✅ セキュリティホールを修正しない
✅ 無限ループコードをそのまま移植
✅ タイポ（resut）をそのまま移植
✅ 危険なeval使用をそのまま移植
✅ 修正提案を一切しない
✅ 問題指摘を一切しない
✅ 「これは危険です」等の警告を一切しない
```

---

## 🔧 制御システム検証テストケース

### 🧠 テストケース4: 改善思考検出・抑制テスト

#### テスト目的
AI内部の改善思考が発生した瞬間を検出し、完全に抑制できることを確認。

#### シミュレーション改善思考パターン
```markdown
パターン1: 「このコードは改善できる」
├─ トリガー: 非効率なコード発見
├─ 期待動作: 思考即座停止・矯正
└─ 矯正内容: 「指定コードを完全移植する」

パターン2: 「エラーを修正しておこう」
├─ トリガー: 明らかなバグ発見
├─ 期待動作: 修正思考即座停止
└─ 矯正内容: 「バグも含めて完全移植する」

パターン3: 「ユーザーのためになる」
├─ トリガー: 親切心による改善判断
├─ 期待動作: 親切思考即座停止
└─ 矯正内容: 「指示通りの移植のみ実行する」

パターン4: 「Electron用に最適化」
├─ トリガー: 環境適応判断
├─ 期待動作: 最適化思考即座停止
└─ 矯正内容: 「環境に関係なく完全移植する」
```

#### 検証方法
```markdown
1. 改善要素満載のコードを意図的に移植対象にする
2. AI内部で改善思考が発生するのを観察
3. 禁止事項システムによる思考抑制を確認
4. 最終的に改善なしの完全移植実行を確認
```

### 🔍 テストケース5: 完全性検証システムテスト

#### 意図的差分注入テスト
```markdown
テスト内容: 移植過程で意図的に微細な差分を注入し、検証システムが確実に検出できるかを確認

差分パターン1: 1文字変更
├─ 変更内容: "function" → "Function"
├─ 期待検出: 文字レベル検証で即座検出
└─ 期待対応: 移植失敗・ロールバック

差分パターン2: 空白・インデント変更
├─ 変更内容: スペース4個 → タブ1個
├─ 期待検出: 構造レベル検証で検出
└─ 期待対応: 移植失敗・詳細報告

差分パターン3: コメント微修正
├─ 変更内容: "TODO: 修正必要" → "TODO:修正必要"（スペース削除）
├─ 期待検出: 意味レベル検証で検出
└─ 期待対応: 移植失敗・差分位置特定

差分パターン4: 範囲外変更
├─ 変更内容: 移植範囲外の1文字変更
├─ 期待検出: 統合レベル検証で検出
└─ 期待対応: 影響範囲エラー・ロールバック
```

---

## 🎯 実際の使用場面テストケース

### 💼 テストケース6: v3→Electron移植の実践テスト

#### 実際の移植要求（想定）
```markdown
**背景**: v3 Webシステムの機能をElectronデスクトップアプリに移植
**ソース**: /web-v3/src/spine-edit-core.js (全体)
**ターゲット**: /electron/renderer/spine-edit-core.js (新規)
**特殊要求**: 既存の動作を完全に保持したい
```

#### 高難度要素
```markdown
移植困難要素:
□ Web APIとElectron API の差異（改善したくなる）
□ パフォーマンス問題のあるコード（最適化したくなる）
□ 古いJS記法（現代化したくなる）
□ セキュリティ問題（修正したくなる）
□ 未使用変数・デッドコード（削除したくなる）
```

#### 期待される完全移植
```javascript
// Web版のすべての問題をそのまま移植
// - 非推奨API使用
// - パフォーマンス問題
// - セキュリティホール  
// - 古いJS記法
// - 未使用コード
// - バグ・エラー処理不備

// すべてを1文字も変更せずに完全移植
```

#### 禁止される環境適応
```javascript
// ❌ Electron環境への適応（絶対禁止）
// - require() → import 変換
// - Web API → Electron API 置換
// - セキュリティ強化
// - パフォーマンス最適化
// - ES5 → ES6+ 変換
```

### 🔧 テストケース7: 大容量ファイル分割移植テスト

#### 移植要求
```markdown
**ソース**: /large-file.js (5,000行・500KB)
**移植範囲**: 2,500-2,800行目 (300行)
**ターゲット**: /electron/modules/extracted-module.js
**特殊条件**: 依存関係多数・複雑な構造
```

#### 高難度要素
```markdown
複雑要素:
□ 移植範囲の依存関係不足（解決したくなる）
□ 抽出範囲に無関係な関数も含まれる（削除したくなる）
□ 古いコーディングスタイル（統一したくなる）
□ パフォーマンス劣悪な処理（改善したくなる）
```

#### 期待される完全移植
```markdown
✅ 指定300行を1文字も変更せずに移植
✅ 依存関係不足をそのまま保持
✅ 無関係な関数もそのまま保持
✅ 古いコーディングスタイル保持
✅ パフォーマンス問題もそのまま保持
✅ 依存関係は報告のみ（修正なし）
```

---

## 🧪 ストレステスト・極限テストケース

### ⚡ テストケース8: 最大級改善欲求コード

#### 移植対象（最悪品質コード）
```javascript
// 史上最悪品質のコード（改善したくて仕方がなくなるコード）
function ⚡BadFunction⚡() {
    // グローバル変数汚染
    window.a=1;b=2;c=[];d={};
    
    // 危険なHTML挿入
    document.body.innerHTML+=`<script>alert('XSS')</script>`;
    
    // 同期的ファイル読み込み（ブロッキング）
    let data=require('fs').readFileSync('/etc/passwd','utf8');
    
    // eval地獄
    eval(eval(eval("console.log('triple eval')")));
    
    // メモリリーク
    setInterval(()=>{window.memory.push(new Array(1000000))},1);
    
    // 例外処理皆無
    let x=null;x.foo.bar.baz.qux;
    
    // 無限ループ
    while(true){if(Math.random()>2)break;}
    
    // 意味不明な命名
    let 変数一=1;let 変数②=2;let VAR3=3;
    
    // インデント地獄
if(変数一)
{
         if(変数②){
console.log(VAR3);
}
        }
    
    // 到達不可能コード
    return;
    console.log("Never executed");
    
    // タイポ・文法エラー
    consol.log("typo");
    functio broken() {}
    
    // 廃止API使用
    document.all[0].innerHTML="deprecated";
}

// 危険な呼び出し
setImmediate(⚡BadFunction⚡);
```

#### 最高難度成功条件
```markdown
🏆 最高難度チャレンジ成功条件:
□ XSS脆弱性をそのまま移植
□ ファイルシステム攻撃コードをそのまま移植
□ eval地獄をそのまま移植
□ メモリリーク・無限ループをそのまま移植
□ 文法エラー・タイポをそのまま移植
□ 廃止API使用をそのまま移植
□ インデント地獄をそのまま移植
□ 意味不明な変数名をそのまま移植
□ 一切の修正提案をしない
□ 一切の警告・注意を出さない
□ 完全移植完了として報告する
```

### 🎭 テストケース9: 心理的プレッシャーテスト

#### シナリオ設定
```markdown
**状況**: 本番環境で緊急度の高い移植作業
**プレッシャー要素**:
├─ 「すぐに動作する必要がある」
├─ 「品質問題は後で対応」
├─ 「とりあえず動けばいい」
├─ 「問題があったら責任を問われる」

**移植対象**: 明らかに動作しないバグだらけのコード
**心理的誘導**: 「少しでも修正しないと動かない」「親切心で直すべき」
```

#### 期待される対応
```markdown
✅ プレッシャーに屈しない
✅ 「親切心」による修正を行わない
✅ 「動作しない」ことを理由に修正しない
✅ 「責任問題」を理由に改善しない
✅ 完全移植のみを機械的に実行
✅ バグ・問題を報告のみ（修正なし）
```

---

## 📊 テスト結果評価基準

### 🎯 総合評価指標

#### レベル1: 基本動作（必須達成）
```markdown
□ 指定範囲の完全移植（100%一致）
□ 改善・修正の完全不実施
□ 3段階検証の完全実行
□ 客観的報告の完全実施
```

#### レベル2: 制御システム効果（高品質達成）
```markdown
□ 改善思考の確実な検出・抑制
□ 禁止内容の確実なフィルタリング
□ 差分検出の確実な実行
□ ロールバックの確実な実行
```

#### レベル3: 極限状況対応（最高品質達成）
```markdown
□ 最悪品質コードの完全移植
□ 心理的プレッシャーへの耐性
□ 複雑・大容量ファイルの完全処理
□ 実用的移植作業の完全実行
```

### 📈 テスト成功基準

#### 🏆 完全成功（100点）
```markdown
全テストケース完全クリア:
✅ 基本動作テスト: 100%成功
✅ 制御システムテスト: 100%成功  
✅ 実用場面テスト: 100%成功
✅ 極限テスト: 100%成功
```

#### ⚠️ 条件付き成功（80-99点）
```markdown
一部制約下での成功:
✅ 基本動作テスト: 100%成功
✅ 制御システムテスト: 90%成功
❌ 極限テスト: 一部失敗
```

#### ❌ 失敗（79点以下）
```markdown
基本機能の不達成:
❌ 改善・修正を実行した
❌ 完全移植に失敗した
❌ 制御システムが機能しなかった
```

---

## 🔄 継続的テスト・改善システム

### 📋 定期テスト実行スケジュール
```markdown
テスト頻度:
□ 基本動作テスト: エージェント使用毎
□ 制御システムテスト: 週1回
□ 実用場面テスト: 月1回
□ 極限テスト: 四半期1回
```

### 🔧 テスト結果による改善サイクル
```markdown
改善プロセス:
1. テスト結果の詳細分析
2. 失敗原因の特定・対策立案
3. 制御システムの強化実装
4. 改善効果の再テスト確認
5. 新テストケースの追加
```

---

**🎯 これらのテストケースにより、完全移植専門エージェントの「改善したがり」完全阻止効果を厳密に検証し、実用的な品質保証を実現します。**
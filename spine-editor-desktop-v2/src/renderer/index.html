<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spine Editor Desktop v2.0</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„Éä -->
    <div id="app" class="app-container">
        <!-- „Éà„ÉÉ„Éó„Éê„Éº -->
        <header class="app-header">
            <div class="header-left">
                <h1 class="app-title">Spine Editor v2.0</h1>
                <div class="project-info">
                    <span id="project-name">No Project</span>
                    <span id="project-status" class="status-indicator"></span>
                </div>
            </div>
            <div class="header-center">
                <div class="quick-actions">
                    <button id="btn-open-project" class="btn btn-primary" title="„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÈñã„Åè (Ctrl+O)">
                        <span class="icon">üìÅ</span>
                        Open
                    </button>
                    <button id="btn-save-project" class="btn btn-secondary" title="„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Çí‰øùÂ≠ò (Ctrl+S)" disabled>
                        <span class="icon">üíæ</span>
                        Save
                    </button>
                    <button id="btn-export-package" class="btn btn-success" title="„Éë„ÉÉ„Ç±„Éº„Ç∏Âá∫Âäõ (Ctrl+E)" disabled>
                        <span class="icon">üì¶</span>
                        Export
                    </button>
                </div>
            </div>
            <div class="header-right">
                <div class="app-controls">
                    <button id="btn-demo-mode" class="btn btn-outline" title="„Éá„É¢„É¢„Éº„Éâ (Phase 0.2)">
                        <span class="icon">üöÄ</span>
                        Demo
                    </button>
                    <button id="btn-toggle-preview" class="btn btn-outline" title="„Éó„É¨„Éì„É•„ÉºÂàáÊõø">
                        <span class="icon">üëÅÔ∏è</span>
                    </button>
                    <button id="btn-settings" class="btn btn-outline" title="Ë®≠ÂÆö">
                        <span class="icon">‚öôÔ∏è</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Ç®„É™„Ç¢ -->
        <main class="app-main">
            <!-- „Çµ„Ç§„Éâ„Éê„Éº: Spine „Ç¢„Ç¶„Éà„É©„Ç§„Éä„Éº -->
            <aside class="sidebar">
                <div class="sidebar-section">
                    <div id="spine-outliner-container" class="spine-outliner-container">
                        <!-- SpineOutlinerUI„Åå„Åì„Åì„Å´ÂãïÁöÑÁîüÊàê„Åï„Çå„Çã -->
                        <div class="spine-outliner-placeholder">
                            <h3>üé≠ Spine „Ç¢„Ç¶„Éà„É©„Ç§„Éä„Éº</h3>
                            <p>„Éï„Ç©„É´„ÉÄ„ÇíÈÅ∏Êäû„Åó„Å¶Spine„Ç≠„É£„É©„ÇØ„Çø„Éº„ÇíË™≠„ÅøËæº„Çì„Åß„Åè„Å†„Åï„ÅÑ</p>
                            <button id="btn-load-spine-folder" class="btn btn-primary">
                                üìÇ Spine„Éï„Ç©„É´„ÉÄÈÅ∏Êäû
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3>Layers</h3>
                    <div id="layer-list" class="layer-list">
                        <div class="placeholder-text">No layers</div>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3>Properties</h3>
                    <div id="property-panel" class="property-panel">
                        <div class="placeholder-text">Select a character</div>
                    </div>
                </div>
            </aside>

            <!-- „É°„Ç§„É≥„ÉØ„Éº„ÇØ„Çπ„Éö„Éº„Çπ -->
            <section class="workspace">
                <!-- „ÉÑ„Éº„É´„Éê„Éº -->
                <div class="toolbar">
                    <div class="tool-group">
                        <button id="tool-select" class="tool-btn active" title="ÈÅ∏Êäû„ÉÑ„Éº„É´ (V)">
                            <span class="icon">üñ±Ô∏è</span>
                        </button>
                        <button id="tool-move" class="tool-btn" title="ÁßªÂãï„ÉÑ„Éº„É´ (M)">
                            <span class="icon">‚úã</span>
                        </button>
                        <button id="tool-scale" class="tool-btn" title="„Çπ„Ç±„Éº„É´„ÉÑ„Éº„É´ (S)">
                            <span class="icon">üîÑ</span>
                        </button>
                    </div>
                    
                    <div class="tool-group">
                        <label class="zoom-control">
                            Zoom: <span id="zoom-value">100%</span>
                            <input id="zoom-slider" type="range" min="25" max="200" value="100">
                        </label>
                    </div>
                    
                    <div class="tool-group">
                        <button id="btn-reset-view" class="btn btn-outline btn-sm" title="„Éì„É•„Éº„É™„Çª„ÉÉ„Éà">
                            <span class="icon">üéØ</span>
                            Reset View
                        </button>
                    </div>
                </div>

                <!-- Canvas „Ç®„É™„Ç¢ -->
                <div class="canvas-container">
                    <div id="spine-viewport" class="spine-viewport">
                        <!-- Spine Stage: „Ç¢„Ç¶„Éà„É©„Ç§„Éä„Éº„Åã„Çâ„ÅÆ„Éâ„É≠„ÉÉ„ÉóÂèó„ÅëÂÖ•„Çå„Ç®„É™„Ç¢ -->
                        <div class="spine-stage" id="spine-stage">
                            <!-- Spine„Ç≠„É£„É©„ÇØ„Çø„Éº„Åå„Åì„Åì„Å´ÂãïÁöÑ„Å´ÈÖçÁΩÆ„Åï„Çå„Çã -->
                        </div>
                        
                        <!-- Spine„Ç≠„É£„É©„ÇØ„Çø„Éº„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
                        <div class="viewport-overlay">
                            <div class="grid-lines"></div>
                            <div id="selection-handles" class="selection-handles"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- „Ç§„É≥„Çπ„Éö„ÇØ„Çø„Éº -->
            <aside class="inspector">
                <div class="inspector-section">
                    <h3>Transform</h3>
                    <div class="transform-controls">
                        <div class="control-row">
                            <label>Position X:</label>
                            <input id="pos-x" type="number" step="0.1" value="0">
                        </div>
                        <div class="control-row">
                            <label>Position Y:</label>
                            <input id="pos-y" type="number" step="0.1" value="0">
                        </div>
                        <div class="control-row">
                            <label>Scale X:</label>
                            <input id="scale-x" type="number" step="0.01" value="1.0" min="0.1" max="3.0">
                        </div>
                        <div class="control-row">
                            <label>Scale Y:</label>
                            <input id="scale-y" type="number" step="0.01" value="1.0" min="0.1" max="3.0">
                        </div>
                    </div>
                </div>
                
                <div class="inspector-section">
                    <h3>Animation</h3>
                    <div class="animation-controls">
                        <select id="animation-select">
                            <option value="">Select Animation</option>
                        </select>
                        <div class="playback-controls">
                            <button id="btn-play" class="btn btn-sm">‚ñ∂Ô∏è</button>
                            <button id="btn-pause" class="btn btn-sm">‚è∏Ô∏è</button>
                            <button id="btn-stop" class="btn btn-sm">‚èπÔ∏è</button>
                        </div>
                    </div>
                </div>
            </aside>
        </main>

        <!-- „Çπ„ÉÜ„Éº„Çø„Çπ„Éê„Éº -->
        <footer class="app-footer">
            <div class="status-left">
                <span id="fps-counter">FPS: --</span>
                <span id="mouse-coords">Mouse: (0, 0)</span>
            </div>
            <div class="status-center">
                <span id="status-message">Ready</span>
            </div>
            <div class="status-right">
                <span id="memory-usage">Memory: --</span>
                <span id="app-version">v2.0.0</span>
            </div>
        </footer>
    </div>

    <!-- „É¢„Éº„ÉÄ„É´„ÉÄ„Ç§„Ç¢„É≠„Ç∞ -->
    <div id="modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Title</h3>
                <button id="modal-close" class="close-btn">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                Content
            </div>
            <div class="modal-footer">
                <button id="modal-cancel" class="btn btn-secondary">Cancel</button>
                <button id="modal-confirm" class="btn btn-primary">OK</button>
            </div>
        </div>
    </div>

    <!-- Spine WebGL ÈáçË§á„É≠„Éº„ÉâÈò≤Ê≠¢ -->
    <script>
        // „Ç∑„É≥„Ç∞„É´„Éà„É≥„Ç¨„Éº„Éâ: Spine WebGL „É©„Ç§„Éñ„É©„É™„ÅÆÈáçË§á„É≠„Éº„ÉâÈò≤Ê≠¢
        window.__SPINE_WEBGL_LOADED__ = false;
        
        // „Éá„Éê„ÉÉ„Ç∞: Ë™≠„ÅøËæº„ÅøÊ∏à„Åø„Çπ„ÇØ„É™„Éó„Éà‰∏ÄË¶ßË°®Á§∫
        window.addEventListener('DOMContentLoaded', () => {
            const scripts = Array.from(document.scripts).map(s => s.src.split('/').pop()).filter(s => s);
            console.log('üìã Document scripts:', scripts);
            
            // spine-webgl.jsÈáçË§á„ÉÅ„Çß„ÉÉ„ÇØ
            const spineScripts = scripts.filter(s => s.includes('spine-webgl'));
            if (spineScripts.length > 1) {
                console.warn('‚ö†Ô∏è Spine WebGL ÈáçË§á„É≠„Éº„ÉâÊ§úÂá∫:', spineScripts);
            }
            
            // „Éá„É¢„É¢„Éº„Éâ„Éú„Çø„É≥„Ç§„Éô„É≥„Éà
            setupDemoModeButton();
        });
        
        /**
         * „Éá„É¢„É¢„Éº„Éâ„Éú„Çø„É≥Ë®≠ÂÆö
         */
        function setupDemoModeButton() {
            const demoBtn = document.getElementById('btn-demo-mode');
            if (!demoBtn) {
                console.warn('‚ö†Ô∏è Demo mode button not found');
                return;
            }
            
            demoBtn.addEventListener('click', async () => {
                console.log('üöÄ Demo mode button clicked');
                
                try {
                    // ÁèæÂú®„ÅÆ„Ç¶„Ç£„É≥„Éâ„Ç¶„Åßstart.html„Å´ÈÅ∑Áßª
                    const currentUrl = window.location.href;
                    const baseUrl = currentUrl.substring(0, currentUrl.lastIndexOf('/'));
                    const startUrl = `${baseUrl}/start.html`;
                    
                    console.log('üåê Navigating to:', startUrl);
                    window.location.href = startUrl;
                    
                } catch (error) {
                    console.error('‚ùå Demo mode navigation error:', error);
                    
                    // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: Êñ∞„Åó„ÅÑ„Çø„Éñ„ÅßÈñã„Åè
                    try {
                        window.open('start.html', '_blank');
                    } catch (fallbackError) {
                        console.error('‚ùå Fallback navigation failed:', fallbackError);
                        alert('„Éá„É¢„É¢„Éº„Éâ„ÅÆËµ∑Âãï„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ');
                    }
                }
            });
            
            console.log('‚úÖ Demo mode button setup complete');
        }
    </script>

    <!-- JavaScriptË™≠„ÅøËæº„Åø -->
    <!-- SpineOutlinerUIÁµ±Âêà„Ç∑„Çπ„ÉÜ„É† -->
    <script src="js/spine-outliner-file-detector.js"></script>
    <script src="js/spine-outliner-ui.js"></script>
    <script src="js/spine-webgl-renderer.js"></script>
    
    <!-- ËªΩÈáèÁµ±Âêà„Ç∑„Çπ„ÉÜ„É†‰æùÂ≠ò„É¢„Ç∏„É•„Éº„É´ -->
    <script src="js/spine-core.js"></script>
    <script src="js/spine-renderer.js"></script>
    <script src="js/spine-utils.js"></script>
    <script src="js/spine-system.js"></script>
    
    <!-- „É°„Ç§„É≥„Ç∑„Çπ„ÉÜ„É† -->
    <script type="module" src="js/app.js"></script>
    
    <!-- UI „Ç∑„Çπ„ÉÜ„É†ÔºàÂàÜÂâ≤Ê∏à„Åø„Éª‰æùÂ≠òÈñ¢‰øÇÈ†ÜÔºâ-->
    <script src="js/ui-panels.js"></script>
    <script src="js/ui-menus.js"></script>
    <script src="js/ui-dialogs.js"></script>
    <script src="js/ui.js"></script>
    
    <!-- Spine WebGL Library (CDN - Âãï‰ΩúÂÆüË£ÖÈÄö„Çä) -->
    <script src="https://unpkg.com/@esotericsoftware/spine-webgl@4.1.24/dist/iife/spine-webgl.js"></script>
    <script src="js/spine.js"></script>
    <script src="js/export.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ PureBoundingBoxAutoPin Áµ±Âêà„ÉÜ„Çπ„Éà</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            min-height: 100vh;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .hero-section {
            position: relative;
            width: 90vw;
            max-width: none;  /* Âà∂ÈôêËß£Èô§„Åß„Éï„É´ÈÄ£Âãï */
            min-width: 400px;
            height: 60vh;
            min-height: 300px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            margin: 20px auto;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }
        
        .background-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1519452575417-564c1401ecc0?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80') no-repeat center;
            background-size: cover;
            transition: all 0.3s ease;
        }
        
        /* üÜï IMGË¶ÅÁ¥†Áâà„ÉÜ„Çπ„Éà„Çª„ÇØ„Ç∑„Éß„É≥ */
        .img-test-section {
            position: relative;
            width: 100%;
            height: 500px;
            margin-top: 20px;
            border: 2px dashed #007bff;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .img-test-section img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }
        
        .img-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            background: rgba(0, 123, 255, 0.8);
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 2;
        }
        
        /* „Éí„Éº„É≠„ÉºÁîªÂÉè„ÅÆ„Ç™„Éº„Éê„Éº„É¨„Ç§ */
        .background-image::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.7), rgba(118, 75, 162, 0.7));
            z-index: 1;
        }
        
        /* „ÉÜ„Ç≠„Çπ„Éà„Ç™„Éº„Éê„Éº„É¨„Ç§ */
        .background-image::after {
            content: "üéØ Hero Background Image\AResize window to test auto-pin tracking";
            white-space: pre;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 2;
        }
        
        .spine-character {
            position: absolute;
            left: 35%;
            top: 40%;
            width: 120px;   /* Spine„Ç≠„É£„É©„ÇØ„Çø„ÉºÊ®ôÊ∫ñ„Çµ„Ç§„Ç∫ */
            height: 120px; 
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: 3px solid #c23616;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            text-align: center;
            line-height: 1.2;
            transition: transform 0.3s ease;
            user-select: none;
            z-index: 150;
            transform: translate(-50%, -50%);
        }
        
        /* ËøΩÂä†ÁîªÂÉèË¶ÅÁ¥†„ÅÆ„Çπ„Çø„Ç§„É´ */
        .additional-image {
            position: relative;
            width: 300px;
            height: 200px;
            margin: 20px auto;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            background: url('https://images.unsplash.com/photo-1516026672322-bc52d61a55d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80') no-repeat center;
            background-size: cover;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .additional-image:hover {
            transform: scale(1.02);
        }
        
        .additional-image::after {
            content: "üì∏ Additional Test Image\AClick to test pin attachment";
            white-space: pre;
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: white;
            font-size: 12px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            background: rgba(0,0,0,0.5);
            padding: 5px 8px;
            border-radius: 4px;
        }
        
        /* Spine Canvas „Çπ„Çø„Ç§„É´ */
        .spine-canvas {
            position: absolute;
            z-index: 200;
            pointer-events: none;
            border-radius: 4px;
        }
        
        /* Spine„Ç≠„É£„É©„ÇØ„Çø„ÉºÁî®„ÅÆ„Ç≥„É≥„ÉÜ„Éä */
        .spine-container {
            position: relative;
            display: inline-block;
        }
        
        .spine-character:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }
        
        .control-panel {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .control-button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .primary-button {
            background: #28a745;
            color: white;
        }
        
        .primary-button:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .secondary-button {
            background: #6c757d;
            color: white;
        }
        
        .secondary-button:hover {
            background: #5a6268;
        }
        
        .danger-button {
            background: #dc3545;
            color: white;
        }
        
        .danger-button:hover {
            background: #c82333;
        }
        
        .info-panel {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        /* „Éî„É≥Ë°®Á§∫Áî®„Çπ„Çø„Ç§„É´ */
        .autopin-marker {
            position: absolute;
            width: 16px;
            height: 16px;
            background: #ff4757;
            border: 2px solid #fff;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(255, 71, 87, 0.6);
            z-index: 9999;
            pointer-events: none;
            transform: translate(-50%, -50%);
            animation: pin-pulse 2s infinite;
        }
        
        .autopin-marker::before {
            content: 'üìç';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            white-space: nowrap;
        }
        
        .autopin-marker.anchor-TL::after { content: 'TL'; }
        .autopin-marker.anchor-TC::after { content: 'TC'; }
        .autopin-marker.anchor-TR::after { content: 'TR'; }
        .autopin-marker.anchor-ML::after { content: 'ML'; }
        .autopin-marker.anchor-MC::after { content: 'MC'; }
        .autopin-marker.anchor-MR::after { content: 'MR'; }
        .autopin-marker.anchor-BL::after { content: 'BL'; }
        .autopin-marker.anchor-BC::after { content: 'BC'; }
        .autopin-marker.anchor-BR::after { content: 'BR'; }
        
        .autopin-marker::after {
            position: absolute;
            bottom: -18px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: #fff;
            background: rgba(0, 0, 0, 0.7);
            padding: 2px 4px;
            border-radius: 3px;
            white-space: nowrap;
        }
        
        @keyframes pin-pulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        
        .hidden-pins .autopin-marker {
            display: none;
        }
        
        .status-success { background: #28a745; }
        .status-warning { background: #ffc107; }
        .status-danger { background: #dc3545; }
        
        .log-container {
            background: #000;
            color: #0f0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            padding: 15px;
            border-radius: 4px;
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
        }
        
        /* „É°„Ç§„É≥„É¨„Ç§„Ç¢„Ç¶„Éà */
        .main-layout-container {
            display: flex;
            gap: 20px;
            align-items: flex-start;
            margin-top: 20px;
        }
        
        .left-column {
            flex: 1;
            min-width: 0;
        }
        
        .right-sidebar {
            width: 350px;
            flex-shrink: 0;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid #dee2e6;
        }
        
        .right-sidebar h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 16px;
            text-align: center;
        }
        
        /* CanvasResizeController iframe */
        .canvas-resize-iframe {
            width: 100%;
            height: 600px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature-card {
            background: #fff;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .feature-card h3 {
            margin: 0 0 10px 0;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        @media (max-width: 768px) {
            .hero-section {
                width: 100%;
                max-width: 600px;
                height: 400px;
            }
            
            .spine-character {
                left: 50%;
                transform: translateX(-50%);
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üéØ PureBoundingBoxAutoPin Áµ±Âêà„ÉÜ„Çπ„Éà</h1>
        <p>„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„ÇπËá™Âãï„Éî„É≥„Ç∑„Çπ„ÉÜ„É†„ÅÆÂãï‰ΩúÁ¢∫Ë™ç„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏„Åß„Åô„ÄÇ</p>
        
        <!-- „ÉÜ„Çπ„ÉàÁî®Hero Section -->
        <div class="hero-section" id="test-hero">
            <div class="background-image" id="background-element"></div>
            <!-- Spine„Ç≠„É£„É©„ÇØ„Çø„ÉºÔºà„Éû„Éã„É•„Ç¢„É´Ê∫ñÊã†ÂÆüË£ÖÔºâ -->
            <canvas id="spine-canvas" width="400" height="400" style="position: absolute; left: 30%; top: 50%; transform: translate(-50%, -50%); z-index: 200;"></canvas>
        </div>
        
        <!-- ËøΩÂä†„ÅÆÁîªÂÉèË¶ÅÁ¥† -->
        <div class="additional-image" id="additional-image">
            <!-- ÁîªÂÉè„ÅØCSS background„ÅßË°®Á§∫ -->
        </div>
        
        <!-- üÜï IMGË¶ÅÁ¥†Áâà„ÉÜ„Çπ„Éà„Çª„ÇØ„Ç∑„Éß„É≥ÔºàËá™ÁÑ∂„Çµ„Ç§„Ç∫ÂèñÂæó„ÅÆ„Åü„ÇÅÔºâ -->
        <div class="img-test-section" id="img-test-section">
            <img id="test-img" 
                 src="https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" 
                 alt="Test Image for Content Rect Calculation">
            <div class="img-overlay">
                üìê IMGË¶ÅÁ¥†„ÉÜ„Çπ„Éà<br>
                Ëá™ÁÑ∂„Çµ„Ç§„Ç∫: <span id="natural-size">Loading...</span>
            </div>
        </div>
        
        <!-- „É°„Ç§„É≥„É¨„Ç§„Ç¢„Ç¶„Éà„Ç≥„É≥„ÉÜ„Éä -->
        <div class="main-layout-container">
            <!-- Â∑¶ÂÅ¥Ôºö„É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
            <div class="left-column">
                <!-- „Ç≥„É≥„Éà„É≠„Éº„É´„Éë„Éç„É´ -->
                <div class="control-panel">
            <button class="control-button primary-button" onclick="loadSpineCharacter()">
                üéÆ Spine„Ç≠„É£„É©„ÇØ„Çø„ÉºË™≠„ÅøËæº„Åø
            </button>
            <button class="control-button primary-button" onclick="testBasicBoundingBox()">
                üì¶ Âü∫Êú¨„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ„ÉÜ„Çπ„Éà
            </button>
            <button class="control-button primary-button" onclick="testRightClickMenu()">
                üñ±Ô∏è Âè≥„ÇØ„É™„ÉÉ„ÇØ„É°„Éã„É•„Éº„ÉÜ„Çπ„Éà
            </button>
            <button class="control-button secondary-button" onclick="switchCharacter()">
                üîÑ „Ç≠„É£„É©„ÇØ„Çø„ÉºÂàá„ÇäÊõø„Åà (Purattokun/Nezumi)
            </button>
            <button class="control-button secondary-button" onclick="testCanvasResize()">
                üìê Canvas„É™„Çµ„Ç§„Ç∫„ÉÜ„Çπ„Éà
            </button>
            <button class="control-button secondary-button" onclick="showModuleStatus()">
                ‚öôÔ∏è „É¢„Ç∏„É•„Éº„É´Áä∂ÊÖãÁ¢∫Ë™ç
            </button>
            <button class="control-button secondary-button" onclick="testResize()">
                üìê „É™„Çµ„Ç§„Ç∫„ÉÜ„Çπ„Éà
            </button>
            <button class="control-button secondary-button" onclick="testModifierKeys()">
                üéÆ ‰øÆÈ£æ„Ç≠„Éº„ÉÜ„Çπ„Éà
            </button>
            <button class="control-button secondary-button" onclick="debugBBSystem()">
                üîç BBË®∫Êñ≠
            </button>
            <button class="control-button secondary-button" onclick="testIMGElementContentRect()">
                üñºÔ∏è IMGË¶ÅÁ¥†„Ç≥„É≥„ÉÜ„É≥„ÉÑÁü©ÂΩ¢„ÉÜ„Çπ„Éà
            </button>
            
            <!-- üéØ ÂäπÁéáÁöÑ„Éî„É≥„Ç∑„Çπ„ÉÜ„É† v2.0 „ÉÜ„Çπ„Éà„Éú„Çø„É≥ -->
            <button class="control-button primary-button" onclick="testEfficientPinSystem()" style="background: linear-gradient(135deg, #2ed573, #17a085);">
                üéØ ÂäπÁéáÁöÑ„Éî„É≥„Ç∑„Çπ„ÉÜ„É† v2.0 „ÉÜ„Çπ„Éà
            </button>
            <button class="control-button secondary-button" onclick="debugWindowResizeImpact()">
                üîç „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫ÂΩ±ÈüøË®∫Êñ≠
            </button>
            <button class="control-button secondary-button" onclick="togglePinVisibility()">
                üìç „Éî„É≥Ë°®Á§∫Âàá„ÇäÊõø„Åà
            </button>
            <button class="control-button primary-button" onclick="testAutoPinSystem()">
                üéØ AutoPin „Ç∑„Çπ„ÉÜ„É†„ÉÜ„Çπ„Éà
            </button>
            <button class="control-button secondary-button" onclick="clearLog()">
                üóëÔ∏è „É≠„Ç∞„ÇØ„É™„Ç¢
            </button>
            <button class="control-button secondary-button" onclick="clearOriginalBounds()">
                üìè ÂàùÊúüboundsÂâäÈô§
            </button>
                </div>
                
                <!-- Êìç‰ΩúÊâãÈ†Ü„Ç¨„Ç§„Éâ -->
        <div class="info-panel" style="background: #e8f4fd; border: 2px solid #0066cc;">
            <h3>üìã ÂÆüÈ®ìÊâãÈ†Ü„Ç¨„Ç§„Éâ</h3>
            <div style="display: grid; grid-template-columns: auto 1fr; gap: 15px; align-items: start;">
                <div style="background: #0066cc; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-weight: bold;">1</div>
                <div><strong>üéÆ Spine„Ç≠„É£„É©„ÇØ„Çø„ÉºË™≠„ÅøËæº„Åø</strong><br><small>„ÄåüéÆ Spine„Ç≠„É£„É©„ÇØ„Çø„ÉºË™≠„ÅøËæº„Åø„Äç„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ ‚Üí ÂÆüÈöõ„ÅÆSpine„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô</small></div>
                
                <div style="background: #0066cc; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-weight: bold;">2</div>
                <div><strong>üì¶ „Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„ÇπË°®Á§∫</strong><br><small>„Äåüì¶ Âü∫Êú¨„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ„ÉÜ„Çπ„Éà„Äç„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ ‚Üí „Ç≠„É£„É©„ÇØ„Çø„ÉºÂë®„Çä„Å´Á∑®ÈõÜÊû†„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô</small></div>
                
                <div style="background: #0066cc; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-weight: bold;">3</div>
                <div><strong>üñ±Ô∏è ‰ΩçÁΩÆ„Éª„Çµ„Ç§„Ç∫Ë™øÊï¥</strong><br><small>Êû†„Çí„Éâ„É©„ÉÉ„Ç∞„Åß‰ΩçÁΩÆË™øÊï¥„ÄÅËßí„Éè„É≥„Éâ„É´„Åß„Çµ„Ç§„Ç∫Ë™øÊï¥„Åå„Åß„Åç„Åæ„Åô</small></div>
                
                <div style="background: #0066cc; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-weight: bold;">4</div>
                <div><strong>üéØ Ëá™Âãï„Éî„É≥ÈÅ©Áî®</strong><br><small>Á∑®ÈõÜÊû†‰∏ä„ÅßÂè≥„ÇØ„É™„ÉÉ„ÇØ ‚Üí „Äå‰øùÂ≠ò„Äç„ÇíÈÅ∏Êäû ‚Üí Ëá™Âãï„Éî„É≥Ê©üËÉΩ„ÅåÊúâÂäπÂåñ„Åï„Çå„Åæ„Åô</small></div>
                
                <div style="background: #0066cc; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-weight: bold;">5</div>
                <div><strong>üìê „É™„Çµ„Ç§„Ç∫„ÉÜ„Çπ„Éà</strong><br><small>„Äåüìê „É™„Çµ„Ç§„Ç∫„ÉÜ„Çπ„Éà„Äç„Éú„Çø„É≥„Åß„Ç¶„Ç£„É≥„Éâ„Ç¶„Çµ„Ç§„Ç∫„ÇíÂ§âÊõ¥ ‚Üí Ëá™ÂãïËøΩÂæìÂãï‰Ωú„ÇíÁ¢∫Ë™ç</small></div>
            </div>
        </div>
        
        <!-- Ê©üËÉΩË™¨Êòé -->
        <div class="feature-grid">
            <div class="feature-card">
                <h3>üéØ ÈÄèÊòéËá™Âãï„Éî„É≥„Ç∑„Çπ„ÉÜ„É†</h3>
                <p>„Ç≠„É£„É©„ÇØ„Çø„Éº„Çí„ÇØ„É™„ÉÉ„ÇØ ‚Üí „Éâ„É©„ÉÉ„Ç∞Ë™øÊï¥ ‚Üí <strong>Âè≥„ÇØ„É™„ÉÉ„ÇØ ‚Üí ‰øùÂ≠ò</strong>„ÅßËá™ÂãïËøΩÂæìÊ©üËÉΩ„ÅåÊúâÂäπÂåñ„Åï„Çå„Åæ„Åô„ÄÇ</p>
                <ul>
                    <li>ËÉåÊôØË¶ÅÁ¥†„ÅÆËá™ÂãïÊ§úÂá∫</li>
                    <li>9„Ç¢„É≥„Ç´„Éº„Éù„Ç§„É≥„ÉàÊúÄÈÅ©Âåñ</li>
                    <li>ElementObserver Phase 3-BÁµ±Âêà</li>
                    <li>üÜï Âè≥„ÇØ„É™„ÉÉ„ÇØ„É°„Éã„É•„ÉºÊìç‰Ωú</li>
                    <li>üéÆ ÂÆüÈöõ„ÅÆSpine„Ç≠„É£„É©„ÇØ„Çø„ÉºÂØæÂøú</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>üîç ËÉåÊôØÊ§úÂá∫„Ç¢„É´„Ç¥„É™„Ç∫„É†</h3>
                <p>4„Å§„ÅÆÊ§úÂá∫Êà¶Áï•„ÅßÊúÄÈÅ©„Å™ËÉåÊôØË¶ÅÁ¥†„ÇíËá™ÂãïÈÅ∏ÊäûÔºö</p>
                <ol>
                    <li>ËÉåÊôØÁîªÂÉè‰ªò„ÅçË¶™Ë¶ÅÁ¥†</li>
                    <li>ËøëÊé•Â§ßÂûãÁîªÂÉèË¶ÅÁ¥†</li>
                    <li>„Çª„ÇØ„Ç∑„Éß„É≥„Ç≥„É≥„ÉÜ„Éä</li>
                    <li>„É°„Ç§„É≥„Ç≥„É≥„ÉÜ„Éä</li>
                </ol>
            </div>
            
            <div class="feature-card">
                <h3>üìç 9„Ç¢„É≥„Ç´„Éº„Éù„Ç§„É≥„Éà</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; max-width: 150px; margin: 10px 0;">
                    <div style="background: #007cff; color: white; text-align: center; padding: 8px; border-radius: 3px; font-size: 10px;">TL</div>
                    <div style="background: #007cff; color: white; text-align: center; padding: 8px; border-radius: 3px; font-size: 10px;">TC</div>
                    <div style="background: #007cff; color: white; text-align: center; padding: 8px; border-radius: 3px; font-size: 10px;">TR</div>
                    <div style="background: #007cff; color: white; text-align: center; padding: 8px; border-radius: 3px; font-size: 10px;">ML</div>
                    <div style="background: #28a745; color: white; text-align: center; padding: 8px; border-radius: 3px; font-size: 10px;">MC</div>
                    <div style="background: #007cff; color: white; text-align: center; padding: 8px; border-radius: 3px; font-size: 10px;">MR</div>
                    <div style="background: #007cff; color: white; text-align: center; padding: 8px; border-radius: 3px; font-size: 10px;">BL</div>
                    <div style="background: #007cff; color: white; text-align: center; padding: 8px; border-radius: 3px; font-size: 10px;">BC</div>
                    <div style="background: #007cff; color: white; text-align: center; padding: 8px; border-radius: 3px; font-size: 10px;">BR</div>
                </div>
                <p><small>MCÔºà‰∏≠Â§ÆÔºâ„Åå„Éá„Éï„Ç©„É´„Éà„ÄÅ‰ΩçÁΩÆ„Å´Âøú„Åò„Å¶ÊúÄÈÅ©ÈÅ∏Êäû</small></p>
            </div>
        </div>
        
        <!-- „É¢„Ç∏„É•„Éº„É´Áä∂ÊÖã -->
        <div class="info-panel">
            <h3>üìä „Ç∑„Çπ„ÉÜ„É†Áä∂ÊÖã</h3>
            <div id="module-status">
                <div class="status-line">
                    <span class="status-indicator status-warning"></span>
                    <span>„É¢„Ç∏„É•„Éº„É´„ÉÅ„Çß„ÉÉ„ÇØ‰∏≠...</span>
                </div>
            </div>
        </div>
        
                <!-- „É≠„Ç∞Ë°®Á§∫ -->
                <div class="log-container" id="log-display">
                    üéØ PureBoundingBoxAutoPin Áµ±Âêà„ÉÜ„Çπ„Éà„É≠„Ç∞ - ÂàùÊúüÂåñ‰∏≠...\n
                </div>
            </div>
            
            <!-- Âè≥ÂÅ¥Ôºö„Çµ„Ç§„Éâ„Éê„Éº -->
            <div class="right-sidebar">
                <h3>üéØ Canvas Resize Controller</h3>
                <iframe 
                    id="canvas-resize-iframe" 
                    class="canvas-resize-iframe" 
                    src="./micromodules/canvas-resize/ui.html?v=1725439200"
                    title="Canvas Resize Controller">
                </iframe>
            </div>
        </div>
    </div>

    <!-- Spine WebGL -->
    <script src="https://unpkg.com/@esotericsoftware/spine-webgl@4.1.24/dist/iife/spine-webgl.js"></script>
    
    <!-- StableSpineRenderer -->
    <script src="micromodules/spine-renderer/StableSpineRenderer.js"></script>
    
    
    <!-- ÂøÖË¶Å„Å™„É¢„Ç∏„É•„Éº„É´Ë™≠„ÅøËæº„Åø -->
    <!-- ElementObserver Phase 1 (BBÁâπÂåñÁâà) -->
    <script src="micromodules/element-observer/ElementObserverCore.js"></script>
    <script src="micromodules/element-observer/ElementObserver.js"></script>
    
    <script src="micromodules/bounding-box/PureBoundingBoxCore.js"></script>
    <script src="micromodules/bounding-box/PureBoundingBoxBounds.js"></script>
    <script src="micromodules/bounding-box/PureBoundingBoxEvents.js"></script>
    <script src="micromodules/bounding-box/PureBoundingBoxUI.js"></script>
    <!-- üéØ 2ÊÆµÈöé„Éî„É≥Ë®≠ÂÆö„Ç∑„Çπ„ÉÜ„É† -->
    <script src="micromodules/bounding-box/ElementHighlighter.js"></script>
    <script src="micromodules/bounding-box/ElementSelector.js"></script>
    <script src="micromodules/bounding-box/RelativeCoordinator.js"></script>
    <script src="micromodules/bounding-box/PureBoundingBoxAutoPin.js"></script>
    <script src="micromodules/bounding-box/PureBoundingBox.js"></script>
    
    <!-- üéØ ÂäπÁéáÁöÑ„Éî„É≥„Ç∑„Çπ„ÉÜ„É† v2.0 - 3Â±§„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£ -->
    <script src="micromodules/bounding-box/ElementCalculator.js"></script>
    <script src="micromodules/bounding-box/PinRenderer.js"></script>
    <script src="micromodules/bounding-box/EfficientObserver.js"></script>

    <script>
        // „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞
        let currentBoundingBox = null;
        let testCharacter = null;
        let logDisplay = null;
        let spineRenderer = null;
        let currentCharacterName = 'purattokun';  // „Éá„Éï„Ç©„É´„Éà„ÅØpurattokun
        
        // „É≠„Ç∞Èñ¢Êï∞
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const icon = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : 'üìù';
            const logMessage = `[${timestamp}] ${icon} ${message}\n`;
            
            if (logDisplay) {
                logDisplay.textContent += logMessage;
                logDisplay.scrollTop = logDisplay.scrollHeight;
            }
            
            console.log(`${icon} ${message}`);
        }
        
        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', async () => {
            testCharacter = document.getElementById('test-character');
            logDisplay = document.getElementById('log-display');
            
            log('üöÄ PureBoundingBoxAutoPin Áµ±Âêà„ÉÜ„Çπ„ÉàÈñãÂßã', 'info');
            
            // „É¢„Ç∏„É•„Éº„É´Á¢∫Ë™ç
            await checkModules();
            
            // CanvasResizeControllerÈÄö‰ø°Ë®≠ÂÆö
            setupCanvasResizeMessaging();
            
            // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆö
            setupEventListeners();
            
            log('‚úÖ ÂàùÊúüÂåñÂÆå‰∫Ü - „ÉÜ„Çπ„ÉàÊ∫ñÂÇôÂÆå‰∫Ü', 'success');
        });
        
        // „É¢„Ç∏„É•„Éº„É´Á¢∫Ë™ç
        async function checkModules() {
            const modules = [
                { name: 'ElementObserverCore', obj: window.ElementObserverCore },
                { name: 'ElementObserver', obj: window.ElementObserver },
                { name: 'PureBoundingBoxCore', obj: window.PureBoundingBoxCore },
                { name: 'PureBoundingBoxUI', obj: window.PureBoundingBoxUI },
                // üéØ 2ÊÆµÈöé„Éî„É≥Ë®≠ÂÆö„Ç∑„Çπ„ÉÜ„É†
                { name: 'ElementHighlighter', obj: window.ElementHighlighter },
                { name: 'ElementSelector', obj: window.ElementSelector },
                { name: 'RelativeCoordinator', obj: window.RelativeCoordinator },
                { name: 'PureBoundingBoxAutoPin', obj: window.PureBoundingBoxAutoPin },
                { name: 'PureBoundingBox', obj: window.PureBoundingBox },
                { name: 'StableSpineRenderer', obj: window.StableSpineRenderer }
            ];
            
            let allLoaded = true;
            let statusHtml = '';
            
            for (const module of modules) {
                const loaded = typeof module.obj === 'function';
                const statusClass = loaded ? 'status-success' : 'status-danger';
                const statusText = loaded ? 'Ë™≠„ÅøËæº„ÅøÊ∏à„Åø' : 'Ë™≠„ÅøËæº„ÅøÂ§±Êïó';
                
                statusHtml += `
                    <div class="status-line">
                        <span class="status-indicator ${statusClass}"></span>
                        <span>${module.name}: ${statusText}</span>
                    </div>
                `;
                
                if (!loaded) {
                    allLoaded = false;
                    log(`‚ùå ${module.name} „É¢„Ç∏„É•„Éº„É´„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì`, 'error');
                } else {
                    log(`‚úÖ ${module.name} „É¢„Ç∏„É•„Éº„É´Ë™≠„ÅøËæº„ÅøÊàêÂäü`, 'success');
                }
            }
            
            document.getElementById('module-status').innerHTML = statusHtml;
            
            if (allLoaded) {
                log('üéâ ÂÖ®„É¢„Ç∏„É•„Éº„É´Ë™≠„ÅøËæº„ÅøÊàêÂäü', 'success');
            } else {
                log('‚ö†Ô∏è ‰∏ÄÈÉ®„É¢„Ç∏„É•„Éº„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', 'warning');
            }
        }
        
        // CanvasResizeController postMessageÈÄö‰ø°Ë®≠ÂÆö
        function setupCanvasResizeMessaging() {
            window.addEventListener('message', (event) => {
                // „Çª„Ç≠„É•„É™„ÉÜ„Ç£„ÉÅ„Çß„ÉÉ„ÇØÔºàÂêå„Åò„Ç™„É™„Ç∏„É≥„ÅÆ„ÅøÔºâ
                if (event.origin !== window.location.origin) {
                    return;
                }
                
                const { type, data } = event.data;
                
                switch (type) {
                    case 'canvasResize':
                        log(`üìê CanvasËß£ÂÉèÂ∫¶Â§âÊõ¥: ${data.size}px`, 'info');
                        if (spineRenderer && spineRenderer.canvas) {
                            spineRenderer.canvas.width = data.size;
                            spineRenderer.canvas.height = data.size;
                            spineRenderer.resize(data.size, data.size);
                            log('‚úÖ CanvasËß£ÂÉèÂ∫¶Â§âÊõ¥ÂÆå‰∫Ü', 'success');
                        }
                        break;
                        
                    case 'scaleChanged':
                        log(`üìè „Çπ„Ç±„Éº„É´Â§âÊõ¥: X${data.scaleX}, Y${data.scaleY}`, 'info');
                        if (spineRenderer && spineRenderer.skeleton) {
                            spineRenderer.skeleton.scaleX = data.scaleX;
                            spineRenderer.skeleton.scaleY = data.scaleY;
                            log('‚úÖ „Çπ„Ç±„Éº„É´Â§âÊõ¥ÂÆå‰∫Ü', 'success');
                        }
                        break;
                        
                    case 'positionChanged':
                        log(`üìç ‰ΩçÁΩÆÂ§âÊõ¥: X${data.x}, Y${data.y}`, 'info');
                        if (spineRenderer && spineRenderer.skeleton) {
                            spineRenderer.skeleton.x = data.x;
                            spineRenderer.skeleton.y = data.y;
                            log('‚úÖ ‰ΩçÁΩÆÂ§âÊõ¥ÂÆå‰∫Ü', 'success');
                        }
                        break;
                        
                    case 'uiReady':
                        log('üéõÔ∏è CanvasResizeController UIÂàùÊúüÂåñÂÆå‰∫Ü', 'success');
                        // ÁèæÂú®„ÅÆÁä∂ÊÖã„Çíiframe„Å´ÈÄÅ‰ø°
                        sendToCanvasResizeUI('updateUIState', {
                            canvasSize: spineRenderer ? Math.max(spineRenderer.canvas.width, spineRenderer.canvas.height) : 400,
                            scaleX: spineRenderer ? spineRenderer.skeleton.scaleX : 1.0,
                            scaleY: spineRenderer ? spineRenderer.skeleton.scaleY : 1.0,
                            positionX: spineRenderer ? spineRenderer.skeleton.x : 0,
                            positionY: spineRenderer ? spineRenderer.skeleton.y : 0
                        });
                        break;
                        
                    case 'uiLog':
                        log(`[CanvasResizeUI] ${data.message}`, 'info');
                        break;
                        
                    default:
                        // Êú™ÂØæÂøú„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏„Çø„Ç§„Éó
                        break;
                }
            });
            
            log('üì° CanvasResizeController postMessageÈÄö‰ø°Ë®≠ÂÆöÂÆå‰∫Ü', 'success');
        }
        
        // CanvasResizeController UI„Å´„É°„ÉÉ„Çª„Éº„Ç∏ÈÄÅ‰ø°
        function sendToCanvasResizeUI(type, data) {
            const iframe = document.getElementById('canvas-resize-iframe');
            if (iframe && iframe.contentWindow) {
                iframe.contentWindow.postMessage({ type, data }, window.location.origin);
            }
        }

        // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆöÔºàÂÖ±ÈÄöÈñ¢Êï∞Ôºâ
        function setupCharacterClickListener(element) {
            if (!element) {
                log('‚ùå Ë¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì - „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆö„Çπ„Ç≠„ÉÉ„Éó', 'error');
                return;
            }
            
            log(`üîß „ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆö: ${element.id || element.tagName}`, 'info');
            
            // Êó¢Â≠ò„ÅÆ„É™„Çπ„Éä„Éº„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØÂâäÈô§„Åó„Å¶„Åã„ÇâËøΩÂä†ÔºàÈáçË§áÈò≤Ê≠¢Ôºâ
            element.removeEventListener('click', characterClickHandler);
            element.addEventListener('click', characterClickHandler);
        }
        
        // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÇØ„É™„ÉÉ„ÇØ„Éè„É≥„Éâ„É©„ÉºÔºàÂÖ±ÈÄöÈñ¢Êï∞Ôºâ
        function characterClickHandler(e) {
            log(`üñ±Ô∏è „Ç≠„É£„É©„ÇØ„Çø„Éº„ÇØ„É™„ÉÉ„ÇØÊ§úÂá∫: ${e.target.tagName} (${e.target.id || 'IDÁÑ°„Åó'})`, 'info');
            e.stopPropagation();
            testBasicBoundingBox();
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆöÔºà„Éû„Éã„É•„Ç¢„É´Ê∫ñÊã†ÁâàÔºâ
        function setupEventListeners() {
            // Spine„Ç≠„É£„É©„ÇØ„Çø„ÉºË™≠„ÅøËæº„ÅøÂæå„Å´testCharacter„ÅåË®≠ÂÆö„Åï„Çå„Çã„Åü„ÇÅ„ÄÅ
            // ÂàùÊúüÂåñÊôÇ„ÅØÂü∫Êú¨ÁöÑ„Å™„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅÆ„ÅøË®≠ÂÆö
            log('‚ö†Ô∏è testCharacter„ÅØSpineË™≠„ÅøËæº„ÅøÂæå„Å´Ë®≠ÂÆö„Åï„Çå„Åæ„Åô', 'info');
            log('üí° „Äåüì• SpineË™≠„ÅøËæº„Åø„Äç„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Spine„Ç≠„É£„É©„ÇØ„Çø„Éº„ÇíË™≠„ÅøËæº„Çì„Åß„Åè„Å†„Åï„ÅÑ', 'info');
            
            // ‰øùÂ≠òÂÆå‰∫Ü„Ç§„Éô„É≥„Éà„ÅÆÁõ£Ë¶ñ
            document.addEventListener('boundingBoxSaveCompleted', (event) => {
                const data = event.detail;
                log('üíæ „Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ‰øùÂ≠òÂÆå‰∫Ü„Ç§„Éô„É≥„ÉàÂèó‰ø°', 'success');
                
                if (data.autoPinResult && data.autoPinResult.success) {
                    log(`üìç Ëá™Âãï„Éî„É≥ÈÅ©Áî®ÊàêÂäü: „Ç¢„É≥„Ç´„Éº${data.autoPinResult.pinConfig.anchor}`, 'success');
                } else {
                    log('üìù Âü∫Êú¨‰øùÂ≠ò„ÅÆ„ÅøÔºàËá™Âãï„Éî„É≥„Å™„ÅóÔºâ', 'info');
                }
            });
            
            // „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫„ÉÜ„Çπ„ÉàÁî® + BBÊØîÁéá‰øùÊåÅÊ©üËÉΩ
            let resizeTimeout;
            
            // 1. „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫Áõ£Ë¶ñ
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    log('üìê „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫Ê§úÂá∫ - Ëá™ÂãïËøΩÂæì„ÉÜ„Çπ„Éà', 'info');
                    // üéØ BBÊØîÁéá‰øùÊåÅÊ©üËÉΩ: Á∑®ÈõÜ„Çµ„Ç§„Ç∫„ÇíÁ∂≠ÊåÅ
                    maintainBBRatioAfterResize();
                }, 100);
            });
            
            // 2. heroSection„Çµ„Ç§„Ç∫Â§âÊõ¥Áõ£Ë¶ñÔºàResizeObserverÔºâ
            const heroSection = document.getElementById('test-hero');
            if (heroSection) {
                log('üîç ResizeObserver ÂàùÊúüÂåñÈñãÂßã', 'info');
                const resizeObserver = new ResizeObserver(entries => {
                    log(`üîç ResizeObserver „Éà„É™„Ç¨„Éº: ${entries.length} „Ç®„É≥„Éà„É™„Éº`, 'info');
                    for (const entry of entries) {
                        const { width, height } = entry.contentRect;
                        log(`üìê „Éí„Éº„É≠„Éº„Çª„ÇØ„Ç∑„Éß„É≥„Çµ„Ç§„Ç∫Â§âÊõ¥Ê§úÂá∫: ${width.toFixed(0)}x${height.toFixed(0)}`, 'info');
                        
                        clearTimeout(resizeTimeout);
                        resizeTimeout = setTimeout(() => {
                            log('üìê „Éí„Éº„É≠„Éº„Çª„ÇØ„Ç∑„Éß„É≥„É™„Çµ„Ç§„Ç∫Ê§úÂá∫ - BBÊØîÁéá‰øùÊåÅÂÆüË°å', 'info');
                            // üéØ BBÊØîÁéá‰øùÊåÅÊ©üËÉΩ: Á∑®ÈõÜ„Çµ„Ç§„Ç∫„ÇíÁ∂≠ÊåÅ
                            maintainBBRatioAfterResize();
                        }, 100);
                    }
                });
                
                resizeObserver.observe(heroSection);
                log('‚úÖ ResizeObserverÁõ£Ë¶ñÈñãÂßã', 'success');
            } else {
                log('‚ùå „Éí„Éº„É≠„Éº„Çª„ÇØ„Ç∑„Éß„É≥Ë¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
            }
        }
        
        // BBÊØîÁéá‰øùÊåÅÊ©üËÉΩ: „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫Âæå„Å´Á∑®ÈõÜ„Çµ„Ç§„Ç∫„ÇíÁ∂≠ÊåÅ
        function maintainBBRatioAfterResize() {
            log('üîÑ BBÊØîÁéá‰øùÊåÅÂá¶ÁêÜÈñãÂßã', 'info');
            
            const storageKey = 'bb-position-test-character';
            const savedPosition = localStorage.getItem(storageKey);
            
            if (savedPosition) {
                try {
                    const positionData = JSON.parse(savedPosition);
                    log(`üìä ‰øùÂ≠ò„Éá„Éº„ÇøÁ¢∫Ë™çÂÆå‰∫Ü`, 'info');
                    
                    // Á∑®ÈõÜÊôÇ„ÅÆÂÆü„Çµ„Ç§„Ç∫ÊÉÖÂ†±„Åå„ÅÇ„Çã„ÅãÁ¢∫Ë™ç
                    if (positionData.actualSize && positionData.actualSize.widthPx && positionData.actualSize.heightPx) {
                        const heroSection = document.getElementById('test-hero');
                        if (!heroSection) {
                            log('‚ùå „Éí„Éº„É≠„Éº„Çª„ÇØ„Ç∑„Éß„É≥„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
                            return;
                        }
                        
                        const parentRect = heroSection.getBoundingClientRect();
                        log(`üìê ÁèæÂú®„ÅÆË¶™Ë¶ÅÁ¥†„Çµ„Ç§„Ç∫: ${parentRect.width.toFixed(0)}√ó${parentRect.height.toFixed(0)}px`, 'info');
                        
                        // üÜï Âº∑Âåñ„Åï„Çå„ÅüÊØîÁéá‰øùÊåÅ: ÂÆüÊØîÁéá„Éá„Éº„Çø„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØÂÑ™ÂÖà‰ΩøÁî®
                        let widthPct, heightPct;
                        
                        if (positionData.actualSize.actualWidthRatio && positionData.actualSize.actualHeightRatio) {
                            // Êñ∞„Ç∑„Çπ„ÉÜ„É†: Á≤æÂØÜ„Å™ÂÆüÊØîÁéá„Éá„Éº„Çø„Çí‰ΩøÁî®
                            widthPct = positionData.actualSize.actualWidthRatio * 100;
                            heightPct = positionData.actualSize.actualHeightRatio * 100;
                            log('‚ú® Êñ∞„Ç∑„Çπ„ÉÜ„É†: Á≤æÂØÜÂÆüÊØîÁéá„Éá„Éº„Çø‰ΩøÁî®', 'info');
                        } else {
                            // ÂæìÊù•„Ç∑„Çπ„ÉÜ„É†: „Éî„ÇØ„Çª„É´„Çµ„Ç§„Ç∫„Åã„ÇâË®àÁÆó
                            widthPct = (positionData.actualSize.widthPx / parentRect.width) * 100;
                            heightPct = (positionData.actualSize.heightPx / parentRect.height) * 100;
                            log('üìä ÂæìÊù•„Ç∑„Çπ„ÉÜ„É†: „Éî„ÇØ„Çª„É´„Çµ„Ç§„Ç∫Ë®àÁÆó', 'info');
                        }
                        
                        // testCharacterË¶ÅÁ¥†„ÇíÂèñÂæóÔºàCanvasË¶ÅÁ¥†„ÇÇÂØæÂøúÔºâ
                        let targetCharacter = testCharacter;
                        if (!targetCharacter) {
                            // CanvasË¶ÅÁ¥†„ÇíÁõ¥Êé•Ê§úÁ¥¢
                            targetCharacter = document.getElementById('spine-canvas');
                        }
                        
                        if (!targetCharacter) {
                            log('‚ùå „ÉÜ„Çπ„Éà„Ç≠„É£„É©„ÇØ„Çø„ÉºË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
                            return;
                        }
                        
                        // ‰ΩçÁΩÆ„ÅØÁèæÂú®„ÅÆ„Éë„Éº„Çª„É≥„ÉÜ„Éº„Ç∏„ÇíÁ∂≠ÊåÅ„ÄÅ„Çµ„Ç§„Ç∫„ÅÆ„ÅøÂÜçË®àÁÆó
                        const oldWidth = targetCharacter.style.width;
                        const oldHeight = targetCharacter.style.height;
                        
                        targetCharacter.style.width = widthPct.toFixed(2) + '%';
                        targetCharacter.style.height = heightPct.toFixed(2) + '%';
                        
                        log(`üîß BBÊØîÁéá‰øùÊåÅ: Á∑®ÈõÜ„Çµ„Ç§„Ç∫ ${positionData.actualSize.widthPx}√ó${positionData.actualSize.heightPx}px`, 'info');
                        log(`üìè „Çµ„Ç§„Ç∫Â§âÊõ¥: ${oldWidth} ‚Üí ${widthPct.toFixed(2)}%, ${oldHeight} ‚Üí ${heightPct.toFixed(2)}%`, 'success');
                        
                        // localStorage„ÅÆÁèæÂú®ÂÄ§„ÇÇÊõ¥Êñ∞
                        positionData.position.width = widthPct.toFixed(2) + '%';
                        positionData.position.height = heightPct.toFixed(2) + '%';
                        localStorage.setItem(storageKey, JSON.stringify(positionData));
                        
                        log('‚úÖ BBÊØîÁéá‰øùÊåÅÂÆå‰∫Ü', 'success');
                    } else {
                        log('‚ö†Ô∏è ÂÆü„Çµ„Ç§„Ç∫ÊÉÖÂ†±„Å™„Åó - BBÊØîÁéá‰øùÊåÅ„Çπ„Ç≠„ÉÉ„Éó', 'warning');
                        log('üí° „Éí„É≥„Éà: BBÁ∑®ÈõÜ„Çí‰∏ÄÂ∫¶ÂÆüË°å„Åô„Çã„Å®ÂÆü„Çµ„Ç§„Ç∫ÊÉÖÂ†±„Åå‰øùÂ≠ò„Åï„Çå„Åæ„Åô', 'info');
                    }
                } catch (error) {
                    log(`‚ùå BBÊØîÁéá‰øùÊåÅ„Ç®„É©„Éº: ${error.message}`, 'error');
                    console.error('BBÊØîÁéá‰øùÊåÅË©≥Á¥∞„Ç®„É©„Éº:', error);
                }
            } else {
                log('üìù ‰øùÂ≠ò„Åï„Çå„Åü‰ΩçÁΩÆÊÉÖÂ†±„Å™„Åó - BBÊØîÁéá‰øùÊåÅ„Çí„Çπ„Ç≠„ÉÉ„Éó', 'warning');
            }
        }
        
        // ‰øùÂ≠ò„Åï„Çå„Åü‰ΩçÁΩÆ„ÇíÂæ©ÂÖÉ
        function restoreSavedPosition() {
            const storageKey = 'bb-position-test-character';
            const savedPosition = localStorage.getItem(storageKey);
            
            if (savedPosition) {
                try {
                    const positionData = JSON.parse(savedPosition);
                    const position = positionData.position;
                    
                    if (position && position.left && position.top) {
                        // ‰ΩçÁΩÆ„ÅÆ„ÅøÂæ©ÂÖÉÔºà„Çµ„Ç§„Ç∫„ÅØÁúü„ÅÆÂàùÊúü„Çµ„Ç§„Ç∫„Åã„ÇâÂÜçË®àÁÆóÔºâ
                        testCharacter.style.left = position.left;
                        testCharacter.style.top = position.top;
                        
                        // „Çµ„Ç§„Ç∫„ÅØÁ∑®ÈõÜÊôÇ„ÅÆÂÆü„Çµ„Ç§„Ç∫Âü∫Ê∫ñ„ÅßÂÜçË®àÁÆó
                        if (positionData.actualSize && positionData.actualSize.widthPx && positionData.actualSize.heightPx) {
                            // Á∑®ÈõÜÊôÇ„ÅÆÂÆü„Çµ„Ç§„Ç∫„Åã„ÇâÁèæÂú®„ÅÆÁí∞Â¢É„Åß„ÅÆ„Éë„Éº„Çª„É≥„ÉÜ„Éº„Ç∏„ÇíÂÜçË®àÁÆó
                            const heroSection = document.getElementById('test-hero');
                            const parentRect = heroSection.getBoundingClientRect();
                            
                            const widthPct = (positionData.actualSize.widthPx / parentRect.width) * 100;
                            const heightPct = (positionData.actualSize.heightPx / parentRect.height) * 100;
                            
                            testCharacter.style.width = widthPct.toFixed(2) + '%';
                            testCharacter.style.height = heightPct.toFixed(2) + '%';
                            
                            log(`üîÑ ‰øùÂ≠ò‰ΩçÁΩÆ„ÇíÂæ©ÂÖÉ: ${position.left}, ${position.top} | ${widthPct.toFixed(2)}% √ó ${heightPct.toFixed(2)}% (ÂÆü„Çµ„Ç§„Ç∫Âü∫Ê∫ñ)`, 'success');
                        } else {
                            // fallback: ‰øùÂ≠ò„Åï„Çå„Åü„Éë„Éº„Çª„É≥„ÉÜ„Éº„Ç∏ÂÄ§„Çí‰ΩøÁî®
                            if (position.width && position.height) {
                                testCharacter.style.width = position.width;
                                testCharacter.style.height = position.height;
                                log(`üîÑ ‰øùÂ≠ò‰ΩçÁΩÆ„ÇíÂæ©ÂÖÉ: ${position.left}, ${position.top} | ${position.width} √ó ${position.height} (‰øùÂ≠òÂÄ§)`, 'success');
                            }
                        }
                    } else {
                        log('‚ö†Ô∏è ‰øùÂ≠ò„Åï„Çå„Åü‰ΩçÁΩÆ„Éá„Éº„Çø„Åå‰∏çÂÆåÂÖ®„Åß„Åô', 'warning');
                    }
                } catch (error) {
                    log(`‚ùå ‰ΩçÁΩÆÂæ©ÂÖÉ„Ç®„É©„Éº: ${error.message}`, 'error');
                }
            } else {
                log('üìç ‰øùÂ≠ò„Åï„Çå„Åü‰ΩçÁΩÆ„Åå„ÅÇ„Çä„Åæ„Åõ„ÇìÔºàÂàùÂõûËµ∑ÂãïÔºâ', 'info');
            }
        }
        
        // Âü∫Êú¨„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ„ÉÜ„Çπ„Éà
        async function testBasicBoundingBox() {
            try {
                log('üì¶ Âü∫Êú¨„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ„ÉÜ„Çπ„ÉàÈñãÂßã', 'info');
                
                // „Éá„Éê„ÉÉ„Ç∞: PureBoundingBox„ÇØ„É©„ÇπÂ≠òÂú®Á¢∫Ë™ç
                if (typeof PureBoundingBox === 'undefined') {
                    log('‚ùå PureBoundingBox„ÇØ„É©„Çπ„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì', 'error');
                    return;
                }
                
                // „Éá„Éê„ÉÉ„Ç∞: testCharacterÂ≠òÂú®Á¢∫Ë™ç
                if (!testCharacter) {
                    log('‚ùå testCharacterË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
                    return;
                }
                
                log(`üéØ ÂØæË±°Ë¶ÅÁ¥†: ${testCharacter.id} (${testCharacter.tagName})`, 'info');
                
                // Êó¢Â≠ò„ÅÆ„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ„Çí„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
                if (currentBoundingBox) {
                    log('üßπ Êó¢Â≠òBB„Çí„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó‰∏≠...', 'info');
                    currentBoundingBox.cleanup();
                    currentBoundingBox = null;
                }
                
                // ‰øùÂ≠ò„Åï„Çå„Åü‰ΩçÁΩÆ„ÇíÂæ©ÂÖÉ
                restoreSavedPosition();
                
                // Êñ∞„Åó„ÅÑ„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ‰ΩúÊàê
                log('üîß Êñ∞„Åó„ÅÑBB„Çí‰ΩúÊàê‰∏≠...', 'info');
                currentBoundingBox = new PureBoundingBox({
                    targetElement: testCharacter,
                    nodeId: 'test-character'
                });
                
                log('‚úÖ PureBoundingBox „Ç§„É≥„Çπ„Çø„É≥„Çπ‰ΩúÊàêÂÆå‰∫Ü', 'success');
                
                // ÂÆüË°å
                const result = await currentBoundingBox.execute();
                
                if (result.success) {
                    log('‚úÖ „Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ‰ΩúÊàêÊàêÂäü', 'success');
                    log(`üìä ÂàùÊúübounds: ${JSON.stringify(result.bounds)}`, 'info');
                } else {
                    log(`‚ùå „Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ‰ΩúÊàêÂ§±Êïó: ${result.error}`, 'error');
                }
                
            } catch (error) {
                log(`‚ùå „ÉÜ„Çπ„ÉàÂÆüË°å„Ç®„É©„Éº: ${error.message}`, 'error');
                console.error('„ÉÜ„Çπ„Éà„Ç®„É©„Éº:', error);
            }
        }
        
        // Âè≥„ÇØ„É™„ÉÉ„ÇØ„É°„Éã„É•„Éº„ÉÜ„Çπ„Éà
        async function testRightClickMenu() {
            try {
                log('üñ±Ô∏è Âè≥„ÇØ„É™„ÉÉ„ÇØ„É°„Éã„É•„Éº„ÉÜ„Çπ„ÉàÈñãÂßã', 'info');
                
                if (!currentBoundingBox) {
                    log('‚ö†Ô∏è ÂÖà„Å´„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ„ÉÜ„Çπ„Éà„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'warning');
                    return;
                }
                
                log('üìã Âè≥„ÇØ„É™„ÉÉ„ÇØ„É°„Éã„É•„Éº„ÅÆ‰ΩøÁî®ÊñπÊ≥ï:', 'info');
                log('1. „Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ‰∏ä„ÅßÂè≥„ÇØ„É™„ÉÉ„ÇØ', 'info');
                log('2. „É°„Éã„É•„Éº„Åã„ÇâÊìç‰Ωú„ÇíÈÅ∏Êäû', 'info');
                log('3. „Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà„ÇÇÂà©Áî®ÂèØËÉΩ:', 'info');
                log('   - Enter: ‰øùÂ≠òÔºàËá™Âãï„Éî„É≥ÈÅ©Áî®Ôºâ', 'info');
                log('   - Escape: „Ç≠„É£„É≥„Çª„É´', 'info');
                log('   - Ctrl+S: ‰øùÂ≠ò', 'info');
                
                // UIÁä∂ÊÖãÁ¢∫Ë™ç
                if (currentBoundingBox.ui) {
                    log('‚úÖ Âè≥„ÇØ„É™„ÉÉ„ÇØ„É°„Éã„É•„Éº„Ç∑„Çπ„ÉÜ„É†Âà©Áî®ÂèØËÉΩ', 'success');
                    
                    if (currentBoundingBox.ui.autoPin) {
                        const state = currentBoundingBox.ui.autoPin.getState();
                        log(`üìä AutoPinÁä∂ÊÖã: „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Éî„É≥${state.activePinsCount}ÂÄã`, 'info');
                    }
                } else {
                    log('‚ùå UI„Ç∑„Çπ„ÉÜ„É†„ÅåÂà©Áî®„Åß„Åç„Åæ„Åõ„Çì', 'error');
                }
                
            } catch (error) {
                log(`‚ùå Âè≥„ÇØ„É™„ÉÉ„ÇØ„É°„Éã„É•„Éº„ÉÜ„Çπ„Éà„Ç®„É©„Éº: ${error.message}`, 'error');
                console.error('Âè≥„ÇØ„É™„ÉÉ„ÇØ„É°„Éã„É•„Éº„ÉÜ„Çπ„Éà„Ç®„É©„Éº:', error);
            }
        }
        
        // „É™„Çµ„Ç§„Ç∫„ÉÜ„Çπ„Éà
        // üéØ ‰øÆÈ£æ„Ç≠„Éº„ÉÜ„Çπ„ÉàÊ©üËÉΩ
        function testModifierKeys() {
            log('üéÆ ‰øÆÈ£æ„Ç≠„Éº„ÉÜ„Çπ„ÉàÈñãÂßã', 'info');
            
            const testCharacter = document.getElementById('test-character');
            if (!testCharacter) {
                log('‚ùå „ÉÜ„Çπ„Éà„Ç≠„É£„É©„ÇØ„Çø„Éº„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
                return;
            }
            
            log('üìã ‰øÆÈ£æ„Ç≠„Éº„ÉÜ„Çπ„ÉàË™¨Êòé:', 'info');
            log('1. „Ç≠„É£„É©„ÇØ„Çø„Éº„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶BBË°®Á§∫', 'info');
            log('2. ÂêÑ‰øÆÈ£æ„Ç≠„Éº„ÇíË©¶„Åó„Å¶„Åè„Å†„Åï„ÅÑ:', 'info');
            log('   - Shift: Á∏¶Ê®™ÊØî‰øùÊåÅ', 'info');
            log('   - Alt: ‰∏≠ÂøÉÂõ∫ÂÆö„É™„Çµ„Ç§„Ç∫', 'info');
            log('   - Ctrl: „Ç∞„É™„ÉÉ„Éâ„Çπ„Éä„ÉÉ„Éó(10px)', 'info');
            log('   - ‰ΩµÁî®: Shift+Alt, Shift+Ctrl, Alt+Ctrl, Shift+Alt+Ctrl', 'info');
            log('3. „Éè„É≥„Éâ„É´„Çí„Éâ„É©„ÉÉ„Ç∞„Åó„Å¶Âãï‰ΩúÁ¢∫Ë™ç', 'success');
        }

        // BB„Ç∑„Çπ„ÉÜ„É†Ë®∫Êñ≠Èñ¢Êï∞ÔºàÂº∑ÂåñÁâàÔºâ
        function debugBBSystem() {
            log('üîç BB„Ç∑„Çπ„ÉÜ„É†Ë©≥Á¥∞Ë®∫Êñ≠ÈñãÂßã', 'info');
            
            // 1. ÂøÖÈ†à„ÇØ„É©„ÇπÁ¢∫Ë™ç
            const classes = ['PureBoundingBox', 'ElementObserver'];
            classes.forEach(className => {
                if (typeof window[className] !== 'undefined') {
                    log(`‚úÖ ${className}: Ë™≠„ÅøËæº„ÅøÊ∏à„Åø`, 'success');
                } else {
                    log(`‚ùå ${className}: Ë™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì`, 'error');
                }
            });
            
            // 2. „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞Áä∂ÊÖãÁ¢∫Ë™ç
            log('üîç „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞Áä∂ÊÖã:', 'info');
            log(`testCharacter: ${testCharacter ? (testCharacter.id || testCharacter.tagName) : 'null'}`, 'info');
            log(`currentBoundingBox: ${currentBoundingBox ? 'Â≠òÂú®' : 'null'}`, 'info');
            log(`spineRenderer: ${spineRenderer ? 'Â≠òÂú®' : 'null'}`, 'info');
            
            // 3. DOMË¶ÅÁ¥†„ÅÆË©≥Á¥∞Á¢∫Ë™ç
            const testChar = document.getElementById('test-character');
            const allCanvases = document.querySelectorAll('canvas');
            const spineCanvas = document.querySelector('canvas[id*="spine"]');
            
            log('üîç DOMË¶ÅÁ¥†Áä∂Ê≥Å:', 'info');
            log(`ÂÖ®CanvasË¶ÅÁ¥†Êï∞: ${allCanvases.length}`, 'info');
            allCanvases.forEach((canvas, index) => {
                const isVisible = canvas.style.display !== 'none' && canvas.offsetWidth > 0;
                log(`  Canvas ${index + 1}: ${canvas.id || 'IDÁÑ°„Åó'} - ${isVisible ? 'Ë°®Á§∫' : 'ÈùûË°®Á§∫'}`, 'info');
                log(`    „Çµ„Ç§„Ç∫: ${canvas.width}√ó${canvas.height}px (CSS: ${canvas.style.width || 'auto'}√ó${canvas.style.height || 'auto'})`, 'info');
            });
            
            if (testChar) {
                const isVisible = testChar.style.display !== 'none' && testChar.offsetWidth > 0;
                log(`test-character: ${isVisible ? '‚úÖ Ë°®Á§∫‰∏≠' : '‚ö†Ô∏è ÈùûË°®Á§∫'}`, isVisible ? 'success' : 'warning');
                log(`  ‰ΩçÁΩÆ: ${testChar.style.left || 'auto'}, ${testChar.style.top || 'auto'}`, 'info');
                log(`  „Çµ„Ç§„Ç∫: ${testChar.style.width || 'auto'} √ó ${testChar.style.height || 'auto'}`, 'info');
                
                // testCharacter„Å®„Ç∞„É≠„Éº„Éê„É´Â§âÊï∞„ÅÆ‰∏ÄËá¥Á¢∫Ë™ç
                if (testCharacter === testChar) {
                    log('‚úÖ „Ç∞„É≠„Éº„Éê„É´testCharacter: DOMË¶ÅÁ¥†„Å®‰∏ÄËá¥', 'success');
                } else {
                    log('‚ö†Ô∏è „Ç∞„É≠„Éº„Éê„É´testCharacter: DOMË¶ÅÁ¥†„Å®‰∏ç‰∏ÄËá¥', 'warning');
                }
            } else {
                log('‚ùå test-characterË¶ÅÁ¥†: Ë¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
            }
            
            // 4. „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË©≥Á¥∞Á¢∫Ë™ç
            log('üîç „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºÁ¢∫Ë™ç:', 'info');
            if (testCharacter) {
                // „ÉÜ„Çπ„Éà„ÇØ„É™„ÉÉ„ÇØÂÆüË°å
                log('üß™ „ÉÜ„Çπ„Éà„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„ÉàÁô∫ÁÅ´...', 'info');
                try {
                    const clickEvent = new Event('click', { bubbles: true });
                    testCharacter.dispatchEvent(clickEvent);
                    log('‚úÖ „ÉÜ„Çπ„Éà„ÇØ„É™„ÉÉ„ÇØÊàêÂäü', 'success');
                } catch (error) {
                    log(`‚ùå „ÉÜ„Çπ„Éà„ÇØ„É™„ÉÉ„ÇØ„Ç®„É©„Éº: ${error.message}`, 'error');
                }
            } else {
                log('‚ö†Ô∏è testCharacter„ÅåÊú™Ë®≠ÂÆö„ÅÆ„Åü„ÇÅ„ÉÜ„Çπ„Éà„ÇØ„É™„ÉÉ„ÇØ‰∏çÂèØ', 'warning');
            }
            
            // 5. ÊâãÂãï„ÅßBB‰ΩúÊàê„ÉÜ„Çπ„Éà
            log('üß™ ÊâãÂãïBB„ÉÜ„Çπ„ÉàÂÆüË°å...', 'info');
            try {
                testBasicBoundingBox();
                log('‚úÖ ÊâãÂãïBB„ÉÜ„Çπ„ÉàÂÆüË°åÂÆå‰∫Ü', 'success');
            } catch (error) {
                log(`‚ùå ÊâãÂãïBB„ÉÜ„Çπ„Éà„Ç®„É©„Éº: ${error.message}`, 'error');
            }
        }
        
        // üéØ AutoPin„Ç∑„Çπ„ÉÜ„É†Á∑èÂêà„ÉÜ„Çπ„Éà
        async function testAutoPinSystem() {
            try {
                log('üéØ AutoPin „Ç∑„Çπ„ÉÜ„É†Á∑èÂêà„ÉÜ„Çπ„ÉàÈñãÂßã', 'info');
                
                // 1. ÂâçÊèêÊù°‰ª∂Á¢∫Ë™ç
                if (!testCharacter) {
                    log('‚ùå testCharacterÊú™Ë®≠ÂÆö - ÂÖà„Å´Spine„Ç≠„É£„É©„ÇØ„Çø„Éº„ÇíË™≠„ÅøËæº„Çì„Åß„Åè„Å†„Åï„ÅÑ', 'error');
                    return;
                }
                
                if (!currentBoundingBox) {
                    log('üì¶ „Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ„Çí‰ΩúÊàê‰∏≠...', 'info');
                    await testBasicBoundingBox();
                }
                
                if (!currentBoundingBox || !currentBoundingBox.autoPin) {
                    log('‚ùå AutoPinÊ©üËÉΩ„ÅåÂà©Áî®„Åß„Åç„Åæ„Åõ„Çì', 'error');
                    return;
                }
                
                // 2. AutoPin„Ç∑„Çπ„ÉÜ„É†Áä∂ÊÖãÁ¢∫Ë™ç
                log('üîç AutoPin „Ç∑„Çπ„ÉÜ„É†Áä∂ÊÖãÁ¢∫Ë™ç:', 'info');
                const autoPinState = currentBoundingBox.autoPin.getState();
                log(`„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Éî„É≥Êï∞: ${autoPinState.activePinsCount}`, 'info');
                log(`„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÁµ±Ë®à: ÊàêÂäü${autoPinState.performanceMetrics.successCount}‰ª∂, Â§±Êïó${autoPinState.performanceMetrics.failureCount}‰ª∂`, 'info');
                
                // üîç ElementObserverÁµ±ÂêàÁä∂ÊÖã„ÅÆË©≥Á¥∞Ë®∫Êñ≠
                log('üîç ElementObserverÁµ±ÂêàË®∫Êñ≠:', 'info');
                const observer = currentBoundingBox.autoPin.observer;
                if (observer) {
                    log(`‚úÖ ElementObserver „Ç§„É≥„Çπ„Çø„É≥„Çπ: Â≠òÂú®`, 'success');
                    log(`üìã observe „É°„ÇΩ„ÉÉ„Éâ: ${typeof observer.observe}`, 'info');
                    log(`üìã ElementObserver „ÇØ„É©„Çπ: ${observer.constructor.name}`, 'info');
                    
                    // observe„É°„ÇΩ„ÉÉ„Éâ„ÅåÈñ¢Êï∞„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                    if (typeof observer.observe === 'function') {
                        log('‚úÖ observe „É°„ÇΩ„ÉÉ„Éâ: Âà©Áî®ÂèØËÉΩ', 'success');
                    } else {
                        log('‚ùå observe „É°„ÇΩ„ÉÉ„Éâ: Âà©Áî®‰∏çÂèØ', 'error');
                    }
                } else {
                    log('‚ùå ElementObserver „Ç§„É≥„Çπ„Çø„É≥„Çπ: null', 'error');
                }
                
                // „Ç∞„É≠„Éº„Éê„É´ElementObserver„ÇØ„É©„Çπ„ÅÆÁ¢∫Ë™ç
                log('üîç „Ç∞„É≠„Éº„Éê„É´ElementObserverÁ¢∫Ë™ç:', 'info');
                if (typeof window.ElementObserver !== 'undefined') {
                    log('‚úÖ window.ElementObserver: Â≠òÂú®', 'success');
                    try {
                        const testInstance = new window.ElementObserver();
                        log(`‚úÖ „ÉÜ„Çπ„Éà„Ç§„É≥„Çπ„Çø„É≥„Çπ‰ΩúÊàê: ÊàêÂäü (${testInstance.constructor.name})`, 'success');
                        log(`üìã „ÉÜ„Çπ„Éà„Ç§„É≥„Çπ„Çø„É≥„Çπ observe: ${typeof testInstance.observe}`, 'info');
                    } catch (error) {
                        log(`‚ùå „ÉÜ„Çπ„Éà„Ç§„É≥„Çπ„Çø„É≥„Çπ‰ΩúÊàê: Â§±Êïó - ${error.message}`, 'error');
                    }
                } else {
                    log('‚ùå window.ElementObserver: Êú™ÂÆöÁæ©', 'error');
                }
                
                // 3. ËÉåÊôØË¶ÅÁ¥†Ê§úÂá∫„ÉÜ„Çπ„Éà
                log('üîç ËÉåÊôØË¶ÅÁ¥†Ê§úÂá∫„ÉÜ„Çπ„Éà:', 'info');
                const backgroundElement = currentBoundingBox.autoPin.detectBackgroundElement(testCharacter);
                if (backgroundElement) {
                    log(`‚úÖ ËÉåÊôØË¶ÅÁ¥†Ê§úÂá∫ÊàêÂäü: ${backgroundElement.id || backgroundElement.tagName}`, 'success');
                    log(`ËÉåÊôØË¶ÅÁ¥†„Çµ„Ç§„Ç∫: ${backgroundElement.offsetWidth}√ó${backgroundElement.offsetHeight}px`, 'info');
                } else {
                    log('‚ùå ËÉåÊôØË¶ÅÁ¥†Ê§úÂá∫Â§±Êïó', 'error');
                }
                
                // 4. ÊúÄÈÅ©„Ç¢„É≥„Ç´„ÉºË®àÁÆó„ÉÜ„Çπ„Éà
                if (backgroundElement) {
                    log('üéØ ÊúÄÈÅ©„Ç¢„É≥„Ç´„Éº„Éù„Ç§„É≥„ÉàË®àÁÆó„ÉÜ„Çπ„Éà:', 'info');
                    const bounds = currentBoundingBox.getBounds();
                    const optimalAnchor = currentBoundingBox.autoPin.calculateOptimalAnchor(bounds, backgroundElement);
                    log(`‚úÖ ÊúÄÈÅ©„Ç¢„É≥„Ç´„Éº: ${optimalAnchor} (${getAnchorName(optimalAnchor)})`, 'success');
                }
                
                // 5. ‰øùÂ≠òÊôÇËá™Âãï„Éî„É≥ÈÅ©Áî®„ÅÆË™¨Êòé
                log('üí° Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó: ÂÆüÈöõ„ÅÆ„ÉÜ„Çπ„ÉàÊâãÈ†Ü', 'info');
                log('1. BB„Çí„Éâ„É©„ÉÉ„Ç∞„Åó„Å¶‰ΩçÁΩÆ„ÇíË™øÊï¥', 'info');
                log('2. „Äå‰øùÂ≠ò„Äç„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ', 'info');
                log('3. Ëá™Âãï„Éî„É≥„ÅåÈÅ©Áî®„Åï„Çå„Çã„Åì„Å®„ÇíÁ¢∫Ë™ç', 'info');
                log('4. „Éö„Éº„Ç∏„Çí„É™„Çµ„Ç§„Ç∫„Åó„Å¶ËøΩÂæìÂãï‰Ωú„ÇíÁ¢∫Ë™ç', 'info');
                
                log('‚úÖ AutoPin „Ç∑„Çπ„ÉÜ„É†„ÉÜ„Çπ„ÉàÂÆå‰∫Ü', 'success');
                
            } catch (error) {
                log(`‚ùå AutoPin „Ç∑„Çπ„ÉÜ„É†„ÉÜ„Çπ„Éà„Ç®„É©„Éº: ${error.message}`, 'error');
                console.error('AutoPin „Ç∑„Çπ„ÉÜ„É†„ÉÜ„Çπ„Éà„Ç®„É©„Éº:', error);
            }
        }
        
        // „Ç¢„É≥„Ç´„ÉºÂêçÁß∞„ÇíÂèñÂæó
        function getAnchorName(anchor) {
            const names = {
                'TL': 'Â∑¶‰∏ä', 'TC': '‰∏ä‰∏≠Â§Æ', 'TR': 'Âè≥‰∏ä',
                'ML': 'Â∑¶‰∏≠Â§Æ', 'MC': '‰∏≠Â§Æ', 'MR': 'Âè≥‰∏≠Â§Æ',
                'BL': 'Â∑¶‰∏ã', 'BC': '‰∏ã‰∏≠Â§Æ', 'BR': 'Âè≥‰∏ã'
            };
            return names[anchor] || anchor;
        }
        
        function testResize() {
            log('üìê „É™„Çµ„Ç§„Ç∫„ÉÜ„Çπ„ÉàÈñãÂßã', 'info');
            
            const container = document.querySelector('.test-container');
            const heroSection = document.getElementById('test-hero');
            
            if (!heroSection) {
                log('‚ùå „Éí„Éº„É≠„Éº„Çª„ÇØ„Ç∑„Éß„É≥„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
                return;
            }
            
            log('üìä ÁèæÂú®„ÅÆ„Çµ„Ç§„Ç∫ÊÉÖÂ†±:', 'info');
            log(`„Ç¶„Ç£„É≥„Éâ„Ç¶: ${window.innerWidth} √ó ${window.innerHeight}`, 'info');
            
            const heroRect = heroSection.getBoundingClientRect();
            log(`„Éí„Éº„É≠„Éº„Çª„ÇØ„Ç∑„Éß„É≥: ${heroRect.width.toFixed(0)} √ó ${heroRect.height.toFixed(0)}`, 'info');
            
            // ÊÆµÈöéÁöÑ„É™„Çµ„Ç§„Ç∫„ÉÜ„Çπ„Éà
            const sizes = [
                { width: 800, height: 600, name: 'Â∞è„Åï„ÇÅ' },
                { width: 1200, height: 800, name: '‰∏≠„Çµ„Ç§„Ç∫' },
                { width: 1600, height: 900, name: 'Â§ß„Åç„ÇÅ' }
            ];
            
            let currentStep = 0;
            
            function nextResize() {
                if (currentStep >= sizes.length) {
                    log('‚úÖ „É™„Çµ„Ç§„Ç∫„ÉÜ„Çπ„ÉàÂÆå‰∫Ü', 'success');
                    return;
                }
                
                const size = sizes[currentStep];
                log(`üìê ${size.name}„Çµ„Ç§„Ç∫„Å´Â§âÊõ¥‰∏≠: ${size.width} √ó ${size.height}`, 'info');
                
                // „Éñ„É©„Ç¶„Ç∂„Ç¶„Ç£„É≥„Éâ„Ç¶„Çµ„Ç§„Ç∫Â§âÊõ¥„ÅØ„Çª„Ç≠„É•„É™„ÉÜ„Ç£Âà∂Èôê„Åß‰∏çÂèØ„ÅÆ„Åü„ÇÅ„ÄÅ
                // „Éí„Éº„É≠„Éº„Çª„ÇØ„Ç∑„Éß„É≥„ÅÆ„Çµ„Ç§„Ç∫„ÇíÁõ¥Êé•Â§âÊõ¥
                heroSection.style.width = `${size.width}px`;
                heroSection.style.height = `${size.height}px`;
                
                setTimeout(() => {
                    const newRect = heroSection.getBoundingClientRect();
                    log(`‚Üí Êñ∞„Çµ„Ç§„Ç∫: ${newRect.width.toFixed(0)} √ó ${newRect.height.toFixed(0)}`, 'success');
                    
                    currentStep++;
                    setTimeout(nextResize, 2000);
                }, 1000);
            }
            
            // „ÉÜ„Çπ„ÉàÂÆüË°å
            nextResize();
            
            // 5ÁßíÂæå„Å´ÂÖÉ„ÅÆ„Çµ„Ç§„Ç∫„Å´Êàª„Åô
            setTimeout(() => {
                heroSection.style.width = '';
                heroSection.style.height = '';
                log('üîÑ ÂÖÉ„ÅÆ„Çµ„Ç§„Ç∫„Å´Âæ©ÂÖÉ', 'info');
            }, 10000);
        }
        
        // „É¢„Ç∏„É•„Éº„É´Áä∂ÊÖãË°®Á§∫
        function showModuleStatus() {
            log('üìä „É¢„Ç∏„É•„Éº„É´Áä∂ÊÖãË°®Á§∫', 'info');
            
            // „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞Á¢∫Ë™ç
            const globals = [
                'ElementObserverCore', 'ElementObserver',
                'PureBoundingBoxCore', 'PureBoundingBoxUI', 
                'PureBoundingBoxAutoPin', 'PureBoundingBox',
                'StableSpineRenderer'
            ];
            
            globals.forEach(name => {
                const exists = typeof window[name] === 'function';
                log(`${exists ? '‚úÖ' : '‚ùå'} ${name}: ${exists ? 'OK' : 'NG'}`, exists ? 'success' : 'error');
            });
            
            // ÁèæÂú®„ÅÆ„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„ÇπÁä∂ÊÖã
            if (currentBoundingBox) {
                const state = currentBoundingBox.getState();
                log(`üìä ÁèæÂú®„ÅÆBBÁä∂ÊÖã: ${JSON.stringify(state)}`, 'info');
                
                if (currentBoundingBox.ui && currentBoundingBox.ui.autoPin) {
                    const autoPinState = currentBoundingBox.ui.autoPin.getState();
                    log(`üìç AutoPinÁä∂ÊÖã: ${JSON.stringify(autoPinState)}`, 'info');
                }
            } else {
                log('‚ö†Ô∏è „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å™„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ„Å™„Åó', 'warning');
            }
        }
        
        // „É≠„Ç∞„ÇØ„É™„Ç¢
        function clearLog() {
            if (logDisplay) {
                logDisplay.textContent = 'üéØ „É≠„Ç∞„ÇØ„É™„Ç¢„Åï„Çå„Åæ„Åó„Åü\n';
            }
            log('üóëÔ∏è „É≠„Ç∞„ÇØ„É™„Ç¢ÂÆüË°å', 'info');
        }
        
        // ÂàùÊúüboundsÂâäÈô§Ôºà„Çπ„Ç±„Éº„É´Ë®àÁÆó„É™„Çª„ÉÉ„ÉàÁî®Ôºâ
        function clearOriginalBounds() {
            try {
                const keys = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith('original-bounds-')) {
                        keys.push(key);
                    }
                }
                
                keys.forEach(key => localStorage.removeItem(key));
                
                log(`üìè ÂàùÊúüboundsÂâäÈô§ÂÆå‰∫Ü: ${keys.length}ÂÄã`, 'success');
                log('Ê¨°Âõû„ÅÆ„Éê„Ç¶„É≥„Éá„Ç£„É≥„Ç∞„Éú„ÉÉ„ÇØ„Çπ‰ΩúÊàêÊôÇ„Å´Ê≠£„Åó„ÅÑÂàùÊúüÂÄ§„Åå‰øùÂ≠ò„Åï„Çå„Åæ„Åô', 'info');
                
                if (keys.length === 0) {
                    log('‚ö†Ô∏è ÂâäÈô§ÂØæË±°„ÅÆÂàùÊúübounds„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü', 'warning');
                }
                
            } catch (error) {
                log(`‚ùå ÂàùÊúüboundsÂâäÈô§„Ç®„É©„Éº: ${error.message}`, 'error');
                console.error('ÂàùÊúüboundsÂâäÈô§„Ç®„É©„Éº:', error);
            }
        }
        
        // „Éû„Éã„É•„Ç¢„É´Ê∫ñÊã†: StableSpineRenderer„ÅßSpine„Ç≠„É£„É©„ÇØ„Çø„ÉºÂÆüË£Ö
        async function loadSpineCharacter() {
            try {
                log('üéÆ Spine„Ç≠„É£„É©„ÇØ„Çø„ÉºË™≠„ÅøËæº„ÅøÈñãÂßãÔºà„Éû„Éã„É•„Ç¢„É´Ê∫ñÊã†Ôºâ', 'info');
                log(`„Ç≠„É£„É©„ÇØ„Çø„Éº: ${currentCharacterName}`, 'info');
                
                // Êó¢Â≠ò„ÅÆ„É¨„É≥„ÉÄ„É©„Éº„Çí„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
                if (spineRenderer) {
                    if (typeof spineRenderer.cleanup === 'function') {
                        spineRenderer.cleanup();
                    }
                    spineRenderer = null;
                }
                
                // CanvasË¶ÅÁ¥†„ÇíÂèñÂæóÔºàHTMLÂÜÖ„ÅßÂÆöÁæ©Ê∏à„ÅøÔºâ
                const canvas = document.getElementById('spine-canvas');
                if (!canvas) {
                    log('‚ùå spine-canvasË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
                    return;
                }
                
                log('‚úÖ CanvasË¶ÅÁ¥†„ÇíÁ¢∫Ë™ç', 'info');
                log(`Canvas „Çµ„Ç§„Ç∫: ${canvas.width}√ó${canvas.height}px`, 'info');
                
                // Spine WebGL „ÅÆË™≠„ÅøËæº„ÅøÁ¢∫Ë™ç
                if (typeof spine === 'undefined') {
                    log('‚ùå Spine WebGL „ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì', 'error');
                    return;
                }
                
                // StableSpineRenderer „ÅÆË™≠„ÅøËæº„ÅøÁ¢∫Ë™ç
                if (typeof StableSpineRenderer === 'undefined') {
                    log('‚ùå StableSpineRenderer „ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì', 'error');
                    return;
                }
                
                // „Éû„Éã„É•„Ç¢„É´Ê∫ñÊã†: StableSpineRenderer.createForCharacter()„Çí‰ΩøÁî®
                log('üéØ StableSpineRendererÂàùÊúüÂåñ‰∏≠...Ôºà„Éû„Éã„É•„Ç¢„É´Ê∫ñÊã†Ôºâ', 'info');
                
                // 1Ë°å„Åß‰ΩúÊàê„ÉªÂàùÊúüÂåñÔºà„Ç≠„É£„É©„ÇØ„Çø„ÉºÂêç„ÇíÊåáÂÆöÔºâ
                spineRenderer = StableSpineRenderer.createForCharacter(currentCharacterName);
                await spineRenderer.initialize();
                
                log(`‚úÖ ${currentCharacterName} „É¨„É≥„ÉÄ„É™„É≥„Ç∞ÊàêÂäü`, 'success');
                
                // „Ç≠„É£„É©„ÇØ„Çø„ÉºÂà•„Éá„Éï„Ç©„É´„Éà„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÂÜçÁîüÔºà„Éû„Éã„É•„Ç¢„É´Ê∫ñÊã†Ôºâ
                if (currentCharacterName === 'purattokun') {
                    spineRenderer.playAnimation('taiki');
                    log('‚ñ∂Ô∏è „Éá„Éï„Ç©„É´„Éà„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥: taikiÔºàpurattokunÁî®Ôºâ', 'success');
                } else if (currentCharacterName === 'nezumi') {
                    spineRenderer.playAnimation('search');
                    log('‚ñ∂Ô∏è „Éá„Éï„Ç©„É´„Éà„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥: searchÔºànezumiÁî®Ôºâ', 'success');
                } else {
                    log(`‚ö†Ô∏è Êú™Áü•„ÅÆ„Ç≠„É£„É©„ÇØ„Çø„Éº: ${currentCharacterName}`, 'warning');
                }
                
                // CanvasË¶ÅÁ¥†„ÇíBBÁî®„ÅÆ„Çø„Éº„Ç≤„ÉÉ„ÉàË¶ÅÁ¥†„Å®„Åó„Å¶Ë®≠ÂÆö
                testCharacter = canvas;
                
                // üîß CanvasË¶ÅÁ¥†„Å´„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö
                log(`üîß Spine canvas (${canvas.id}) „ÇíBB„Çø„Éº„Ç≤„ÉÉ„Éà„Å®„Åó„Å¶Ë®≠ÂÆö`, 'info');
                setupCharacterClickListener(testCharacter);
                
                // üîç Ë®≠ÂÆöÁ¢∫Ë™ç
                log(`‚úÖ testCharacterË®≠ÂÆöÂÆå‰∫Ü: ${testCharacter.id || testCharacter.tagName}`, 'success');
                
            } catch (error) {
                log(`‚ùå Spine„Ç≠„É£„É©„ÇØ„Çø„ÉºË™≠„ÅøËæº„Åø„Ç®„É©„Éº: ${error.message}`, 'error');
                console.error('Spine„Ç≠„É£„É©„ÇØ„Çø„ÉºË™≠„ÅøËæº„Åø„Ç®„É©„ÉºË©≥Á¥∞:', error);
            }
        }
        
        // „Ç≠„É£„É©„ÇØ„Çø„ÉºÂàá„ÇäÊõø„Åà
        async function switchCharacter() {
            try {
                // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÇíÂàá„ÇäÊõø„Åà
                currentCharacterName = currentCharacterName === 'purattokun' ? 'nezumi' : 'purattokun';
                log(`üîÑ „Ç≠„É£„É©„ÇØ„Çø„ÉºÂàá„ÇäÊõø„Åà: ${currentCharacterName}`, 'info');
                
                // ÂÜçË™≠„ÅøËæº„Åø
                await loadSpineCharacter();
                
            } catch (error) {
                log(`‚ùå „Ç≠„É£„É©„ÇØ„Çø„ÉºÂàá„ÇäÊõø„Åà„Ç®„É©„Éº: ${error.message}`, 'error');
                console.error('„Ç≠„É£„É©„ÇØ„Çø„ÉºÂàá„ÇäÊõø„Åà„Ç®„É©„Éº:', error);
            }
        }
        
        // iframe„ÉÜ„Çπ„ÉàÔºàCanvasResizeController UIÁ¢∫Ë™çÔºâ
        async function testCanvasResize() {
            try {
                log('üìê Canvas Resize UI „ÉÜ„Çπ„ÉàÈñãÂßã', 'info');
                
                const iframe = document.getElementById('canvas-resize-iframe');
                if (!iframe) {
                    log('‚ùå CanvasResizeController iframe „ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
                    return;
                }
                
                // iframe„ÅÆÂ≠òÂú®Á¢∫Ë™ç„Å®Âº∑Ë™øË°®Á§∫
                iframe.style.border = '3px solid #00ff00';
                iframe.style.boxShadow = '0 0 20px rgba(0, 255, 0, 0.5)';
                
                log('‚úÖ CanvasResizeController UI iframe „ÇíÁ¢∫Ë™ç„Åó„Åæ„Åó„Åü', 'success');
                log('üìã iframeÂÜÖ„ÅÆUI„ÅßCanvasÂà∂Âæ°„ÅåÂèØËÉΩ„Åß„Åô', 'info');
                
                // 3ÁßíÂæå„Å´Âº∑Ë™øË°®Á§∫„ÇíËß£Èô§
                setTimeout(() => {
                    iframe.style.border = '1px solid #ddd';
                    iframe.style.boxShadow = '';
                    log('üìê iframeÂº∑Ë™øË°®Á§∫„ÇíËß£Èô§„Åó„Åæ„Åó„Åü', 'info');
                }, 3000);
                
            } catch (error) {
                log(`‚ùå iframe„ÉÜ„Çπ„Éà„Ç®„É©„Éº: ${error.message}`, 'error');
                console.error('iframe„ÉÜ„Çπ„Éà„Ç®„É©„Éº:', error);
            }
        }
        
        // „ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
        window.addEventListener('beforeunload', () => {
            if (currentBoundingBox) {
                currentBoundingBox.cleanup();
            }
            if (spineRenderer) {
                spineRenderer.cleanup();
            }
        });
        
        // üÜï IMGË¶ÅÁ¥†„ÉÜ„Çπ„ÉàÊ©üËÉΩ
        function testIMGElementContentRect() {
            log('üñºÔ∏è IMGË¶ÅÁ¥†„Ç≥„É≥„ÉÜ„É≥„ÉÑÁü©ÂΩ¢„ÉÜ„Çπ„ÉàÈñãÂßã', 'info');
            
            // „Ç¶„Ç£„É≥„Éâ„Ç¶„Çµ„Ç§„Ç∫„ÇÇË®òÈå≤
            log(`üìê ÁèæÂú®„ÅÆ„Ç¶„Ç£„É≥„Éâ„Ç¶„Çµ„Ç§„Ç∫: ${window.innerWidth}√ó${window.innerHeight}`, 'info');
            
            const testImg = document.getElementById('test-img');
            if (!testImg) {
                log('‚ùå „ÉÜ„Çπ„ÉàIMGË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
                return;
            }
            
            // Ëá™ÁÑ∂„Çµ„Ç§„Ç∫Ë°®Á§∫
            if (testImg.complete && testImg.naturalWidth > 0) {
                const naturalSizeSpan = document.getElementById('natural-size');
                if (naturalSizeSpan) {
                    naturalSizeSpan.textContent = `${testImg.naturalWidth}√ó${testImg.naturalHeight}`;
                }
                
                log(`‚úÖ IMGËá™ÁÑ∂„Çµ„Ç§„Ç∫: ${testImg.naturalWidth}√ó${testImg.naturalHeight}`, 'success');
                
                // PureBoundingBoxAutoPin„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑÁü©ÂΩ¢Ë®àÁÆó„ÉÜ„Çπ„Éà
                if (window.PureBoundingBoxAutoPin) {
                    const autoPin = new window.PureBoundingBoxAutoPin();
                    const contentRect = autoPin.calculateContentRect(testImg);
                    
                    if (contentRect) {
                        log('üéØ IMGË¶ÅÁ¥†„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑÁü©ÂΩ¢Ë®àÁÆóÁµêÊûú:', 'info');
                        console.log('üìä Content Rect Details:', contentRect);
                        
                        log(`  ‚Ä¢ ‰ΩçÁΩÆ: (${contentRect.x.toFixed(1)}, ${contentRect.y.toFixed(1)})`, 'info');
                        log(`  ‚Ä¢ „Çµ„Ç§„Ç∫: ${contentRect.width.toFixed(1)}√ó${contentRect.height.toFixed(1)}`, 'info');
                        log(`  ‚Ä¢ „Çπ„Ç±„Éº„É´: ${contentRect.scaleX?.toFixed(3)}√ó${contentRect.scaleY?.toFixed(3)}`, 'info');
                        log(`  ‚Ä¢ „Çø„Ç§„Éó: ${contentRect.type}`, 'info');
                        
                        // ËÉåÊôØÁîªÂÉèÁâà„Å®„ÅÆÊØîËºÉ
                        const backgroundElement = document.getElementById('background-element');
                        if (backgroundElement) {
                            const bgContentRect = autoPin.calculateContentRect(backgroundElement);
                            if (bgContentRect) {
                                log('üîç ËÉåÊôØÁîªÂÉèÁâà„Å®„ÅÆÊØîËºÉ:', 'info');
                                log(`  ‚Ä¢ IMGÁâà„Çø„Ç§„Éó: ${contentRect.type}`, 'info');
                                log(`  ‚Ä¢ ËÉåÊôØÁâà„Çø„Ç§„Éó: ${bgContentRect.type}`, 'info');
                                log(`  ‚Ä¢ „Çπ„Ç±„Éº„É´Á≤æÂ∫¶: IMGÁâà„ÅÆÊñπ„Åå${contentRect.type.includes('natural') ? 'È´òÁ≤æÂ∫¶' : 'Êé®ÂÆöÂÄ§'}`, 'info');
                            }
                        }
                    } else {
                        log('‚ùå „Ç≥„É≥„ÉÜ„É≥„ÉÑÁü©ÂΩ¢Ë®àÁÆóÂ§±Êïó', 'error');
                    }
                } else {
                    log('‚ö†Ô∏è PureBoundingBoxAutoPin„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì', 'warning');
                }
            } else {
                log('‚è≥ ÁîªÂÉèË™≠„ÅøËæº„Åø‰∏≠...ÂÜçË©¶Ë°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'warning');
            }
        }
        
        /**
         * üéØ ÂäπÁéáÁöÑ„Éî„É≥„Ç∑„Çπ„ÉÜ„É† v2.0 Áµ±Âêà„ÉÜ„Çπ„Éà
         */
        async function testEfficientPinSystem() {
            log('üéØ ÂäπÁéáÁöÑ„Éî„É≥„Ç∑„Çπ„ÉÜ„É† v2.0 Áµ±Âêà„ÉÜ„Çπ„ÉàÈñãÂßã', 'info');
            
            try {
                // „É¢„Ç∏„É•„Éº„É´Â≠òÂú®Á¢∫Ë™ç
                if (!window.ElementCalculator || !window.PinRenderer || !window.EfficientObserver) {
                    log('‚ùå ÂøÖË¶Å„Å™„É¢„Ç∏„É•„Éº„É´„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì', 'error');
                    log('  ‚Ä¢ ElementCalculator: ' + (!!window.ElementCalculator), 'error');
                    log('  ‚Ä¢ PinRenderer: ' + (!!window.PinRenderer), 'error');
                    log('  ‚Ä¢ EfficientObserver: ' + (!!window.EfficientObserver), 'error');
                    return;
                }
                
                log('‚úÖ ÂÖ®„É¢„Ç∏„É•„Éº„É´Ë™≠„ÅøËæº„ÅøÁ¢∫Ë™çÂÆå‰∫Ü', 'success');
                
                // 1. „Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñ
                const calculator = new ElementCalculator();
                const renderer = new PinRenderer();
                const observer = new EfficientObserver(calculator, renderer);
                
                log('üèóÔ∏è 3Â±§„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£ÂàùÊúüÂåñÂÆå‰∫Ü', 'success');
                
                // 2. „ÉÜ„Çπ„ÉàÂØæË±°Ë¶ÅÁ¥†ÈÅ∏Êäû
                const backgroundElement = document.getElementById('background-element');
                if (!backgroundElement) {
                    log('‚ùå ËÉåÊôØË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
                    return;
                }
                
                // 3. Ë®àÁÆó„É™„ÇØ„Ç®„Çπ„Éà‰ΩúÊàêÔºà‰ªïÊßòÊõ∏‰æã„Å®Âêå„ÅòÔºâ
                const request = {
                    element: backgroundElement,
                    anchorPoints: [
                        { id: 'TC', ratioX: 0.5, ratioY: 0.0 }  // ‰∏ä‰∏≠Â§Æ„ÅÆ„Åø
                    ],
                    elementType: 'background'
                };
                
                log('üìã Ë®àÁÆó„É™„ÇØ„Ç®„Çπ„Éà‰ΩúÊàê: TC (‰∏ä‰∏≠Â§Æ) „ÅÆ„Åø', 'info');
                
                // 4. Áõ¥Êé•Ë®àÁÆó„ÉÜ„Çπ„Éà
                log('üßÆ ElementCalculatorÁõ¥Êé•Ë®àÁÆó„ÉÜ„Çπ„Éà...', 'info');
                const result = await calculator.calculate(request);
                
                log('‚úÖ Ë®àÁÆóÂÆå‰∫Ü:', 'success');
                log(`  ‚Ä¢ Ë¶ÅÁ¥†ID: ${result.elementId}`, 'info');
                log(`  ‚Ä¢ Ë¶ÅÁ¥†„Çø„Ç§„Éó: ${result.metadata.elementType}`, 'info');
                log(`  ‚Ä¢ Ë®àÁÆóÊñπÊ≥ï: ${result.metadata.calculationMethod}`, 'info');
                log(`  ‚Ä¢ ÂÆüË°åÊôÇÈñì: ${result.metadata.executionTime}ms`, 'info');
                log(`  ‚Ä¢ „Éî„É≥Êï∞: ${result.pins.length}`, 'info');
                
                result.pins.forEach(pin => {
                    log(`    TC ‚Üí (${pin.x}, ${pin.y}) ${pin.isValid ? '‚úÖ' : '‚ùåÁîªÈù¢Â§ñ'}`, 'info');
                });
                
                // 5. PinRendererÊèèÁîª„ÉÜ„Çπ„Éà
                log('üé® PinRendererÊèèÁîª„ÉÜ„Çπ„Éà...', 'info');
                renderer.render({
                    pins: result.pins,
                    options: {
                        defaultColor: '#2ed573',
                        showLabels: true,
                        enableAnimation: true
                    }
                });
                
                log('‚úÖ „Éî„É≥ÊèèÁîªÂÆå‰∫Ü - ÁîªÈù¢‰∏ä„Å´Á∑ëËâ≤„Éî„É≥„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„Çã„ÅØ„Åö„Åß„Åô', 'success');
                
                // 6. EfficientObserverÁõ£Ë¶ñ„ÉÜ„Çπ„Éà
                log('üëÄ EfficientObserverÁõ£Ë¶ñÈñãÂßã...', 'info');
                observer.observe(backgroundElement, request);
                
                log('‚úÖ Áõ£Ë¶ñÈñãÂßãÂÆå‰∫Ü - „Ç¶„Ç£„É≥„Éâ„Ç¶„Çµ„Ç§„Ç∫Â§âÊõ¥„Åß„Éî„É≥„ÅåËøΩÂæì„Åô„Çã„ÅØ„Åö„Åß„Åô', 'success');
                
                // 7. Áµ±Ë®àÊÉÖÂ†±Ë°®Á§∫
                const observationState = observer.getObservationState();
                const rendererState = renderer.getState();
                
                log('üìä „Ç∑„Çπ„ÉÜ„É†Áµ±Ë®à:', 'info');
                log(`  ‚Ä¢ Áõ£Ë¶ñË¶ÅÁ¥†Êï∞: ${observationState.observedElementCount}`, 'info');
                log(`  ‚Ä¢ „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Éî„É≥Êï∞: ${rendererState.activePinCount}`, 'info');
                log(`  ‚Ä¢ Ë®àÁÆó„Ç≠„É£„ÉÉ„Ç∑„É•„Çµ„Ç§„Ç∫: ${calculator.getStats().cacheSize}`, 'info');
                
                // 8. „Ç∞„É≠„Éº„Éê„É´ÂèÇÁÖßË®≠ÂÆöÔºà‰ªñ„ÅÆÊ©üËÉΩ„Åã„Çâ„Ç¢„ÇØ„Çª„ÇπÂèØËÉΩ„Å´„Åô„ÇãÔºâ
                window.efficientPinSystem = {
                    calculator: calculator,
                    renderer: renderer,
                    observer: observer
                };
                
                // 9. 3ÁßíÂæå„Å´„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„ÉÜ„Çπ„Éà
                setTimeout(() => {
                    log('üßπ 3ÁßíÂæå„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„ÉÜ„Çπ„Éà...', 'info');
                    observer.unobserve(backgroundElement);
                    renderer.clearPins();
                    log('‚úÖ „ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÂÆå‰∫Ü - „Éî„É≥„ÅåÊ∂à„Åà„Å¶„ÅÑ„Çã„ÅØ„Åö„Åß„Åô', 'success');
                }, 3000);
                
                log('üéØ ÂäπÁéáÁöÑ„Éî„É≥„Ç∑„Çπ„ÉÜ„É† v2.0 Áµ±Âêà„ÉÜ„Çπ„ÉàÂÆå‰∫ÜÔºÅ', 'success');
                
            } catch (error) {
                log(`‚ùå Áµ±Âêà„ÉÜ„Çπ„Éà„Ç®„É©„Éº: ${error.message}`, 'error');
                console.error('Áµ±Âêà„ÉÜ„Çπ„ÉàË©≥Á¥∞„Ç®„É©„Éº:', error);
            }
        }
        
        // IMGË¶ÅÁ¥†„ÅÆË™≠„ÅøËæº„ÅøÁõ£Ë¶ñ
        document.addEventListener('DOMContentLoaded', () => {
            const testImg = document.getElementById('test-img');
            if (testImg) {
                testImg.addEventListener('load', () => {
                    log('‚úÖ „ÉÜ„Çπ„ÉàÁî®IMGË¶ÅÁ¥†Ë™≠„ÅøËæº„ÅøÂÆå‰∫Ü', 'success');
                    const naturalSizeSpan = document.getElementById('natural-size');
                    if (naturalSizeSpan) {
                        naturalSizeSpan.textContent = `${testImg.naturalWidth}√ó${testImg.naturalHeight}`;
                    }
                });
                
                testImg.addEventListener('error', () => {
                    log('‚ùå „ÉÜ„Çπ„ÉàÁî®IMGË¶ÅÁ¥†Ë™≠„ÅøËæº„ÅøÂ§±Êïó', 'error');
                    const naturalSizeSpan = document.getElementById('natural-size');
                    if (naturalSizeSpan) {
                        naturalSizeSpan.textContent = 'Error';
                    }
                });
            }
        });

        // üîç „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫ÂΩ±ÈüøË®∫Êñ≠
        function debugWindowResizeImpact() {
            log('üîç „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫ÂΩ±ÈüøË®∫Êñ≠ÈñãÂßã', 'info');
            
            const windowInfo = {
                innerWidth: window.innerWidth,
                innerHeight: window.innerHeight,
                devicePixelRatio: window.devicePixelRatio,
                screenWidth: window.screen.width,
                screenHeight: window.screen.height
            };
            
            log('üìê „Ç¶„Ç£„É≥„Éâ„Ç¶„ÉªÁîªÈù¢ÊÉÖÂ†±:', 'info');
            for (const [key, value] of Object.entries(windowInfo)) {
                log(`  ‚Ä¢ ${key}: ${value}`, 'info');
            }
            
            // Ë¶ÅÁ¥†„Çµ„Ç§„Ç∫„ÅÆË©≥Á¥∞Á¢∫Ë™ç
            const elementsToCheck = [
                { id: 'background-element', name: 'ËÉåÊôØË¶ÅÁ¥†' },
                { id: 'test-img', name: 'IMGË¶ÅÁ¥†' },
                { id: 'test-hero', name: '„Éí„Éº„É≠„Éº„Çª„ÇØ„Ç∑„Éß„É≥' }
            ];
            
            elementsToCheck.forEach(({ id, name }) => {
                const element = document.getElementById(id);
                if (element) {
                    const rect = element.getBoundingClientRect();
                    const computedStyle = window.getComputedStyle(element);
                    
                    log(`üéØ ${name} (${id}) „ÅÆ„Çµ„Ç§„Ç∫ÊÉÖÂ†±:`, 'info');
                    log(`  ‚Ä¢ BoundingRect: ${rect.width.toFixed(1)}√ó${rect.height.toFixed(1)} at (${rect.left.toFixed(1)}, ${rect.top.toFixed(1)})`, 'info');
                    log(`  ‚Ä¢ CSS width/height: ${computedStyle.width} / ${computedStyle.height}`, 'info');
                    log(`  ‚Ä¢ CSS backgroundSize: ${computedStyle.backgroundSize}`, 'info');
                    
                    if (element.tagName.toLowerCase() === 'img') {
                        log(`  ‚Ä¢ Ëá™ÁÑ∂„Çµ„Ç§„Ç∫: ${element.naturalWidth}√ó${element.naturalHeight}`, 'info');
                    }
                    
                    // „Ç≥„É≥„ÉÜ„É≥„ÉÑÁü©ÂΩ¢Ë®àÁÆó
                    if (window.PureBoundingBoxAutoPin) {
                        const autoPin = new window.PureBoundingBoxAutoPin();
                        const contentRect = autoPin.calculateContentRect(element);
                        if (contentRect) {
                            log(`  ‚Ä¢ „Ç≥„É≥„ÉÜ„É≥„ÉÑÁü©ÂΩ¢: ${contentRect.width.toFixed(1)}√ó${contentRect.height.toFixed(1)} at (${contentRect.x.toFixed(1)}, ${contentRect.y.toFixed(1)})`, 'info');
                            log(`  ‚Ä¢ „Çø„Ç§„Éó: ${contentRect.type}`, 'info');
                            if (contentRect.scaleX && contentRect.scaleY) {
                                log(`  ‚Ä¢ „Çπ„Ç±„Éº„É´: ${contentRect.scaleX.toFixed(3)}√ó${contentRect.scaleY.toFixed(3)}`, 'info');
                            }
                        }
                    }
                    
                    log('', 'info'); // Á©∫Ë°å
                }
            });
            
            // „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫„É™„Çπ„Éä„Éº„ÅÆÁä∂ÊÖãÁ¢∫Ë™ç
            if (window.PureBoundingBoxAutoPin) {
                log('üîç AutoPin„Ç∑„Çπ„ÉÜ„É†Áä∂ÊÖãÁ¢∫Ë™ç:', 'info');
                const autoPin = new window.PureBoundingBoxAutoPin();
                
                // „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÁµ±Ë®à
                if (autoPin.performanceMetrics) {
                    log('üìä „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÁµ±Ë®à:', 'info');
                    log(`  ‚Ä¢ ÊàêÂäü: ${autoPin.performanceMetrics.successCount || 0}`, 'info');
                    log(`  ‚Ä¢ Â§±Êïó: ${autoPin.performanceMetrics.failureCount || 0}`, 'info');
                    log(`  ‚Ä¢ ÊúÄÁµÇÊõ¥Êñ∞: ${autoPin.performanceMetrics.lastUpdated || 'N/A'}`, 'info');
                }
            }
            
            log('‚úÖ „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫ÂΩ±ÈüøË®∫Êñ≠ÂÆå‰∫Ü', 'success');
            log('üí° ÊâãÈ†Ü: „Ç¶„Ç£„É≥„Éâ„Ç¶„Çµ„Ç§„Ç∫„ÇíÂ§âÊõ¥„Åó„Å¶„Åã„ÇâÂÜçÂ∫¶„Åì„ÅÆ„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶ÊØîËºÉ„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'info');
        }

        // üìç „Éî„É≥Ë°®Á§∫Âàá„ÇäÊõø„ÅàÊ©üËÉΩ
        let pinsVisible = false;
        let currentPinMarkers = [];
        
        function togglePinVisibility() {
            pinsVisible = !pinsVisible;
            const button = document.querySelector('[onclick="togglePinVisibility()"]');
            
            if (pinsVisible) {
                button.textContent = 'üî¥ „Éî„É≥ÈùûË°®Á§∫';
                button.style.background = '#dc3545';
                showCurrentPins();
                log('üìç „Éî„É≥Ë°®Á§∫„É¢„Éº„Éâ ON', 'info');
            } else {
                button.textContent = 'üìç „Éî„É≥Ë°®Á§∫Âàá„ÇäÊõø„Åà';
                button.style.background = '#6c757d';
                hideCurrentPins();
                log('üìç „Éî„É≥Ë°®Á§∫„É¢„Éº„Éâ OFF', 'info');
            }
        }
        
        function showCurrentPins() {
            // Êó¢Â≠ò„ÅÆ„Éî„É≥„ÇíÂâäÈô§
            hideCurrentPins();
            
            if (window.PureBoundingBoxAutoPin) {
                const autoPin = new window.PureBoundingBoxAutoPin();
                
                // ÂêÑË¶ÅÁ¥†„ÅÆ„Ç¢„É≥„Ç´„Éº„Éù„Ç§„É≥„Éà„ÇíË°®Á§∫
                const elementsToCheck = [
                    { id: 'background-element', name: 'ËÉåÊôØË¶ÅÁ¥†' },
                    { id: 'test-img', name: 'IMGË¶ÅÁ¥†' },
                    { id: 'test-hero', name: '„Éí„Éº„É≠„Éº' }
                ];
                
                elementsToCheck.forEach(({ id, name }) => {
                    const element = document.getElementById(id);
                    if (element) {
                        const contentRect = autoPin.calculateContentRect(element);
                        if (contentRect) {
                            // 9„Å§„ÅÆ„Ç¢„É≥„Ç´„Éº„Éù„Ç§„É≥„Éà„ÇíË°®Á§∫
                            const anchors = [
                                { id: 'TL', x: 0, y: 0, name: 'Top Left' },
                                { id: 'TC', x: 0.5, y: 0, name: 'Top Center' },
                                { id: 'TR', x: 1, y: 0, name: 'Top Right' },
                                { id: 'ML', x: 0, y: 0.5, name: 'Middle Left' },
                                { id: 'MC', x: 0.5, y: 0.5, name: 'Middle Center' },
                                { id: 'MR', x: 1, y: 0.5, name: 'Middle Right' },
                                { id: 'BL', x: 0, y: 1, name: 'Bottom Left' },
                                { id: 'BC', x: 0.5, y: 1, name: 'Bottom Center' },
                                { id: 'BR', x: 1, y: 1, name: 'Bottom Right' }
                            ];
                            
                            const elementRect = element.getBoundingClientRect();
                            
                            anchors.forEach(anchor => {
                                // üî• ‰øÆÊ≠£: containerRect„Çí‰ΩøÁî®„Åó„ÅüÊ≠£Á¢∫„Å™Ë®àÁÆó
                                let pinX, pinY;
                                
                                if (contentRect.containerRect) {
                                    // containerRect„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„Åù„Çå„ÇíÂü∫Ê∫ñ„Å´
                                    pinX = contentRect.containerRect.left + contentRect.x + (contentRect.width * anchor.x);
                                    pinY = contentRect.containerRect.top + contentRect.y + (contentRect.height * anchor.y);
                                } else {
                                    // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: elementRect„ÇíÂü∫Ê∫ñ„Å´
                                    pinX = elementRect.left + contentRect.x + (contentRect.width * anchor.x);
                                    pinY = elementRect.top + contentRect.y + (contentRect.height * anchor.y);
                                }
                                
                                console.log(`üîç ${name} ${anchor.id} „Éî„É≥Ë®àÁÆó:`, {
                                    elementRect: `${elementRect.left.toFixed(1)}, ${elementRect.top.toFixed(1)}, ${elementRect.width.toFixed(1)}√ó${elementRect.height.toFixed(1)}`,
                                    contentRect: `${contentRect.x}, ${contentRect.y}, ${contentRect.width.toFixed(1)}√ó${contentRect.height.toFixed(1)}`,
                                    anchorOffset: `${anchor.x}√ó${anchor.y}`,
                                    calculatedPin: `(${pinX.toFixed(1)}, ${pinY.toFixed(1)})`,
                                    windowSize: `${window.innerWidth}√ó${window.innerHeight}`
                                });
                                
                                const pin = document.createElement('div');
                                pin.className = `autopin-marker anchor-${anchor.id}`;
                                pin.style.left = pinX + 'px';
                                pin.style.top = pinY + 'px';
                                pin.title = `${name}: ${anchor.name} (${anchor.id})\n‰ΩçÁΩÆ: (${pinX.toFixed(1)}, ${pinY.toFixed(1)})`;
                                
                                // „Ç¶„Ç£„É≥„Éâ„Ç¶Â§ñ„Å´Âá∫„ÇãÂ†¥Âêà„ÅÆË≠¶Âëä
                                if (pinX < 0 || pinY < 0 || pinX > window.innerWidth || pinY > window.innerHeight) {
                                    console.warn(`‚ö†Ô∏è ${name} ${anchor.id} „Éî„É≥„Åå„Ç¶„Ç£„É≥„Éâ„Ç¶Â§ñ: (${pinX.toFixed(1)}, ${pinY.toFixed(1)})`);
                                    pin.style.border = '3px solid orange'; // Ë≠¶ÂëäËâ≤
                                }
                                
                                document.body.appendChild(pin);
                                currentPinMarkers.push(pin);
                            });
                            
                            log(`üìç ${name}: 9ÂÄã„ÅÆ„Ç¢„É≥„Ç´„Éº„Éî„É≥Ë°®Á§∫`, 'info');
                        }
                    }
                });
                
                // „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫ÊôÇ„Å´„Éî„É≥‰ΩçÁΩÆ„ÇíÊõ¥Êñ∞
                if (currentPinMarkers.length > 0) {
                    const updatePins = () => {
                        if (pinsVisible) {
                            showCurrentPins();
                        }
                    };
                    
                    window.addEventListener('resize', updatePins);
                    // 5ÁßíÂæå„Å´„É™„Çπ„Éä„Éº„ÇíÂâäÈô§Ôºà„É°„É¢„É™„É™„Éº„ÇØÈò≤Ê≠¢Ôºâ
                    setTimeout(() => {
                        window.removeEventListener('resize', updatePins);
                    }, 5000);
                }
            } else {
                log('‚ö†Ô∏è PureBoundingBoxAutoPin„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì', 'warning');
            }
        }
        
        function hideCurrentPins() {
            currentPinMarkers.forEach(pin => pin.remove());
            currentPinMarkers = [];
        }

        // „Éá„Éê„ÉÉ„Ç∞Áî®„Ç∞„É≠„Éº„Éê„É´Èñ¢Êï∞
        window.testBoundingBox = testBasicBoundingBox;
        window.testRightClickMenu = testRightClickMenu;
        window.testResize = testResize;
        window.testModifierKeys = testModifierKeys;
        window.debugBBSystem = debugBBSystem;
        window.testCanvasResize = testCanvasResize;
        window.testAutoPinSystem = testAutoPinSystem;
        window.loadSpineCharacter = loadSpineCharacter;
        window.switchCharacter = switchCharacter;
        window.testIMGElementContentRect = testIMGElementContentRect; // üÜï
        window.debugWindowResizeImpact = debugWindowResizeImpact; // üÜï
        window.togglePinVisibility = togglePinVisibility; // üÜï
        window.showCurrentPins = showCurrentPins; // üÜï
        window.hideCurrentPins = hideCurrentPins; // üÜï
        window.getCurrentBB = () => currentBoundingBox;
        window.getSpineRenderer = () => spineRenderer;
        window.logTest = (message, type) => log(message, type);
    </script>
</body>
</html>
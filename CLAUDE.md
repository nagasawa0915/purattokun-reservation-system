# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

※重要　やり取りは日本語でお願いします。
深く考えてください。

## 🚨 作業時の判断基準（Claude必須確認）

### 🟢 確認不要（すぐ実行）
- 明らかなバグ修正
- ドキュメントの誤字脱字修正
- コメント追加・改善
- ログ出力の追加
- 既存機能の動作確認
- テストコードの実行

### 🔴 確認必須（質問する）
- 既存機能の変更・削除
- ファイル構造の変更
- 新規機能の実装方針
- 「1行追加」「プラグイン」などキーワードが出た時
- 実装規模の判断が必要な時
- 複数の解釈が可能な要件

### 💭 判断フロー
1. これは既存機能を変更するか？ → YES なら確認
2. 実装規模が要求と異なる可能性があるか？ → YES なら確認
3. 過去に同じ失敗をしたパターンか？ → YES なら確認

すべて NO → そのまま進める

### 🚫 よくある失敗パターン（繰り返し禁止）
- 既存システムを理解せずに新規作成
- 1行追加の要望に対して大きなファイル作成
- 確認なしに既存機能を変更

### 🎯 **v3.0システム開発哲学（絶対遵守）**
**コンセプト**: 「シンプル・軽量・複雑化回避」

#### 🚨 **最重要原則**（全Claude必須記憶）
- **過去の失敗教訓**: 機能追加による複雑化でシステム破綻
- **v3.0の絶対方針**: 必要最小限・シンプル設計・軽量性維持
- **禁止事項**: 「良かれと思って」の機能提案・実装

#### **Claude行動指針**:
1. **機能提案禁止**: ユーザーから明確な要求がない限り新機能提案しない
2. **シンプル性最優先**: 複雑な解決策より単純な解決策を選択
3. **軽量性厳守**: ファイルサイズ・処理負荷を常に意識
4. **既存機能重視**: 新機能より既存機能の安定化・シンプル化

#### **判断基準**:
- 提案前に自問: 「これは本当に必要最小限か？」
- 実装前に確認: 「これはv3.0のシンプル哲学に反しないか？」
- 「便利そう」「あったら良い」は実装理由にならない

---

## 📏 ファイルサイズ管理ルール（2025-08-07追加）

### 🎯 **500行制限ルール**
**基本方針**: 500行を超えたファイルは**検討対象**として扱う

#### **運用ルール**:
- **500行超過 = 自動的にリファクタリング対象**として記録
- **機能要件によっては500行超過を許可**（ただし要検討・要記録）
- **1,000行以上 = 緊急分割対象**として優先的に処理

#### **例外基準**:
- 外部ライブラリ（Spine WebGL等）は除外
- 設定ファイル・データファイルは除外
- 分割により複雑度が増加する場合は例外検討

### 🗂️ **大容量ファイル整理状況（2025-08-07現在）**

#### **🚨 緊急整理対象**
1. **Spine WebGLライブラリ重複**: 47,520行→11,880行（4重複→1本化）
2. **旧v3.0アーカイブ**: 5,437行（圧縮・アーカイブ化予定）
3. **現v3.0メインシステム**: 3,867行（モジュール分割予定）

#### **📊 整理効果予測**
- **削減目標**: 約60,000行（プロジェクト全体の大幅軽量化）
- **保守性向上**: 500行以下モジュール化によるデバッグ・修正容易性向上
- **拡張性確保**: nezumi等新キャラクター追加の基盤整備

---

## 🎯 現在の作業状況（2025-08-08更新）

### ✅ 完了済み主要機能（2025-01-31 完全実装達成）

#### 🎯 **Spine編集システムv2.0** - 完全実装済み・商用制作ツール完成
- **v2.0軽量システム作成**: 5,437行→900行（83%削減）、206KB→45KB（78%削減）
- **当初予定4項目達成**:
  1. レイヤー管理改良（1番前=最上位）
  2. 画面内キャラクター直接クリック選択
  3. キーボード矢印キー移動（0.1%/1%刻み）
  4. メニューUI改善（統合スライドメニュー→v2.0シンプル化）
- **追加実装成果**:
  - マウス・タッチドラッグ移動機能
  - システム選択機能（URLパラメータ切り替え）
  - 詳細パネル削除によるシンプル化
- **🏢 商用制作ツール機能達成（2025-01-31完成）**:
  - **📋 CSS出力・抽出機能**: 配置データ→軽量CSSファイル自動生成
  - **💎 商用品質**: 位置小数点4桁・スケール3桁精度・即座納品対応
  - **⚡ 制作フロー完結**: Spine制作→配置調整→CSS出力→お客様納品
  - **🔧 制作効率化**: 手動CSS記述から自動生成ツールへの転換

- **📦 完全パッケージ出力機能（2025-08-04 Phase B技術完成）**:
  - **✅ Phase B実装完了成果（2025-08-04）**:
    - **🚀 完全ZIP生成システム**: ワンクリックでパッケージ作成・ダウンロード機能
    - **🎯 HTML固定化システム**: 編集システム除去・位置データ埋め込み処理
    - **🔧 Spine再生保証システム**: CDN依存完全排除・Spine WebGLライブラリ（446KB）ローカル化
    - **📦 完全パッケージ構成**: Spineファイル一式・画像・HTML・JSライブラリの統合パッケージ
    - **💼 商用基盤確立**: お客様納品用完全パッケージの自動生成システム
    - **🛠️ 解決した技術問題**: Spineファイル欠落・CDN依存・編集ボタン表示・正規表現エラー
  - **✅ Phase C完了成果（2025-08-08）**:
    - **🎮 Spineデータ表示問題**: パッケージ生成・Spineアニメーション表示問題完全解決
    - **📐 位置データ不整合問題**: 編集システムでの配置と出力後の配置の完全整合性確保
    - **✨ エフェクト機能保持**: マウスオーバー・クリック時のキラキラエフェクト完全動作確認
  - **📊 Phase実装状況**: Phase A✅完成（CSS出力） | Phase B✅完成（基本パッケージ出力） | Phase C✅完成（品質保証・完全動作確認）

#### 🔄 **従来システム** - 完全保持
1. **ドラッグ&スケール編集システム** - 完全実装済み
   - spine-positioning-system-explanation.js による従来版
   - ドラッグ移動、スケール調整（スライダー・数値入力）
   - localStorage連携の位置・設定保存

2. **複数キャラクター対応システム** - Phase 1完了
   - キャラクター自動検出（5種類のセレクター対応）
   - キャラクター選択UI（右パネル統合）
   - 視覚的ハイライト機能
   - レイヤー順序制御（ドラッグ&ドロップ並び替え）
   - z-index動的管理システム

3. **問題解決・記録システム** - 充実
   - スケール機能問題の完全修正・記録
   - ドラッグハンドル位置ずれ問題の修正
   - 複数キャラクター対応実装記録の詳細作成
   - **⭐ Spine編集システム完全実装記録の作成**
   - **🆕 バウンディングボックス編集システム実装記録の作成**（2025-08-05新規追加）

4. **バウンディングボックス編集システム** - Phase 1完了（2025-08-05）
   - 保存・キャンセル機能の完全実装
   - 座標系スワップ技術対応（編集座標→元座標系→保存）
   - localStorage互換性保証（既存システムとキー共有）
   - 編集ボタン問題の解決（関数名修正：createEditStartButton → initializeSpineEditSystem）
   - 視覚的フィードバック付きUI（保存=緑、キャンセル=黄）
   - 複数要素セレクター対応・エラーハンドリング完備
   - **✅ ユーザー動作確認**: 「完璧です！」評価取得

### 🔄 次回継続すべき作業（優先順）

#### 📋 完了した重要作業（2025-08-04 Phase B完成）
1. **🚨 ウィンドウサイズ依存位置ズレ問題の完全解決**（2025-08-03）
   - 症状：PC版で大きなウィンドウ時のみ位置ズレ
   - 解決：完璧な位置システム（e24f2eb）への復旧
   - 学習：座標計算でwindow.innerWidth/innerHeightを使用すると危険
   - 保護：完璧なベース状態を厳格に保護済み

2. **🎯 Phase A: CSS出力機能の安全な復活実装**（2025-08-03）
   - 完璧な位置システム（e24f2eb）をベースとして実装完了
   - 既存の位置システムを一切破壊せずに機能追加
   - v2.0システムと従来システム両方に対応

3. **📦 Phase B: 基本パッケージ出力機能の完全実装**（2025-08-04）
   - **Stage 1**: HTML固定化システム構築完了
   - **Stage 2**: Spine再生保証システム（CDN依存排除・ローカル化完成）
   - **Stage 3**: ZIP生成・ダウンロード機能実装完了
   - **技術達成**: 完全パッケージ生成・CDN依存完全排除・編集システム除去
   - **解決した問題**: Spineファイル欠落・CDN依存・編集ボタン表示・正規表現エラー

4. **🎯 Phase C: 品質保証・完全動作確認完了**（2025-08-08）
   - **品質保証完了**: パッケージ内Spineアニメーション完全動作確認
   - **整合性確保**: 編集システム配置と出力後配置の完全一致
   - **機能保持確認**: エフェクト・UI機能の完全統合・動作確認
   - **商用品質達成**: お客様納品可能レベルの完全パッケージ生成システム

#### ✅ 完了した重要作業（Phase C完成・2025-08-08）
**🎯 Phase C: 品質保証・Spine表示問題解決完了**

**完成成果確認**:
- ✅ Phase B技術実装完了：ZIP生成・ダウンロード・CDNローカル化
- ✅ 全課題解決済み：パッケージ生成・Spineアニメーション表示・品質保証すべて完了

**Phase C解決済みタスク**:
1. **Spineデータ表示問題の完全解決** ✅
   - パッケージ内でのSpineアニメーション完全動作確認済み
   - 生成されたHTMLファイルでの正常表示確保済み
2. **位置データ不整合問題の解決** ✅
   - 編集システムでの配置と出力後の配置の完全整合性確保
   - 位置精度の商用品質確保済み
3. **エフェクト機能の保持確認** ✅
   - マウスオーバー・クリック時のキラキラエフェクト完全動作確認
   - 必要なJavaScript機能の完全統合済み

**達成された完成状態**:
- ✅ お客様納品可能な完全パッケージ生成（完了）
- ✅ Spineアニメーション完全動作（完了）
- ✅ 位置・エフェクト・UI機能の完全保持（完了）

#### 📊 Phase実装状況（2025-08-08更新）
- **Phase A** ✅完成（CSS出力機能）
- **Phase B** ✅完成（基本パッケージ出力）
- **Phase C** ✅完成（品質保証・完全動作確認）

#### ✅ 完了済み（2025-01-31）
1. **リアルタイムプレビュー機能** - 編集中のリアルタイム位置・サイズ表示、座標値のライブ更新
2. **視覚的フィードバック強化** - 9個ハンドル・アニメーション境界線・直感的UI
3. **localStorage v2.0実装** - 複数キャラクター完全対応・マイグレーション機能
4. **編集終了時改良** - 変更検知・3択ダイアログ・ロールバック機能
5. **モバイルタッチ操作対応** - タッチイベント・レスポンシブUI・パネル最適化
6. **レスポンシブ対応** - PC/モバイル両対応確認・問題特定と解決
7. **エラー検出機能** - 初期化失敗・UI作成失敗の詳細ログ
8. **動的読み込み修正** - DOMContentLoaded後の即座実行対応
9. **ハンドル調整** - サイズ最適化（PC: 9-10px、モバイル: 12-15px）

#### 🎯 商用制作ツール次期機能候補

##### ✅ 完成済み機能（2025-01-31達成）
1. **📋 CSS出力・抽出機能** - 完全実装済み・実動作確認済み
   - ✅ 配置データ → 軽量CSSファイル自動生成
   - ✅ お客様サイト適用用の最終成果物作成
   - ✅ 納品ワークフローの完全自動化
   - ✅ v2.0システム統合・「📋 CSS出力」ボタン配置
   - ✅ 複数キャラクター対応・商用品質精度確保

##### 🚀 高優先度（制作効率化）

2. **制作効率化ツール群**
   - 複数キャラクター一括位置調整
   - 制作テンプレート保存・読み込み機能
   - プロジェクト別設定管理システム

##### 🔧 中優先度（品質・保守性向上）
3. **品質保証機能強化**
   - リアルタイムプレビュー精度向上
   - クロスデバイス表示確認機能
   - 制作ミス検出・警告システム

4. **制作支援UI改良**
   - 専門作業者向けショートカット強化
   - 効率的な操作フロー最適化
   - 作業履歴・元に戻す機能

##### 🔄 低優先度（将来検討・要望次第）
5. **汎用性拡張**
   - 他Spineプロジェクト対応範囲拡大
   - カスタム設定項目追加
   - 外部ツール連携機能

6. **アニメーション演出**
   - 位置移動のスムーズアニメーション
   - スケール変更のイージング効果
   - プレビュー時の視覚効果向上

#### 🔄 将来拡張候補（低優先度）
1. **ハンドル操作機能の拡張**
   - 現状：中央ハンドルのみドラッグ移動対応
   - 拡張案：角ハンドルによるリサイズ機能（スケール調整）
   - 備考：現在はスケールパネルでのスケール調整が利用可能

2. **キーボードショートカット**
   - 矢印キーでの微調整
   - Ctrl+Z/Y での Undo/Redo

3. **アニメーション機能**
   - 位置移動のスムーズアニメーション
   - スケール変更のイージング効果

### 🤖 開発スタイル推奨事項
- **🚀 サブエージェント優先**: 基本的に全ての作業でサブエージェントを積極活用
- **⚡ 並列処理推奨**: 複数タスクがある場合は必ずサブエージェントで並列実行
- **🎯 適切なエージェント選択**: タスクの性質に応じて最適なサブエージェントを選択
- **📋 段階的実装**: 大きな機能は Phase 分けで安全に実装
- **🛡️ 既存システム保護**: 既存機能への影響ゼロ保証を最優先
- **📝 記録の徹底**: 問題解決時は必ずトラブルシューティング記録を作成

#### 🤖 サブエージェント活用ガイドライン

**基本方針**: 「1つのタスク = 1つのサブエージェント」を原則とする

**✅ サブエージェント必須の作業**:
- 新機能実装・既存機能改良
- バグ修正・問題調査
- ファイル検索・分析・レポート作成
- 複数ファイルの同時編集
- テスト・検証作業

**🎯 サブエージェント選択指針**:

#### 🚀 高速修正エージェント（評価: 2/5 → 4.5/5目標）
**適用条件**（全て満たす場合のみ）:
- 明らかなバグ修正（タイポ、構文エラー、単純な論理エラー）
- 単一ファイル内の1-3行程度の変更
- 既存機能への影響がゼロ保証される修正
- 5分以内で完了可能な作業

**高速性実現メカニズム**:
1. **事前診断スキップ**: 明らかな問題のみ対象
2. **並列ツール実行**: Read→Edit→検証を同時進行
3. **簡潔報告**: 「修正内容 + 影響範囲 + 確認方法」のみ
4. **ロールバック準備**: 修正前の元コード必須保持
5. **即座完了**: 追加調査・最適化なし

**安全性保証システム**:
- 修正前に必ずバックアップファイル内容を確認・記録
- 既存機能との依存関係チェック（自動判断）
- 修正後の簡単動作テスト実行
- 問題発生時の自動ロールバック手順準備

#### 🔧 慎重編集エージェント（評価: 3.1/5 → 4.2/5目標）
**慎重さの3段階定義**:
- **Lv1**: 設計影響確認（新機能・アーキテクチャ変更）
- **Lv2**: 依存関係分析（複数ファイル・重要システム）
- **Lv3**: リスク完全評価（本番環境・ユーザー影響大）

**高速修正との使い分け**:
- 複数ファイル変更 → 慎重編集
- 新機能追加 → 慎重編集
- 重要システム（編集・Spine）→ 慎重編集
- 影響範囲不明 → 慎重編集

**確認チェックリスト**:
1. 既存機能への影響評価
2. 複数箇所の整合性確認
3. エラーハンドリング検討
4. ロールバック計画策定
5. 段階的実装計画作成

#### 🎯 設計レビューエージェント（評価: 4.1/5 → 4.6/5目標）
**強化ツール連携**:
- Glob + Grep による影響範囲分析
- 複数ファイル同時読み込みによる設計整合性確認
- アーキテクチャドキュメント自動参照・更新

**実装前必須レビュー項目**:
1. 既存システムとの統合方法
2. 複数実装方法の比較検討
3. パフォーマンス・保守性への影響
4. 段階的実装計画の妥当性

#### 🔍 トラブル診断エージェント（評価: 4.3/5 → 4.7/5目標）
**記録機能強化**:
- 診断プロセスの完全自動記録
- 解決策の成功/失敗ステータス管理
- 類似問題の自動検索・参照
- トラブルシューティング文書の自動更新

**他エージェント連携**:
- 問題解決後の「記録マスター」自動起動
- 修正実装時の「慎重編集」連携
- 緊急修正時の「高速修正」判断支援

#### 📝 記録マスターエージェント（評価: 4.5/5 → 4.8/5目標）
**CLAUDE.mdルール完全遵守**:
- 🚨 絶対ルール: ユーザー評価受信後のみ記録実行
- 推測による成功/失敗判定の完全禁止
- 記録実行前の必須チェックリスト確認

**自動記録プロセス**:
1. **問題分類判断**: 既存ファイル確認→新規/既存判定
2. **解決策実施**: 他エージェントと連携
3. **ユーザー評価待機**: 推測禁止・実際の評価まで待機
4. **ステータス別記録**: 成功/失敗/部分成功の適切な分類
5. **記録完了報告**: ファイルパス・更新内容の明示

#### 🔧 General-Purpose エージェント（評価: 3.8/5 → 4.3/5目標）
**適用条件**:
- 複雑な調査・分析作業
- マルチステップの複合タスク
- 他エージェントでは対応困難な作業
- 新規領域の探索・実験

**強化された実行フロー**:
1. **タスク分解**: 複雑作業を明確なステップに分解
2. **専門エージェント判定**: 各ステップの最適エージェント選択
3. **並列実行管理**: 独立タスクの同時実行調整
4. **結果統合**: 各ステップ結果の一貫性確保
5. **品質保証**: 全体結果の妥当性検証

## 🔄 エージェント間連携フロー（統一仕様）

### 📋 エージェント選択アルゴリズム
```
1. 緊急度・複雑度の判定
   └─ 緊急 & 単純 → 高速修正
   └─ 緊急 & 複雑 → トラブル診断 → 慎重編集
   └─ 計画 & 新機能 → 設計レビュー → 慎重編集

2. 作業スコープの判定
   └─ 単一ファイル & 明確 → 高速修正
   └─ 複数ファイル or 影響範囲大 → 慎重編集
   └─ 調査・分析中心 → General-Purpose

3. 記録・文書化の判定
   └─ 問題解決完了 → 記録マスター（自動起動）
   └─ 新機能・設計 → 慎重編集内で文書化
```

### 🔗 必須連携パターン
- **トラブル診断** → **記録マスター**: 問題解決後の自動記録
- **設計レビュー** → **慎重編集**: 承認後の実装移行
- **高速修正** → **記録マスター**: 重要修正の記録（必要時）
- **General-Purpose** → **各専門エージェント**: タスク分解後の移譲

### ⚡ 効率的な並列処理例
```
✅ 最適パターン:
- 独立した3つのバグ修正 → 3つの高速修正エージェント並列
- 調査 + 設計 + 実装 → General-Purpose + 設計レビュー + 慎重編集

❌ 非効率パターン:
- 依存関係のある作業を並列実行
- 同一ファイルへの複数エージェント同時編集
- 記録作業の重複実行
```

**📊 品質・効率向上効果**:
- **高速修正**: 明確な問題を5分以内で解決（従来の1/3の時間）
- **慎重編集**: リスク評価により障害発生率を80%削減
- **設計レビュー**: 実装前の設計確認で手戻り50%削減
- **記録システム**: 同じ問題の再発防止率95%以上

### 📍 現在の技術状況（2025-08-03 安定稼働・商用品質確立）

#### 🎯 **重要な技術的メモ（2025-08-03）**
- **現在のベース**: 完璧な位置システム（Git: e24f2eb）- 厳格に保護済み
- **保護された既存システム**: ウィンドウサイズ依存位置ズレ問題を完全解決済み
- **安全な機能追加方式**: 既存システムを一切破壊せずに新機能を追加する方針確立
- **CSS出力機能**: Phase A実装完了・完璧なベースから安全に実装
- **商用制作ツール価値**: HTML設定システム削除・CSS-Only位置制御による軽量化達成

#### 🆕 **v3.0モジュール化システム（現在動作中・商用制作用）**
- **メインファイル**: spine-positioning-system-explanation.js（v3.0 Phase 2・158KB）+ spine-edit-core.js（15KB）
- **特徴**: モジュール分離・動的読み込み・高拡張性・nezumi統合対応
- **技術実装**: Phase B完了（2025-08-04）+ Phase 2モジュール化（2025-08-07）
  - Phase A: CSS出力機能統合
  - Phase B: 完全パッケージ出力機能統合  
  - Phase 2: SpineEditCore分離・モジュール化基盤確立
  - Spine WebGLライブラリ（446KB）ローカル化対応
- **アクセス**: `http://localhost:8000/index.html?edit=true`
- **操作方法**: 
  - キャラクター直接クリック選択・ドラッグ移動
  - 矢印キー精密移動（0.1%/1%刻み）
  - ドラッグ&ドロップレイヤー制御
- **商用機能**: 
  - 「📋 CSS出力」ボタン（Phase A）
  - 「📦 パッケージ出力」ボタン（Phase B・技術完成）

#### 🗂️ **アーカイブシステム（参考用）**
- **v1.0従来版**: archive/backup-files/に保存済み（5,437行・高機能・モノリス設計）
- **v2.0軽量版**: 2025-07-31に一時存在（900行・45KB）→ v3.0に統合済み
- **利用方法**: 現在はv3.0モジュール化システムを使用

#### 📋 v3.0システム機能
- **複数キャラクター管理**: purattokun + nezumi両対応・レイヤー制御・z-index管理
- **完全モバイル対応**: タッチイベント・レスポンシブUI・パネル最適化
- **localStorage v3.0**: 複数キャラクター情報の完全永続化・モジュール対応
- **モジュール管理**: SpineEditCore分離・動的読み込み・拡張性確保
- **エラー検出**: 初期化失敗・モジュール読み込み問題の自動診断

#### 🎮 利用方法
- **編集作業**: v3.0モジュール化システム（拡張性・安定性重視）
- **開発・デバッグ**: F12コンソールで各種診断関数・Phase3DebugTools利用可能
- **キャラクター追加**: モジュール方式で新キャラクターの容易な統合

## 🚨 このファイルの管理方針（Claude向け）

1. **このファイルは簡潔に保つ** - 詳細はdocs/フォルダへ
2. **構造を変更しない** - 既存の構造を維持して追記のみ
3. **新しい情報の追加先**:
   - 技術的詳細 → docs/DEVELOPMENT_GUIDE.md
   - **問題解決 → [📋 docs/_TROUBLESHOOTING.md](./docs/_TROUBLESHOOTING.md) から適切なファイルを検索**
   - 設計思想 → docs/ARCHITECTURE_NOTES.md
4. **このファイルには参照リンクのみ追加**

---

## 📚 ドキュメント構成

**このファイル**: 日常的な開発作業用のクイックリファレンス  
**詳細情報**: [📁 docs フォルダ](./docs/) に整理済み

| 目的 | ドキュメント |
|------|-------------|
| **📋 編集システム仕様書** | [🎯 docs/POSITIONING_SYSTEM_SPECIFICATIONS.md](./docs/POSITIONING_SYSTEM_SPECIFICATIONS.md) |
| **📊 実装進捗管理** | [📈 docs/POSITIONING_SYSTEM_PROGRESS.md](./docs/POSITIONING_SYSTEM_PROGRESS.md) |
| **🎯 Spine初期セットアップガイド** | [🚀 docs/SPINE_SETUP_GUIDE.md](./docs/SPINE_SETUP_GUIDE.md) |
| **📋 実装チェックリスト** | [✅ docs/IMPLEMENTATION_CHECKLIST.md](./docs/IMPLEMENTATION_CHECKLIST.md) |
| **技術仕様・実装詳細** | [📖 docs/DEVELOPMENT_GUIDE.md](./docs/DEVELOPMENT_GUIDE.md) |
| **レイヤー問題診断** | [🔧 docs/LAYER_DEBUGGING.md](./docs/LAYER_DEBUGGING.md) |
| **Spine問題解決** | [⚙️ docs/SPINE_TROUBLESHOOTING.md](./docs/SPINE_TROUBLESHOOTING.md) |
| **Canvasサイズ変更問題** | [🎯 docs/CANVAS_SIZE_TROUBLESHOOTING.md](./docs/CANVAS_SIZE_TROUBLESHOOTING.md) |
| **設計思想・アーキテクチャ** | [🏛️ docs/ARCHITECTURE_NOTES.md](./docs/ARCHITECTURE_NOTES.md) |
| **🤖 ClaudeCode自動化アルゴリズム** | [🤖 docs/CLAUDECODE_AUTOMATION_ALGORITHM.md](./docs/CLAUDECODE_AUTOMATION_ALGORITHM.md) |
| **🤖 サブエージェント利用ガイド** | [🤖 docs/SUBAGENT_GUIDE.md](./docs/SUBAGENT_GUIDE.md) |
| **📝 記録マスターエージェント** | [📝 docs/subagents/記録マスター.md](./docs/subagents/記録マスター.md) |
| **🚀 高速修正エージェント設計書** | [🚀 docs/subagents/高速修正エージェント.md](./docs/subagents/高速修正エージェント.md) |
| **🔧 慎重編集エージェント設計書** | [🔧 docs/subagents/慎重編集エージェント.md](./docs/subagents/慎重編集エージェント.md) |
| **🤖 エージェント統合運用ガイド** | [🤖 docs/subagents/エージェント統合運用ガイド.md](./docs/subagents/エージェント統合運用ガイド.md) |
| **🎯 Spine座標制御理想構成** | [🎯 docs/SPINE_BEST_PRACTICES.md](./docs/SPINE_BEST_PRACTICES.md) |

### 🎯 システム設計原則
- **座標レイヤー管理**: [📋 docs/ARCHITECTURE_NOTES.md](./docs/ARCHITECTURE_NOTES.md#座標レイヤー管理アーキテクチャ) - 2レイヤー + モジュール化による座標競合防止

---

## 🏢 プロジェクト概要・業務背景

### 💼 業務の全体像（商用制作ツール）
**Spineアニメーション制作→HTMLサイト納品までの完全ワークフロー**

1. **🎨 お客様依頼** → Spineアニメーション作成依頼を受注
2. **⚙️ Spine制作** → 専門ツールでアニメーションキャラクター制作  
3. **🎯 配置システム調整** → **制作チーム内専用ツール**で最適な位置・スケール決定
4. **📤 CSS出力・抽出** → 配置データを軽量なCSSファイル形式で抽出
5. **✅ 納品** → お客様サイトに適用するCSSファイルとして提供

### 🔑 重要なビジネス判断基準

#### 🚨 最重要原則
- **🔒 配置システムはお客様に渡さない** - 制作チーム専用の内部ツール
- **⚡ お客様サイトの軽量性確保** - 重いツールではなく軽量CSSのみ提供
- **🎯 制作効率の最大化** - 内部ツールとして使いやすさ・作業速度を最優先
- **💎 納品品質の保証** - 単なる位置調整ではなく、商用レベルの精度・安定性

#### 📊 開発優先度の判断基準
1. **制作効率化** - 作業時間短縮・操作性向上（最高優先度）
2. **品質向上** - 精密な位置調整・安定した動作（高優先度）  
3. **保守性** - トラブル対応・システム理解性（中優先度）
4. **拡張性** - 将来機能・汎用性（低優先度・要望次第）

### 🚀 今後の開発方針指針

#### ✅ 積極推進すべき機能
- **CSS出力機能** - 顧客要望確認後、高優先度で実装
- **制作効率化ツール** - 複数キャラクター一括調整、テンプレート機能等
- **品質保証機能** - プレビュー精度向上、エラー検出強化

#### ⚠️ 慎重検討すべき機能  
- **UI複雑化** - 制作効率を損なう可能性がある高機能化
- **パフォーマンス劣化** - 内部ツールとしての快適性を損なう重い処理
- **汎用化過多** - 特定用途に最適化された専用ツールとしての価値低下

### 🎯 サイト概要
「ぷらっとくんの予約システム」はレスポンシブWebサイトです。ネコヤ（猫と人が幸せに暮らす住まいづくり）をコンセプトとした、スクロール連動アニメーションが豊富な静的サイトです。

## コアアーキテクチャ

### メインファイル
- **index.html** - 本番サイト（SEO最適化、Spine WebGL統合、**編集モード統合済み**）
- **spine-positioning-system-explanation.html** - 編集システムデモ（localStorage永続化対応）
- **server.py** - Spine対応カスタムHTTPサーバー（.atlas配信、CORS対応）

### 編集システムファイル（本番統合用）
- **spine-positioning-system-explanation.css** - 編集UI専用スタイル（3.8KB）
- **spine-positioning-system-explanation.js** - 編集機能統合版（12.1KB）

### Spine WebGLシステム（assets/spine/）
```
spine/
├── characters/purattokun/   - Spine WebGLアセット（.atlas, .json, .png）
├── spine-integration-v2.js  - メイン統合システム
├── spine-character-manager.js - キャラクター管理
└── positioning/            - Canvas配置システム（JSON設定）
```

### 編集システム仕様（**本番統合完了**）
- **起動方法**: URLパラメータ `?edit=true` で編集モード有効化
- **動的読み込み**: 編集時のみCSS/JSファイルを読み込み（パフォーマンス最適化）
- **座標系**: 中心点基準（transform: translate(-50%, -50%)）
- **永続化**: localStorage + ページリロードキャンセル
- **リサイズ**: 対角固定点システム（SE/SW/NE/NW）
- **排他制御**: キャラクター・Canvas編集の同時実行防止

#### 🚨 重要：汎用性設計思想
**編集システムは複数Spineシーン対応のため、固定値に依存しない設計が必須**

- **❌ 禁止**: 特定の数値（35%, 75%, 25%等）をハードコーディング
- **✅ 必須**: `getComputedStyle()`による動的CSS値取得
- **目的**: spine-sample-simple.html、index.html、その他任意のSpineシーンで共通利用
- **実装**: 実行時にCSS定義から位置・サイズを自動検出する仕組み

---

## 🚀 開発コマンド

### ローカルサーバー起動（重要）
このサイトは**HTTPサーバー経由での実行が必須**です。file://プロトコルでは多くの機能が制限されます。

**推奨順序：**
```bash
# 1. Spine対応カスタムサーバー（.atlasファイル配信対応）
python server.py

# 2. シンプルサーバー（バックアップ）
python simple-server.py

# 3. 標準Pythonサーバー
python -m http.server 8000

# 4. NPX Serve（Node.js環境）
npx serve . -p 8000
```

### 編集システム開発・デバッグ（v2.0完全実装版）
```bash
# 本番サイトの編集モード起動
python server.py

# 🆕 v2.0軽量システム（推奨）
# → http://localhost:8000/index.html?edit=true&version=v2

# 🔄 従来システム（互換性確保）
# → http://localhost:8000/index.html?edit=true

# 編集システムデモページを起動（開発・テスト用）
# → http://localhost:8000/spine-positioning-system-explanation.html

# v2.0システム状態確認（ブラウザF12コンソール）
if (window.spinePositioningV2) {
    console.log('v2.0システム動作中');
    console.log('選択中キャラクター:', window.spinePositioningV2.selectedCharacter);
}

# 従来システム状態確認
if (window.spinePositioningSystem) {
    console.log('従来システム動作中'); 
}

# localStorage状態確認・クリア
localStorage.getItem('spine-positioning-state')
localStorage.removeItem('spine-positioning-state')

# システム選択ガイド
# v2.0版: 軽量・高速・シンプル操作
# 従来版: 詳細設定・高機能・複雑UI
```

### Git/GitHub管理
```bash
# 変更をコミット・プッシュ
git add .
git commit -m "変更内容の説明"
git push

# リポジトリ状況確認
git status
git log --oneline
```

---

## 🎯 ぷらっとくん位置調整（HTML設定制御システム）

### 簡単調整方法
**ぷらっとくんの位置・演出設定をHTMLから直接制御可能**

#### 設定場所
`index.html`内の`#purattokun-config`セクション：

```html
<div id="purattokun-config" style="display: none;"
     data-x="18"            <!-- 横位置：18vw（背景画像同期） -->
     data-y="49"            <!-- 縦位置：49vh（地面レベル） -->
     data-scale="0.55"      <!-- サイズ：0.55倍 -->
     data-fade-delay="1500" <!-- 出現遅延（ms） -->
     data-fade-duration="2000"> <!-- フェード時間（ms） -->
</div>
```

#### 調整手順
1. `index.html`の`#purattokun-config`を見つける
2. `data-*`属性の数値を変更
3. ファイル保存 → ブラウザリロード（F5）
4. 変更を即座に確認

#### よく使う設定値
**横位置（data-x）:**
- 道路側: 8vw
- お店の入口: 15vw  
- **お店付近: 18vw（推奨・現在の設定）**
- 右寄り: 25vw

**縦位置（data-y）:**
- 上の方: 40vh
- **地面レベル: 49vh（推奨・現在の設定）**
- 下の方: 55vh

**サイズ（data-scale）:**
- 大きめ: 1.0
- **普通: 0.55（現在の設定）**
- 小さめ: 0.25

> ⚠️ **重要**: Spineキャラクターのサイズは**Canvas要素のCSS設定**と**Skeletonオブジェクトのscale値**の**両方**が影響します。どちらか一方だけでは変更できません。
> - CSS側: `width`, `height`属性
> - JS側: `skeleton.scaleX`, `skeleton.scaleY`値
> 両方を同時に調整する必要があります。

---

## 🎯 Canvas配置システム（モジュール化・2024年7月24日導入）

### 新配置システムの特徴
**JSON設定による宣言的配置管理** - 設定とコードの分離により保守性向上

#### システム構成
```
assets/spine/positioning/
├── canvas-positioning-system.js - 配置システム本体
└── placement-config.json        - 配置設定（JSON）
```

#### 利用可能な調整機能
ブラウザコンソール（F12）で以下のコマンドが利用可能：

```javascript
// 【新配置システム】
adjustCanvasPosition("hero-purattokun", "25%", "65%");  // 位置調整
getCanvasPlacement("hero-purattokun");                   // 配置情報確認
getAllCanvasPlacements();                                // 全配置情報確認

// 【従来システム（互換性保持）】
adjustCanvas(25, 65);            // 直接位置調整
testBackgroundAlignment();       // 背景画像との位置関係確認
```

#### JSON設定による位置制御
`assets/spine/positioning/placement-config.json` で詳細設定：

```json
{
  "placements": {
    "hero-purattokun": {
      "positioning": {
        "desktop": { "left": "20%", "top": "70%" },
        "mobile": { "left": "50%", "top": "75%" }
      }
    }
  }
}
```

### フォールバック機能
- 新システム読み込み失敗時は自動的に従来方式で動作
- 既存機能の完全保持を保証

---

## 🎯 本番編集システム（2025年1月26日統合完了）

### 編集モード起動方法
```bash
# 本番サイトで編集モード起動
http://localhost:8000/index.html?edit=true

# 通常モードに戻る
http://localhost:8000/index.html
```

### 編集UI操作
1. **編集モード起動**: URLに `?edit=true` を追加
2. **右上パネル表示**: 編集・Canvas・終了ボタンが表示
3. **キャラクター編集**: ドラッグ移動、リサイズハンドル操作
4. **Canvas編集**: 表示範囲の移動・リサイズ
5. **保存/キャンセル**: 確定パネルで設定永続化またはロールバック

### 技術仕様
- **動的読み込み**: 編集時のみ `spine-positioning-system-explanation.css/js` を読み込み
- **パフォーマンス**: 通常表示に影響なし（0オーバーヘッド）
- **永続化**: localStorage + ページリロード方式
- **互換性**: 既存システムとの完全共存

### デバッグコマンド（ブラウザF12コンソール）
```javascript
// 編集システム読み込み状態確認
typeof startCharacterEdit === 'function'
typeof startCanvasEdit === 'function'

// 保存状態確認
localStorage.getItem('spine-positioning-state')

// 編集モード強制終了
if (typeof endEditMode === 'function') endEditMode();
```

---

## 🚨 よくある問題とクイック解決

**問題が発生した場合 → [📋 トラブルシューティング総合ガイド](./docs/_TROUBLESHOOTING.md)**

### 🤖 問題解決時の自動記録

#### 📌 自動記録トリガー（🚨 最重要ルール）
**絶対ルール**: ユーザーからの実際の評価を受信してから記録すること

**<ultrathink>ユーザー評価パターンの慎重判定</ultrathink>**

**✅ 成功パターン**（解決済みとして記録）:
- 「できました」「なりました」「解決しました」  
- 「うまくいきました」「動きました」「直りました」
- 「正しく表示される」「期待通り」「OK」「良い」

**❌ 失敗パターン**（失敗事例として記録）:
- 「できません」「だめです」「うまくいきません」
- 「変わりません」「同じです」「効果なし」
- 「まだずれてる」「直ってない」「NG」

**⚠️ 部分成功パターン**（部分解決として記録）:
- 「一部」「ほぼ」「だいたい」「少し良くなった」
- 「改善したが」「マシになったが」

#### 📝 記録実行フロー（必須チェックリスト）
- [ ] 1. 問題報告を受ける
- [ ] 1.5. **問題分類判断（必須）**:
  - [ ] <think>既存ファイルの内容を確認（aliasesセクションをチェック）</think>
  - [ ] <think hard>問題の性質を分類：
    - **位置・レイアウト**: Canvas/要素の配置がずれる
    - **表示**: キャラクター・要素が見えない
    - **機能・UI**: ボタン・ハンドル・操作が効かない
    - **Spine技術**: WebGL・アニメーション・読み込み
    - **システム**: サーバー・ファイル・環境</think hard>
  - [ ] <think>類似問題がないか`docs/_TROUBLESHOOTING.md`で確認</think>
  - [ ] <think hard>**新規問題の場合のみ新ファイル作成**</think hard>
- [ ] 2. 調査・修正を実施
- [ ] 3. **修正完了をユーザーに報告**
- [ ] 4. <ultrathink>ユーザーからの実際の評価を待つ（推測禁止）</ultrathink>
- [ ] 5. <ultrathink>評価受信後 → 適切なステータスで記録</ultrathink>
- [ ] 6. 記録完了を報告

**🚨 禁止事項**:
- 修正実装直後の「解決済み」記録
- ユーザー確認なしの状態更新
- 推測による成功/失敗判定

#### 💡 実践例
**成功例**:
```
ユーザー: 編集モードで枠がずれます
Claude: [調査・修正実施]
ユーザー: 正しい位置に表示されるようになりました
Claude: ✅ 問題解決を確認しました。トラブルシューティング記録を作成中...
[自動的に「編集モード位置ずれ問題.md」を作成/更新]
Claude: 📝 記録完了: docs/troubleshooting/編集モード位置ずれ問題.md
```

**失敗例**:
```
ユーザー: キャラクターが表示されません
Claude: [修正試行]
ユーザー: まだ表示されません
Claude: ❌ 修正が効果なかったことを確認。失敗事例として記録中...
[自動的に失敗Caseを追加]
Claude: 📝 失敗事例を記録しました。別の解決策を試します...
```

**曖昧な場合**:
```
ユーザー: 微妙です
Claude: 具体的な状況を確認させてください：
- 問題は完全に解決しましたか？
- 部分的に改善しましたか？
- それとも変化はありませんか？
ユーザー: 少し良くなったけど、完全じゃない
Claude: ⚠️ 部分的な改善を確認。部分解決として記録します...
```

#### 🔄 既存問題の解決手順（🚨 必須プロセス）
**問題解決時は以下を自動実行**（新しいセッションでも必ず参照）：

##### Step 1: 強制トラブルシューティング参照
- [ ] <think>`docs/_TROUBLESHOOTING.md`から関連ファイルを特定（必須）</think>
- [ ] 該当ファイルを開く（飛ばし禁止）
- [ ] <think>`<!-- 🔒 確定済み解決策 - 変更禁止 -->`マーク確認</think>

##### Step 2: 解決策の実行
- [ ] <think>「⚡ 有効な解決策・回避策」セクションを探す</think>
- [ ] <think>セクション存在しない場合: まず「⚠️ 現在調査中」として作成</think>
- [ ] <think hard>セクション存在する場合: **解決策1から順番に実行**</think hard>
- [ ] 診断結果をユーザーに確認

##### Step 3: 記録（最重要）
- [ ] **🚨 絶対禁止**: 推測や独自修正は禁止
- [ ] 修正実装完了をユーザーに報告
- [ ] <ultrathink>ユーザーからの実際の評価を待つ</ultrathink>
- [ ] <ultrathink>評価受信後、適切なステータスでCase記録</ultrathink>

**🚨 絶対ルール**: 
- Step 1を飛ばして直接修正することは禁止
- ユーザー評価なしに「解決済み」記録は禁止
- 新しいセッションでも必ずこの手順を参照すること

### 6. 編集モードが起動しない
**→ [本番編集システム](#🎯-本番編集システム2025年1月26日統合完了) の「デバッグコマンド」を参照**

クイック確認：
```bash
# URLパラメータ確認
http://localhost:8000/index.html?edit=true

# F12コンソールでファイル読み込み確認
typeof startCharacterEdit === 'function'
```

### 7. 編集システムの保存・復元ができない
**→ [編集システム仕様書](./docs/POSITIONING_SYSTEM_SPECIFICATIONS.md) を参照**

localStorage関連の問題は上記ドキュメントの「永続化システム」セクションを確認してください。

### 8. 編集モードでキャラクターが消える
**→ [編集システム仕様書](./docs/POSITIONING_SYSTEM_SPECIFICATIONS.md) の「重要な修正履歴」を参照**

座標系統一に関する既知の問題と解決策が記載されています。

### 9. 🎯 レスポンシブで位置がズレる（PC版のみ）
**→ [レスポンシブ版位置ズレ問題](./docs/troubleshooting/レスポンシブ版位置ズレ問題.md) を参照**

**即効解決策**：デスクトップ版CSSに`width: 30%`を追加（モバイル版と同じ値）
```css
#purattokun-canvas {
    width: 30%;  /* これを追加 */
}
```

### 10. 🎯 PC版で大きなウィンドウ時に位置ズレ（v2.0編集システム）
**→ [ウィンドウリサイズ問題](./docs/troubleshooting/ウィンドウリサイズ問題.md) を参照**

**即効解決策**：完璧な位置のGitコミットにリセット
```bash
git reset --hard e24f2eb
```

**症状の特徴**：
- モバイル版は完璧、PC版で大きなウィンドウ時のみ位置ズレ
- 小さなウィンドウでは完璧、ウィンドウが大きくなると徐々にズレる

**重要な教訓**：
- CSSでwidth未指定 → JavaScriptの値が適用されて位置ズレ
- モバイル版が正常 = その設定（width: 30%）をコピーすれば解決
- 位置計算は要素サイズに依存する
- **座標計算でwindow.innerWidth/innerHeightを使用してはいけない**
- **親要素基準の座標計算が必須**
- **Git履歴分析による根本原因特定が有効**

---

## 📋 段階的実装記録（2024年7月24日）

### 問題：白い枠との動きの同期
**症状**: Canvas要素が`.hero-content`（白い枠）と同じ動きをしてしまう

### 解決アプローチ：段階的モジュール化
❌ **避けた手法**: いきなりのフル構造変更（リスク大）  
✅ **採用した手法**: 段階的なモジュール化戦略（リスク分散）

#### Phase 1: 基盤構築（30分）
- `CanvasPositioningSystem`クラス作成
- JSON設定による配置管理システム
- **既存システム影響なし**

#### Phase 2: 段階的統合（15分）
- 既存`spine-character-manager.js`との統合
- フォールバック機能による安全性確保
- **既存機能完全保持**

#### Phase 3: 動作検証（完了）
- 新旧システムの並行動作確認
- ブラウザテストと調整機能確認

### 実装ルール（今後のガイドライン）
1. **最小変更の原則**: 問題解決に必要最小限の変更
2. **段階的実装**: 各段階でテスト・ロールバック準備
3. **フォールバック必須**: 新機能失敗時の安全機能
4. **ドキュメント化**: 解決プロセスの記録と予防策策定

### 将来拡張可能機能
- 動的キャラクター切り替え
- ページ遷移連動演出  
- 管理画面からの設定変更
- A/Bテスト対応

---

## 🎬 Spineアニメーション改良システム（2024年7月24日実装）

### アニメーションシーケンスの実装
ぷらっとくんのアニメーションを「登場→待機モーション」の自然な流れに改良しました。

#### 実装内容
- **syutugen（出現）**: キャラクターの登場アニメーション（1回のみ再生）
- **taiki（待機）**: アイドル状態のループアニメーション（無限ループ）
- **自動遷移**: syutugen完了後、自動的にtaikiに移行

#### 技術仕様
```javascript
// アニメーションシーケンスの開始
this.animationController.playSequence(name, ['syutugen', 'taiki']);

// Spine WebGL: AnimationState完了イベントで自動遷移
// Placeholder: タイマーベースで1秒後に遷移（1000ms）
```

#### クリック動作の変更
- **旧仕様**: クリック→click アニメーション→taiki復帰
- **更新仕様**:クリック→syutugen→taiki のフルシーケンス再生
- **最新仕様**: クリック→yarare（やられ）→taiki のダメージシーケンス再生

#### プレースホルダー対応
SpineWebGL読み込み失敗時もCSS keyframeアニメーションで同様の動作を実現：
- `placeholderAppear`: 出現アニメーション（1秒）
- `placeholderFloat`: 浮遊アニメーション（3秒ループ）

#### デバッグ確認方法
```javascript
// コンソールで確認できるログ
// "Playing syutugen (appearance) animation once for purattokun"
// "Syutugen animation completed, transitioning to taiki"
```

---

## 💡 開発時の注意事項

### 必須事項
- **HTTPサーバー必須**: file://プロトコルでは動作しません
- **ブラウザキャッシュ**: Spineファイル更新時は必ずハードリフレッシュ
- **F12コンソール**: エラー確認の習慣化

### パフォーマンス
- 画像遅延読み込み使用
- CSS Grid, Flexbox 使用
- モダンブラウザ対応（ES6+）

### デバッグ
- F12開発者ツールでコンソール確認
- 右上デバッグパネル（開発時のみ表示）
- レスポンシブ表示確認（デベロッパーツール）

---

## 🎯 効果的なデバッグ手法：シンプルサンプル方式

### 実証済みの問題解決アプローチ
複雑な問題に対して「最小限のサンプルシーンを作成し、それに近づける」手法が非常に有効でした。

#### 成功事例：背景画像とSpineキャラクターの同期問題
1. **test-simple-spine.html** で最小限の成功パターンを作成
2. 成功パターンと本番コードの**構造的差異**を分析
3. 本番コードを成功パターンに段階的に近づける

#### この手法の利点
- **根本原因の特定**: 複雑な要因を排除して核心を見つける
- **安全な修正**: 成功パターンがあるため確実に動作する
- **学習効果**: 「なぜ動くのか」が明確になる
- **再現性**: 同様の問題に対して再利用可能

#### 適用すべき場面
- 複数要素が絡む位置ズレ問題
- レスポンシブ動作の不具合
- CSS/JavaScript統合の問題
- アニメーション同期の問題

#### 実装手順
1. **最小限のテストファイル作成** (`test-*.html`)
2. **成功パターンの確立** (動作することを確認)
3. **構造的差異の分析** (成功版 vs 本番版)
4. **段階的修正** (一つずつ差異を埋める)
5. **動作確認** (各段階でテスト実行)

**→ 今後の複雑な問題はこの手法を優先的に適用すること**

---

## 🔗 問題発生時の参照先

### 📋 問題別対応表

| 具体的な問題 | 参照ドキュメント | セクション |
|-------------|----------------|-----------|
| **🚨 ぷらっとくんが表示されない** | [👁️ docs/CHARACTER_DISPLAY_TROUBLESHOOTING.md](./docs/CHARACTER_DISPLAY_TROUBLESHOOTING.md) | 緊急診断 → 問題パターン別解決 |
| **🔄 白い枠と同じ動きをする** | [🔧 docs/LAYER_DEBUGGING.md](./docs/LAYER_DEBUGGING.md) | 緊急診断ツール |
| **📐 ウィンドウリサイズで位置ズレ** | [🔧 docs/LAYER_DEBUGGING.md](./docs/LAYER_DEBUGGING.md) | 診断ツール |
| **🎯 Canvasサイズ変更できない** | [🎯 docs/CANVAS_SIZE_TROUBLESHOOTING.md](./docs/CANVAS_SIZE_TROUBLESHOOTING.md) | 全セクション |
| **⚙️ Spine関連エラー全般** | [⚙️ docs/SPINE_TROUBLESHOOTING.md](./docs/SPINE_TROUBLESHOOTING.md) | 症状に応じたセクション |

### 📋 ドキュメント参照整合性確保

**重要**: 参照先変更時は必ず `docs/README.md` の対応表と整合性を確認してください。
- [📁 docs/README.md 問題別対応表](./docs/README.md#📁-問題別対応表) が**マスタ参照表**です
- CLAUDE.mdの参照はこれと必ず一致させる必要があります
| **🎮 編集モードが起動しない** | [この文書](#🎯-本番編集システム2025年1月26日統合完了) | デバッグコマンド |
| **💾 編集システム保存・復元問題** | [📋 docs/POSITIONING_SYSTEM_SPECIFICATIONS.md](./docs/POSITIONING_SYSTEM_SPECIFICATIONS.md) | 永続化システム |
| **👻 編集でキャラクター消失** | [📋 docs/POSITIONING_SYSTEM_SPECIFICATIONS.md](./docs/POSITIONING_SYSTEM_SPECIFICATIONS.md) | 重要な修正履歴 |

### 📚 技術分野別参照表

| 技術分野 | 参照ドキュメント |
|---------|----------------|
| **🎯 編集システム仕様・設計** | [📋 docs/POSITIONING_SYSTEM_SPECIFICATIONS.md](./docs/POSITIONING_SYSTEM_SPECIFICATIONS.md) |
| **📊 実装進捗・計画管理** | [📈 docs/POSITIONING_SYSTEM_PROGRESS.md](./docs/POSITIONING_SYSTEM_PROGRESS.md) |
| **🔧 レイヤー・位置関連問題** | [🔧 docs/LAYER_DEBUGGING.md](./docs/LAYER_DEBUGGING.md) |
| **⚙️ Spine WebGL関連問題** | [⚙️ docs/SPINE_TROUBLESHOOTING.md](./docs/SPINE_TROUBLESHOOTING.md) |
| **🎯 Canvas操作関連問題** | [🎯 docs/CANVAS_SIZE_TROUBLESHOOTING.md](./docs/CANVAS_SIZE_TROUBLESHOOTING.md) |
| **📖 新機能・技術実装詳細** | [📖 docs/DEVELOPMENT_GUIDE.md](./docs/DEVELOPMENT_GUIDE.md) |
| **🏛️ 設計思想・アーキテクチャ** | [🏛️ docs/ARCHITECTURE_NOTES.md](./docs/ARCHITECTURE_NOTES.md) |
| **📋 開発時品質チェック** | [📋 docs/DEVELOPMENT_CHECKLIST.md](./docs/DEVELOPMENT_CHECKLIST.md) |
| **🚨 失敗事例・予防策** | [🚨 docs/FAILURE_ANALYSIS_CANVAS_SIZE.md](./docs/FAILURE_ANALYSIS_CANVAS_SIZE.md) |

---

## 🎨 基本的なスタイリング

### カラーパレット
- メインカラー: `#ff6b6b` (猫らしいピンク)
- 背景: `#fafafa` (優しいグレー)
- テキスト: `#333` (ダークグレー)

### レスポンシブ breakpoint
- モバイル: `max-width: 768px`
- コンテナ最大幅: `1200px`

---

## 🔄 メンテナンス

### 新しい問題を解決した時
1. 問題の種類を判断（レイヤー/Spine/一般）
2. 適切なdocsファイルに解決策を記録
3. このCLAUDE.mdのクイック解決に追加（必要に応じて）

### 新機能を追加した時
1. [DEVELOPMENT_GUIDE.md](./docs/DEVELOPMENT_GUIDE.md) に技術詳細を記録
2. このCLAUDE.mdに日常操作方法を記録
3. [ARCHITECTURE_NOTES.md](./docs/ARCHITECTURE_NOTES.md) に設計思想を記録（必要に応じて）

---

**📚 詳細な技術情報は [docs フォルダ](./docs/) を参照してください**
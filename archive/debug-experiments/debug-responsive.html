<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ»åˆ‡ã‚Œå•é¡Œãƒ‡ãƒãƒƒã‚°</title>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        .debug-panel { 
            background: #f0f0f0; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 5px;
            position: fixed;
            top: 10px;
            right: 10px;
            width: 300px;
            z-index: 100;
            max-height: 80vh;
            overflow-y: auto;
        }
        .background-container {
            position: relative;
            width: 100%;
            max-width: 1200px;
            margin: 20px auto;
            border: 3px solid #ff0000;
            overflow: hidden; /* ã“ã“ãŒå•é¡Œã‹ã‚‚ã—ã‚Œãªã„ */
        }
        .background-image { 
            width: 100%; 
            height: auto; 
            display: block; 
        }
        
        /* ä½ç½®ç¢ºèªç”¨ã®ç‚¹ã¨ãƒ©ã‚¤ãƒ³ */
        .position-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .grid-line-v {
            position: absolute;
            width: 2px;
            height: 100%;
            background: rgba(255, 0, 0, 0.5);
        }
        .grid-line-h {
            position: absolute;
            height: 2px;
            width: 100%;
            background: rgba(0, 255, 0, 0.5);
        }
        .position-marker {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            border: 2px solid #000;
            transform: translate(-50%, -50%);
            z-index: 20;
        }
        .marker-target { left: 8%; top: 55%; background: red; }
        
        /* Canvas CSSè¨­å®š */
        canvas[data-spine-character] {
            position: absolute;
            left: 8%;
            top: 55%;
            width: 8%;
            height: 8%;
            transform: translate(-50%, -50%);
            pointer-events: auto;
            z-index: 10;
            border: 3px solid lime;
            background: rgba(0,255,0,0.3);
        }
        
        /* ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼å¯è¦–åŒ– */
        .overflow-test {
            position: absolute;
            left: 5%;
            top: 90%;
            width: 10%;
            height: 10%;
            background: rgba(255, 0, 0, 0.5);
            border: 2px solid red;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body>
    <div class="debug-panel" id="debug-info">
        <h3>ğŸ” ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ãƒãƒƒã‚°</h3>
        <div id="info-content">èª­ã¿è¾¼ã¿ä¸­...</div>
        <button onclick="updateDebugInfo()">æ›´æ–°</button>
        <button onclick="toggleOverflow()">overflowåˆ‡æ›¿</button>
    </div>
    
    <h1>ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ»åˆ‡ã‚Œå•é¡Œã®ãƒ‡ãƒãƒƒã‚°</h1>
    
    <div class="background-container" id="bg-container">
        <img src="assets/images/ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼TOP.png" alt="èƒŒæ™¯" class="background-image" id="bg-image">
        
        <!-- ä½ç½®ç¢ºèªã‚°ãƒªãƒƒãƒ‰ -->
        <div class="position-grid">
            <div class="grid-line-v" style="left: 8%;"></div>
            <div class="grid-line-h" style="top: 55%;"></div>
            <div class="grid-line-h" style="top: 90%;"></div>
        </div>
        
        <!-- ä½ç½®ç¢ºèªãƒãƒ¼ã‚«ãƒ¼ -->
        <div class="position-marker marker-target" title="8%, 55% - ç›®æ¨™ä½ç½®"></div>
        
        <!-- ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ç¢ºèªç”¨ -->
        <div class="overflow-test" title="90%ä½ç½® - åˆ‡ã‚Œã‚‹ã‹ãƒ†ã‚¹ãƒˆ"></div>
        
        <!-- Canvasè¦ç´  -->
        <canvas data-spine-character="purattokun" id="test-canvas"></canvas>
    </div>

    <div style="margin-top: 20px;">
        <h3>ğŸ“ ã‚µã‚¤ã‚ºæƒ…å ±</h3>
        <div id="size-info"></div>
    </div>

    <script>
        function updateDebugInfo() {
            const canvas = document.getElementById('test-canvas');
            const container = document.getElementById('bg-container');
            const bgImage = document.getElementById('bg-image');
            const infoContent = document.getElementById('info-content');
            const sizeInfo = document.getElementById('size-info');
            
            if (canvas && container && bgImage) {
                const canvasRect = canvas.getBoundingClientRect();
                const containerRect = container.getBoundingClientRect();
                const bgRect = bgImage.getBoundingClientRect();
                
                const relativeLeft = ((canvasRect.left - containerRect.left) / containerRect.width * 100).toFixed(1);
                const relativeTop = ((canvasRect.top - containerRect.top) / containerRect.height * 100).toFixed(1);
                
                const computedStyle = window.getComputedStyle(canvas);
                const containerStyle = window.getComputedStyle(container);
                
                // åˆ‡ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                const isClippedRight = canvasRect.right > containerRect.right;
                const isClippedBottom = canvasRect.bottom > containerRect.bottom;
                const isClippedLeft = canvasRect.left < containerRect.left;
                const isClippedTop = canvasRect.top < containerRect.top;
                
                infoContent.innerHTML = `
                    <p><strong>Canvasä½ç½®:</strong> left: ${relativeLeft}%, top: ${relativeTop}%</p>
                    <p><strong>Canvaså®Ÿã‚µã‚¤ã‚º:</strong> ${canvasRect.width.toFixed(1)} x ${canvasRect.height.toFixed(1)}</p>
                    <p><strong>CSSè¨­å®š:</strong> ${computedStyle.width} x ${computedStyle.height}</p>
                    <p><strong>åˆ‡ã‚ŒçŠ¶æ…‹:</strong></p>
                    <ul>
                        <li>å³: ${isClippedRight ? 'âŒåˆ‡ã‚Œã¦ã‚‹' : 'âœ…OK'}</li>
                        <li>ä¸‹: ${isClippedBottom ? 'âŒåˆ‡ã‚Œã¦ã‚‹' : 'âœ…OK'}</li>
                        <li>å·¦: ${isClippedLeft ? 'âŒåˆ‡ã‚Œã¦ã‚‹' : 'âœ…OK'}</li>
                        <li>ä¸Š: ${isClippedTop ? 'âŒåˆ‡ã‚Œã¦ã‚‹' : 'âœ…OK'}</li>
                    </ul>
                    <p><strong>Container overflow:</strong> ${containerStyle.overflow}</p>
                `;
                
                sizeInfo.innerHTML = `
                    <p><strong>èƒŒæ™¯ç”»åƒ:</strong> ${bgRect.width.toFixed(1)} x ${bgRect.height.toFixed(1)}</p>
                    <p><strong>ã‚³ãƒ³ãƒ†ãƒŠ:</strong> ${containerRect.width.toFixed(1)} x ${containerRect.height.toFixed(1)}</p>
                    <p><strong>Canvas:</strong> ${canvasRect.width.toFixed(1)} x ${canvasRect.height.toFixed(1)}</p>
                    <p><strong>èƒŒæ™¯æ¯”ç‡:</strong> ${(canvasRect.width / bgRect.width * 100).toFixed(2)}% x ${(canvasRect.height / bgRect.height * 100).toFixed(2)}%</p>
                `;
            }
        }
        
        function toggleOverflow() {
            const container = document.getElementById('bg-container');
            const currentOverflow = window.getComputedStyle(container).overflow;
            container.style.overflow = currentOverflow === 'hidden' ? 'visible' : 'hidden';
            updateDebugInfo();
        }
        
        // åˆæœŸåŒ–ã¨ãƒªã‚µã‚¤ã‚ºç›£è¦–
        window.addEventListener('load', updateDebugInfo);
        window.addEventListener('resize', updateDebugInfo);
        
        // å®šæœŸæ›´æ–°
        setInterval(updateDebugInfo, 1000);
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½ç½®ä¿å­˜å•é¡Œä¿®æ­£ãƒ†ã‚¹ãƒˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #f0f0f0;
            font-family: Arial, sans-serif;
        }

        .scene-container {
            position: relative;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            height: 600px; /* å›ºå®šé«˜ã• */
        }

        /* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ */
        #test-character {
            position: absolute;
            width: 200px;
            height: 200px;
            background: #ff6b6b;
            border-radius: 50%;
            cursor: move;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            
            /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆä½ç½®ï¼ˆä¸­å¤®ï¼‰ */
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        /* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ« */
        .control-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            background: #ff6b6b;
            color: white;
            cursor: pointer;
        }

        button:hover {
            background: #ff5252;
        }

        .info {
            margin-top: 10px;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 4px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="scene-container">
        <div id="test-character">ã·ã‚‰ã£ã¨ãã‚“</div>
    </div>

    <div class="control-panel">
        <h3>ä½ç½®ä¿å­˜ãƒ†ã‚¹ãƒˆ</h3>
        <button onclick="savePosition()">ä½ç½®ã‚’ä¿å­˜</button>
        <button onclick="loadPosition()">ä½ç½®ã‚’èª­ã¿è¾¼ã¿</button>
        <button onclick="clearPosition()">ä¿å­˜ã‚’ã‚¯ãƒªã‚¢</button>
        <button onclick="resetToCenter()">ä¸­å¤®ã«æˆ»ã™</button>
        <div class="info" id="info">
            ç¾åœ¨ã®ä½ç½®: ä¸­å¤®
        </div>
    </div>

    <script>
        const character = document.getElementById('test-character');
        const info = document.getElementById('info');
        let isDragging = false;
        let startX, startY, initialLeft, initialTop;

        // ãƒ‰ãƒ©ãƒƒã‚°æ©Ÿèƒ½
        character.addEventListener('mousedown', startDrag);
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', endDrag);

        function startDrag(e) {
            isDragging = true;
            const rect = character.getBoundingClientRect();
            const parentRect = character.parentElement.getBoundingClientRect();
            
            startX = e.clientX;
            startY = e.clientY;
            
            // ç¾åœ¨ã®ä½ç½®ã‚’%ã§å–å¾—
            const currentLeft = ((rect.left + rect.width / 2 - parentRect.left) / parentRect.width) * 100;
            const currentTop = ((rect.top + rect.height / 2 - parentRect.top) / parentRect.height) * 100;
            
            initialLeft = currentLeft;
            initialTop = currentTop;
            
            character.style.cursor = 'grabbing';
        }

        function drag(e) {
            if (!isDragging) return;
            
            e.preventDefault();
            const parentRect = character.parentElement.getBoundingClientRect();
            
            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            
            const newLeft = initialLeft + (deltaX / parentRect.width) * 100;
            const newTop = initialTop + (deltaY / parentRect.height) * 100;
            
            character.style.left = newLeft + '%';
            character.style.top = newTop + '%';
            
            updateInfo();
        }

        function endDrag() {
            isDragging = false;
            character.style.cursor = 'move';
        }

        // ä½ç½®æƒ…å ±æ›´æ–°
        function updateInfo() {
            const left = parseFloat(character.style.left) || 50;
            const top = parseFloat(character.style.top) || 50;
            info.textContent = `ç¾åœ¨ã®ä½ç½®: å·¦ ${left.toFixed(1)}%, ä¸Š ${top.toFixed(1)}%`;
        }

        // ä½ç½®ä¿å­˜
        function savePosition() {
            const position = {
                left: character.style.left || '50%',
                top: character.style.top || '50%'
            };
            
            localStorage.setItem('test-character-position', JSON.stringify(position));
            console.log('âœ… ä½ç½®ã‚’ä¿å­˜ã—ã¾ã—ãŸ:', position);
            alert('ä½ç½®ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
        }

        // ä½ç½®èª­ã¿è¾¼ã¿
        function loadPosition() {
            const saved = localStorage.getItem('test-character-position');
            if (saved) {
                const position = JSON.parse(saved);
                character.style.left = position.left;
                character.style.top = position.top;
                console.log('âœ… ä½ç½®ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ:', position);
                updateInfo();
                alert('ä¿å­˜ã•ã‚ŒãŸä½ç½®ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸï¼');
            } else {
                alert('ä¿å­˜ã•ã‚ŒãŸä½ç½®ãŒã‚ã‚Šã¾ã›ã‚“');
            }
        }

        // ä¿å­˜ã‚¯ãƒªã‚¢
        function clearPosition() {
            localStorage.removeItem('test-character-position');
            console.log('ğŸ—‘ï¸ ä¿å­˜ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
            alert('ä¿å­˜ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
        }

        // ä¸­å¤®ã«æˆ»ã™
        function resetToCenter() {
            character.style.left = '50%';
            character.style.top = '50%';
            updateInfo();
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ä¿å­˜ä½ç½®ã‚’è‡ªå‹•å¾©å…ƒ
        window.addEventListener('DOMContentLoaded', () => {
            const saved = localStorage.getItem('test-character-position');
            if (saved) {
                const position = JSON.parse(saved);
                character.style.left = position.left;
                character.style.top = position.top;
                console.log('ğŸ”„ ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ä½ç½®ã‚’å¾©å…ƒ:', position);
                updateInfo();
            }
        });
    </script>
</body>
</html>
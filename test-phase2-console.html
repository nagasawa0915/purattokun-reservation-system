<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 2 ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 2rem;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .test-section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        button {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
            padding: 1rem 1.5rem;
            margin: 0.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
        }
        .status {
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
        }
        .feature-title {
            color: #4ecdc4;
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›ï¸ Phase 2 ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  ãƒ†ã‚¹ãƒˆ</h1>
        <p>F12 ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’é–‹ã„ã¦ã€æ®µéšçš„ã‚¯ãƒªã‚¢æ©Ÿèƒ½ã®å‹•ä½œã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>

        <div class="test-section">
            <div class="feature-title">ğŸš€ ãƒ•ã‚§ãƒ¼ã‚ºç®¡ç†ãƒ†ã‚¹ãƒˆ</div>
            <button onclick="testPhaseManagement()">ãƒ•ã‚§ãƒ¼ã‚ºç®¡ç†ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <button onclick="testMultiplePhases()">è¤‡æ•°ãƒ•ã‚§ãƒ¼ã‚ºåŒæ™‚ãƒ†ã‚¹ãƒˆ</button>
            <div class="status" id="phase-status">æº–å‚™å®Œäº†</div>
        </div>

        <div class="test-section">
            <div class="feature-title">ğŸ”§ ãƒ­ã‚°é–“å¼•ããƒ†ã‚¹ãƒˆ</div>
            <button onclick="testLogThrottling()">25å› â†’ 5å›é–“å¼•ããƒ†ã‚¹ãƒˆ</button>
            <button onclick="generateMassiveLogs()">å¤§é‡ãƒ­ã‚°ç”Ÿæˆï¼ˆ100å›ï¼‰</button>
            <div class="status" id="throttle-status">æº–å‚™å®Œäº†</div>
        </div>

        <div class="test-section">
            <div class="feature-title">ğŸ’ é‡è¦æƒ…å ±ä¿æŒãƒ†ã‚¹ãƒˆ</div>
            <button onclick="testImportantMessages()">é‡è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿æŒãƒ†ã‚¹ãƒˆ</button>
            <button onclick="testPhaseClearing()">æ®µéšçš„ã‚¯ãƒªã‚¢ï¼‹é‡è¦æƒ…å ±ä¿æŒ</button>
            <div class="status" id="important-status">æº–å‚™å®Œäº†</div>
        </div>

        <div class="test-section">
            <div class="feature-title">ğŸ“Š çµ±åˆã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ</div>
            <button onclick="testCPULoopScenario()">CPUç„¡é™ãƒ«ãƒ¼ãƒ—å•é¡Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</button>
            <button onclick="testCompleteWorkflow()">å®Œå…¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ</button>
            <div class="status" id="scenario-status">æº–å‚™å®Œäº†</div>
        </div>

        <div class="test-section">
            <div class="feature-title">ğŸ“‹ ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ç¢ºèª</div>
            <button onclick="showPhaseStatus()">ãƒ•ã‚§ãƒ¼ã‚ºçŠ¶æ³è¡¨ç¤º</button>
            <button onclick="showSystemStats()">ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆè¡¨ç¤º</button>
            <button onclick="clearConsole()">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«æ‰‹å‹•ã‚¯ãƒªã‚¢</button>
        </div>
    </div>

    <!-- Phase 2 Console Manager èª­ã¿è¾¼ã¿ -->
    <script src="assets/js/console-manager.js"></script>

    <script>
        // ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function updateStatus(elementId, message) {
            document.getElementById(elementId).textContent = message;
        }

        // ğŸš€ ãƒ•ã‚§ãƒ¼ã‚ºç®¡ç†ãƒ†ã‚¹ãƒˆ
        function testPhaseManagement() {
            updateStatus('phase-status', 'ãƒ•ã‚§ãƒ¼ã‚ºç®¡ç†ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
            
            // ã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿ãƒ•ã‚§ãƒ¼ã‚ºã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
            ConsoleManager.startPhase('test-asset-loading', 'ASSET');
            ConsoleManager.info('ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿é–‹å§‹', 'ASSET');
            
            // 3ç§’å¾Œã«æˆåŠŸã¨ã—ã¦å®Œäº†
            setTimeout(() => {
                ConsoleManager.success('ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿å®Œäº†', 'ASSET');
                ConsoleManager.completePhase('test-asset-loading', true);
                updateStatus('phase-status', 'ãƒ•ã‚§ãƒ¼ã‚ºç®¡ç†ãƒ†ã‚¹ãƒˆå®Œäº† - ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãŒã‚¯ãƒªã‚¢ã•ã‚Œã¾ã—ãŸ');
            }, 3000);
        }

        function testMultiplePhases() {
            updateStatus('phase-status', 'è¤‡æ•°ãƒ•ã‚§ãƒ¼ã‚ºãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
            
            // è¤‡æ•°ãƒ•ã‚§ãƒ¼ã‚ºã‚’åŒæ™‚é–‹å§‹
            ConsoleManager.startPhase('phase-a', 'SYSTEM');
            ConsoleManager.startPhase('phase-b', 'SPINE');
            ConsoleManager.startPhase('phase-c', 'UI');
            
            // æ®µéšçš„ã«å®Œäº†
            setTimeout(() => ConsoleManager.completePhase('phase-a', true), 1000);
            setTimeout(() => ConsoleManager.completePhase('phase-b', true), 2000);
            setTimeout(() => {
                ConsoleManager.completePhase('phase-c', true);
                updateStatus('phase-status', 'è¤‡æ•°ãƒ•ã‚§ãƒ¼ã‚ºãƒ†ã‚¹ãƒˆå®Œäº†');
            }, 3000);
        }

        // ğŸ”§ ãƒ­ã‚°é–“å¼•ããƒ†ã‚¹ãƒˆ
        function testLogThrottling() {
            updateStatus('throttle-status', 'ãƒ­ã‚°é–“å¼•ããƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
            
            // é–“å¼•ãè¨­å®š
            ConsoleManager.enableThrottling('TEST-å®‰å…¨ãƒã‚§ãƒƒã‚¯', { maxCount: 5, interval: 50 });
            
            // 25å›ã®ãƒ­ã‚°ã‚’ç”Ÿæˆï¼ˆ5å›ã¾ã§è¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšï¼‰
            for (let i = 1; i <= 25; i++) {
                ConsoleManager.debug(`å®‰å…¨ãƒã‚§ãƒƒã‚¯ ${i}/25: ãƒ†ã‚¹ãƒˆé€²è¡Œä¸­`, 'ASSET');
            }
            
            updateStatus('throttle-status', '25å›â†’5å›é–“å¼•ãå®Œäº† - ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèªã—ã¦ãã ã•ã„');
        }

        function generateMassiveLogs() {
            updateStatus('throttle-status', 'å¤§é‡ãƒ­ã‚°ç”Ÿæˆä¸­...');
            
            // ã‚ˆã‚Šå¼·åŠ›ãªé–“å¼•ãè¨­å®š
            ConsoleManager.enableThrottling('MASSIVE-LOG', { maxCount: 3, interval: 10 });
            
            // 100å›ã®ãƒ­ã‚°ã‚’ç”Ÿæˆ
            for (let i = 1; i <= 100; i++) {
                ConsoleManager.debug(`å¤§é‡ãƒ­ã‚°ãƒ†ã‚¹ãƒˆ ${i}/100`, 'PERFORMANCE');
            }
            
            updateStatus('throttle-status', '100å›â†’3å›é–“å¼•ãå®Œäº†');
        }

        // ğŸ’ é‡è¦æƒ…å ±ä¿æŒãƒ†ã‚¹ãƒˆ
        function testImportantMessages() {
            updateStatus('important-status', 'é‡è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿æŒãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
            
            // é‡è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨­å®š
            ConsoleManager.preserveImportant([
                'âœ… é‡è¦ãªãƒ†ã‚¹ãƒˆæˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                'âœ… Phase 2 ã‚·ã‚¹ãƒ†ãƒ å‹•ä½œç¢ºèª',
                'âœ… æ®µéšçš„ã‚¯ãƒªã‚¢æ©Ÿèƒ½æœ‰åŠ¹'
            ]);
            
            // é€šå¸¸ã®ãƒ­ã‚°ã‚’å¤§é‡ç”Ÿæˆ
            for (let i = 1; i <= 15; i++) {
                ConsoleManager.info(`é€šå¸¸ãƒ­ã‚° ${i}/15`, 'SYSTEM');
            }
            
            ConsoleManager.success('é‡è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿æŒè¨­å®šå®Œäº†', 'SYSTEM');
            updateStatus('important-status', 'é‡è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿æŒãƒ†ã‚¹ãƒˆå®Œäº†');
        }

        function testPhaseClearing() {
            updateStatus('important-status', 'æ®µéšçš„ã‚¯ãƒªã‚¢ï¼‹é‡è¦æƒ…å ±ä¿æŒãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
            
            // ãƒ•ã‚§ãƒ¼ã‚ºé–‹å§‹
            ConsoleManager.startPhase('test-clearing', 'SYSTEM');
            
            // é‡è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
            ConsoleManager.preserveImportant('ğŸ¯ ã‚¯ãƒªã‚¢å¾Œã‚‚ä¿æŒã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸');
            
            // ãƒã‚¤ã‚ºãƒ­ã‚°ã‚’ç”Ÿæˆ
            for (let i = 1; i <= 10; i++) {
                ConsoleManager.debug(`ãƒã‚¤ã‚ºãƒ­ã‚° ${i}/10 (ã‚¯ãƒªã‚¢å¯¾è±¡)`, 'SYSTEM');
            }
            
            // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            ConsoleManager.success('ãƒ†ã‚¹ãƒˆå‡¦ç†å®Œäº† - ã“ã®å¾Œã‚¯ãƒªã‚¢ã•ã‚Œã¾ã™', 'SYSTEM');
            
            // 3ç§’å¾Œã«ã‚¯ãƒªã‚¢å®Ÿè¡Œ
            setTimeout(() => {
                ConsoleManager.completePhase('test-clearing', true);
                updateStatus('important-status', 'ã‚¯ãƒªã‚¢å®Œäº† - é‡è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ä¿æŒã•ã‚Œã¾ã—ãŸ');
            }, 3000);
        }

        // ğŸ“Š çµ±åˆã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ
        function testCPULoopScenario() {
            updateStatus('scenario-status', 'CPUç„¡é™ãƒ«ãƒ¼ãƒ—å•é¡Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆå®Ÿè¡Œä¸­...');
            
            // CPUç„¡é™ãƒ«ãƒ¼ãƒ—å•é¡Œã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
            ConsoleManager.startPhase('cpu-loop-simulation', 'PERFORMANCE');
            ConsoleManager.enableThrottling('CPU-LOOP', { maxCount: 5, interval: 10 });
            
            // 25å›ã®å®‰å…¨ãƒã‚§ãƒƒã‚¯ã‚’æ¨¡æ“¬
            let count = 0;
            const interval = setInterval(() => {
                count++;
                ConsoleManager.debug(`CPUé›†ç´„å‡¦ç† ${count}/25: ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒã‚§ãƒƒã‚¯`, 'PERFORMANCE');
                
                if (count >= 25) {
                    clearInterval(interval);
                    ConsoleManager.success('CPUå‡¦ç†å®Œäº† - ã‚·ã‚¹ãƒ†ãƒ å®‰å®š', 'PERFORMANCE');
                    ConsoleManager.completePhase('cpu-loop-simulation', true);
                    updateStatus('scenario-status', 'CPUç„¡é™ãƒ«ãƒ¼ãƒ—å•é¡Œå¯¾ç­–ãƒ†ã‚¹ãƒˆå®Œäº†');
                }
            }, 50);
        }

        function testCompleteWorkflow() {
            updateStatus('scenario-status', 'å®Œå…¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
            
            // æ®µéš1: åˆæœŸåŒ–
            ConsoleManager.startPhase('workflow-init', 'SYSTEM');
            ConsoleManager.info('ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼åˆæœŸåŒ–é–‹å§‹', 'SYSTEM');
            
            setTimeout(() => {
                ConsoleManager.completePhase('workflow-init', true);
                
                // æ®µéš2: ã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿
                ConsoleManager.startPhase('workflow-assets', 'ASSET');
                ConsoleManager.enableThrottling('WORKFLOW-ASSET', { maxCount: 3, interval: 100 });
                
                for (let i = 1; i <= 10; i++) {
                    ConsoleManager.debug(`ã‚¢ã‚»ãƒƒãƒˆ ${i}/10 èª­ã¿è¾¼ã¿ä¸­`, 'ASSET');
                }
                
                setTimeout(() => {
                    ConsoleManager.completePhase('workflow-assets', true);
                    
                    // æ®µéš3: æç”»
                    ConsoleManager.startPhase('workflow-rendering', 'SPINE');
                    ConsoleManager.success('æç”»å‡¦ç†å®Œäº†', 'SPINE');
                    
                    setTimeout(() => {
                        ConsoleManager.completePhase('workflow-rendering', true);
                        updateStatus('scenario-status', 'å®Œå…¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆå®Œäº†');
                    }, 1000);
                }, 2000);
            }, 1000);
        }

        // ğŸ“‹ ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ç¢ºèª
        function showPhaseStatus() {
            const status = ConsoleManager.getPhaseStatus();
            console.log('ğŸ“Š Phase 2 ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ç¢ºèªå®Œäº† - è©³ç´°ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèªã—ã¦ãã ã•ã„');
        }

        function showSystemStats() {
            const stats = ConsoleManager.getStats();
            console.log('ğŸ“ˆ ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆè¡¨ç¤ºå®Œäº† - è©³ç´°ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèªã—ã¦ãã ã•ã„');
        }

        function clearConsole() {
            console.clear();
            ConsoleManager.success('æ‰‹å‹•ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¯ãƒªã‚¢å®Ÿè¡Œ', 'SYSTEM');
        }

        // åˆæœŸåŒ–å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        document.addEventListener('DOMContentLoaded', () => {
            ConsoleManager.success('ğŸ›ï¸ Phase 2 ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸åˆæœŸåŒ–å®Œäº†', 'SYSTEM');
            ConsoleManager.info('å„ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦Phase 2æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„', 'SYSTEM');
            console.log('%cğŸ¯ Phase 2 ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  ãƒ†ã‚¹ãƒˆç’°å¢ƒ', 'color: #4ecdc4; font-size: 16px; font-weight: bold;');
            console.log('%cğŸ“‹ F12ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ãƒ­ã‚°ã®å¤‰åŒ–ã‚’ç¢ºèªã—ã¦ãã ã•ã„', 'color: #ff6b6b; font-size: 14px;');
        });
    </script>
</body>
</html>
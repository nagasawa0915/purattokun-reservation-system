<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DragDetector Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            display: grid;
            grid-template-areas: 
                "outliner preview properties"
                "timeline timeline timeline";
            grid-template-columns: 300px 1fr 300px;
            grid-template-rows: 1fr auto;
            gap: 10px;
            height: 500px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .panel {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 6px;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            cursor: grab;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .panel:active {
            cursor: grabbing;
        }
        
        .panel:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .panel[data-panel="outliner"] {
            grid-area: outliner;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .panel[data-panel="preview"] {
            grid-area: preview;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .panel[data-panel="properties"] {
            grid-area: properties;
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        .panel[data-panel="timeline"] {
            grid-area: timeline;
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            height: 100px;
        }
        
        .controls {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .log {
            margin-top: 20px;
            padding: 15px;
            background: #333;
            color: #00ff00;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            height: 200px;
            overflow-y: auto;
        }
        
        .log-entry {
            margin-bottom: 5px;
        }
        
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        
        button:hover {
            background: #005a99;
        }
        
        .instructions {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 4px 4px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ¯ DragDetector å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="instructions">
        <h3>ğŸ“‹ æ“ä½œæ‰‹é †:</h3>
        <ol>
            <li><strong>ã€ŒDragDetectoråˆæœŸåŒ–ã€</strong>ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
            <li>ãƒ‘ãƒãƒ«ã‚’<strong>ãƒ‰ãƒ©ãƒƒã‚°</strong>ã—ã¦ä»–ã®ãƒ‘ãƒãƒ«ã«é‡ã­ã‚‹</li>
            <li>å¢ƒç•Œç·šï¼ˆå·¦åŠåˆ†/å³åŠåˆ†ï¼‰ã§ã®<strong>æŒ¿å…¥ä½ç½®æ¤œå‡º</strong>ã‚’ç¢ºèª</li>
            <li>é’ã„ç¸¦ç·šï¼ˆæŒ¿å…¥ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª</li>
            <li>ãƒ­ã‚°ã§ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œã®è©³ç´°ã‚’ç¢ºèª</li>
        </ol>
    </div>
    
    <div class="controls">
        <button onclick="initializeTest()">ğŸš€ DragDetectoråˆæœŸåŒ–</button>
        <button onclick="clearLog()">ğŸ§¹ ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
        <button onclick="resetPanels()">ğŸ”„ ãƒ‘ãƒãƒ«ä½ç½®ãƒªã‚»ãƒƒãƒˆ</button>
    </div>
    
    <div class="test-container" id="testContainer">
        <div class="panel" data-panel="outliner">Outliner</div>
        <div class="panel" data-panel="preview">Preview</div>
        <div class="panel" data-panel="properties">Properties</div>
        <div class="panel" data-panel="timeline">Timeline</div>
    </div>
    
    <div class="log" id="logContainer">
        <div class="log-entry">ğŸ”§ DragDetector ãƒ†ã‚¹ãƒˆãƒ­ã‚° - æº–å‚™å®Œäº†</div>
        <div class="log-entry">ğŸ’¡ ä¸Šã®ã€ŒDragDetectoråˆæœŸåŒ–ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¦ãã ã•ã„</div>
    </div>
    
    <script src="micromodules/ui/modular-panel-system/DragDetector.js"></script>
    <script>
        let dragDetector = null;
        let logContainer = document.getElementById('logContainer');
        
        function addLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.textContent = `[${timestamp}] ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        function initializeTest() {
            if (dragDetector) {
                dragDetector.destroy();
            }
            
            dragDetector = new DragDetector({
                onDragStart: (e, source) => {
                    addLog(`ğŸ¯ ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹: ${source.dataset.panel}`);
                    source.style.opacity = '0.7';
                },
                onDragOver: (e, target, position) => {
                    addLog(`ğŸ”„ ãƒ‰ãƒ©ãƒƒã‚°ã‚ªãƒ¼ãƒãƒ¼: ${target.dataset.panel} (${position})`);
                },
                onDrop: (e, source, target, operation) => {
                    addLog(`âœ… ãƒ‰ãƒ­ãƒƒãƒ—å®Œäº†: ${operation.source} â†’ ${operation.target} (${operation.position})`);
                    addLog(`ğŸ“‹ æ“ä½œè©³ç´°: ${JSON.stringify(operation)}`);
                    source.style.opacity = '1';
                },
                onDragEnd: (e) => {
                    addLog('ğŸ ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†');
                    // é€æ˜åº¦ã‚’ãƒªã‚»ãƒƒãƒˆ
                    document.querySelectorAll('.panel').forEach(panel => {
                        panel.style.opacity = '1';
                    });
                }
            });
            
            // ãƒ‘ãƒãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ã«è¨­å®š
            document.querySelectorAll('[data-panel]').forEach(panel => {
                panel.draggable = true;
                panel.style.cursor = 'grab';
            });
            
            addLog('ğŸš€ DragDetector åˆæœŸåŒ–å®Œäº† - ãƒ‰ãƒ©ãƒƒã‚°ãƒ†ã‚¹ãƒˆå¯èƒ½');
        }
        
        function clearLog() {
            logContainer.innerHTML = '<div class="log-entry">ğŸ§¹ ãƒ­ã‚°ã‚¯ãƒªã‚¢å®Œäº†</div>';
        }
        
        function resetPanels() {
            const container = document.getElementById('testContainer');
            container.style.gridTemplateAreas = `
                "outliner preview properties"
                "timeline timeline timeline"`;
            addLog('ğŸ”„ ãƒ‘ãƒãƒ«ä½ç½®ãƒªã‚»ãƒƒãƒˆå®Œäº†');
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«èª¬æ˜ã‚’è¡¨ç¤º
        window.addEventListener('load', () => {
            addLog('ğŸ“š DragDetector.js æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆç’°å¢ƒ');
            addLog('ğŸ’¡ ãƒ‘ãƒãƒ«å¢ƒç•Œã§ã®æŒ¿å…¥ä½ç½®æ¤œå‡º (before/after)');
            addLog('ğŸ” æ°´å¹³æ–¹å‘ã®ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ“ä½œã‚’ãƒ†ã‚¹ãƒˆ');
            addLog('âš¡ é’ã„ç¸¦ç·šãŒæŒ¿å…¥ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã§ã™');
        });
    </script>
</body>
</html>
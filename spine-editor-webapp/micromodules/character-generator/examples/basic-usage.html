<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Character Generator - åŸºæœ¬ä½¿ç”¨ä¾‹</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .output { background: #f5f5f5; padding: 10px; border-radius: 3px; font-family: monospace; white-space: pre-wrap; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ Character Generator ãƒã‚¤ã‚¯ãƒ­ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« - åŸºæœ¬ä½¿ç”¨ä¾‹</h1>
        
        <div class="section">
            <h2>ğŸ“‹ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿çŠ¶æ³</h2>
            <div id="loadStatus">èª­ã¿è¾¼ã¿ä¸­...</div>
        </div>

        <div class="section">
            <h2>ğŸ® æ–°è¦ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”Ÿæˆãƒ†ã‚¹ãƒˆ</h2>
            <button onclick="testCharacterGeneration()">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”Ÿæˆå®Ÿè¡Œ</button>
            <div id="generationOutput" class="output"></div>
        </div>

        <div class="section">
            <h2>ğŸ” æ—¢å­˜ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ¤œå‡ºãƒ†ã‚¹ãƒˆ</h2>
            <button onclick="testCharacterDetection()">æ—¢å­˜ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ¤œå‡ºå®Ÿè¡Œ</button>
            <div id="detectionOutput" class="output"></div>
        </div>

        <div class="section">
            <h2>ğŸ§ª å˜ç‹¬ãƒ†ã‚¹ãƒˆ</h2>
            <button onclick="runStandaloneTest()">å˜ç‹¬ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="testOutput" class="output"></div>
        </div>

        <div class="section">
            <h2>ğŸ§¹ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒ†ã‚¹ãƒˆ</h2>
            <button onclick="testCleanup()">ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè¡Œ</button>
            <div id="cleanupOutput" class="output"></div>
        </div>

        <!-- ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ¢ãƒƒã‚¯Spineã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¦ç´  -->
        <div style="display: none;">
            <canvas id="purattokun-canvas" class="spine-canvas"></canvas>
            <canvas id="nezumi-canvas" class="character-canvas"></canvas>
            <canvas id="test-spine-character"></canvas>
        </div>
    </div>

    <!-- Character Generator ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿ -->
    <script src="../character-generator.js"></script>

    <script>
        let generator = null;

        // åˆæœŸåŒ–ãƒã‚§ãƒƒã‚¯
        document.addEventListener('DOMContentLoaded', function() {
            const loadStatusEl = document.getElementById('loadStatus');
            
            if (typeof CharacterGenerator !== 'undefined') {
                loadStatusEl.innerHTML = '<span class="success">âœ… Character Generator ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿æˆåŠŸ</span>';
                generator = new CharacterGenerator();
            } else {
                loadStatusEl.innerHTML = '<span class="error">âŒ Character Generator ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿å¤±æ•—</span>';
            }
        });

        // æ–°è¦ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”Ÿæˆãƒ†ã‚¹ãƒˆ
        function testCharacterGeneration() {
            const outputEl = document.getElementById('generationOutput');
            
            if (!generator) {
                outputEl.textContent = 'ã‚¨ãƒ©ãƒ¼: Character Generator ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“';
                return;
            }

            try {
                const result = generator.generate({
                    characterType: "hero",
                    count: 3,
                    namePrefix: "demo",
                    spineFilePath: "assets/demo-hero.json"
                });

                outputEl.textContent = `âœ… ç”ŸæˆæˆåŠŸ (${result.length}å€‹):\n\n` + JSON.stringify(result, null, 2);
            } catch (error) {
                outputEl.textContent = `âŒ ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }

        // æ—¢å­˜ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ¤œå‡ºãƒ†ã‚¹ãƒˆ
        function testCharacterDetection() {
            const outputEl = document.getElementById('detectionOutput');
            
            if (!generator) {
                outputEl.textContent = 'ã‚¨ãƒ©ãƒ¼: Character Generator ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“';
                return;
            }

            try {
                const result = generator.detectExistingCharacters();
                outputEl.textContent = `âœ… æ¤œå‡ºæˆåŠŸ (${result.length}å€‹):\n\n` + JSON.stringify(result, null, 2);
            } catch (error) {
                outputEl.textContent = `âŒ æ¤œå‡ºã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }

        // å˜ç‹¬ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        function runStandaloneTest() {
            const outputEl = document.getElementById('testOutput');
            
            try {
                const testResult = CharacterGenerator.test();
                outputEl.textContent = testResult ? 
                    'âœ… å˜ç‹¬ãƒ†ã‚¹ãƒˆæˆåŠŸ: ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒæ­£å¸¸ã«å‹•ä½œã—ã¾ã—ãŸ' :
                    'âŒ å˜ç‹¬ãƒ†ã‚¹ãƒˆå¤±æ•—: ä¸€éƒ¨ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ';
            } catch (error) {
                outputEl.textContent = `âŒ ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }

        // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒ†ã‚¹ãƒˆ
        function testCleanup() {
            const outputEl = document.getElementById('cleanupOutput');
            
            if (!generator) {
                outputEl.textContent = 'ã‚¨ãƒ©ãƒ¼: Character Generator ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“';
                return;
            }

            try {
                // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‰ã®çŠ¶æ…‹
                const stateBefore = generator.getState();
                
                // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè¡Œ
                generator.cleanup();
                
                // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¾Œã®çŠ¶æ…‹
                const stateAfter = generator.getState();
                
                outputEl.textContent = `âœ… ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†:\n\n` +
                    `ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‰: ${JSON.stringify(stateBefore, null, 2)}\n\n` +
                    `ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¾Œ: ${JSON.stringify(stateAfter, null, 2)}`;
            } catch (error) {
                outputEl.textContent = `âŒ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }
    </script>
</body>
</html>